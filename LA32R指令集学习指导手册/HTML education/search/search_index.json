{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u5f15\u8a00","text":"<p>\u9f99\u67b6\u6784\uff08LoongArch\uff0c\u540e\u6587\u7b80\u79f0LA\uff09\u6307\u4ee4\u96c6\u5305\u542b\u4e09\u4e2a\u4e3b\u8981\u5206\u652f\uff0c\u537364\u4f4d\u5206\u652f\uff08LoongArch64\uff0c\u540e\u6587\u7b80\u79f0LA64\uff09\u300132\u4f4d\u5206\u652f\uff08LoongArch32\uff0c\u540e\u6587\u7b80\u79f0LA32\uff09\u548c32\u4f4d\u7cbe\u7b80\u7248\u5206\u652f\uff08LoongArch32 Reduced\uff0c\u540e\u6587\u7b80\u79f0LA32R\uff09\u3002</p> \u9f99\u67b6\u6784\u7684\u4e09\u4e2a\u5206\u652f <p>\u5176\u4e2dLA32R\u5b9a\u4f4d\u4e3a\u7528\u4e8e\u6559\u5b66\u79d1\u7814\uff0c\u5177\u6709\u5c0f\u800c\u7cbe\u7684\u8bbe\u8ba1\u7279\u70b9\u3002\u5176\u7528\u6237\u6001\u6574\u6570\u6307\u4ee4\u4ec5\u670950\u4f59\u6761\uff0c\u5728CPU\u786c\u4ef6\u4e0d\u5b9e\u73b0\u6d6e\u70b9\u6307\u4ee4\u7684\u60c5\u51b5\u4e0b\u4e5f\u80fd\u8fd0\u884c\u5404\u79cd\u8f6f\u4ef6\uff0c\u540c\u65f6\u6838\u5fc3\u6001\u5b9a\u4e49\u4e86\u7279\u6743\u7b49\u7ea7\u3001\u4f8b\u5916\u4e0e\u4e2d\u65ad\u548c\u5b58\u50a8\u7ba1\u7406\u4e09\u90e8\u5206\u5185\u5bb9\uff0c\u652f\u6301\u64cd\u4f5c\u7cfb\u7edf\u8fd0\u884c\uff0c\u5728\u5b9e\u73b0\u4e86\u5b58\u50a8\u7ba1\u7406\u4e2d\u7684TLB MMU\u60c5\u51b5\u4e0b\u8fd8\u53ef\u8fd0\u884cLinux\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p>\u76ee\u524d\u5404\u4e0a\u6e38\u793e\u533a\u548c\u9f99\u82af\u5f00\u6e90\u793e\u533a\u4e0a\u7684\u5de5\u4f5c\u57fa\u672c\u4e0a\u90fd\u662f\u9488\u5bf9LA64\u7684\uff0c\u540c\u65f6\u5404\u7c7b\u9f99\u67b6\u6784\u76f8\u5173\u7684\u6559\u6750\u3001\u53c2\u8003\u4e66\u7c4d\u4e5f\u57fa\u672c\u4e0a\u90fd\u662f\u56f4\u7ed5LA64\u8fdb\u884c\u4ecb\u7ecd\u7684\u3002\u5c3d\u7ba1\u8bf4LA32R\u548cLA64\u7684\u8bbe\u8ba1\u98ce\u683c\u662f\u4e00\u81f4\u7684\uff0c\u6307\u4ee4\u7801\u662f\u76f8\u540c\u7684\uff0c\u4f46\u662f\u8ba9\u521d\u5b66\u8005\u4ec5\u4f9d\u636eLA32R\u6307\u4ee4\u96c6\u624b\u518c\u5e76\u53c2\u8003LA64\u76f8\u5173\u5b66\u4e60\u8d44\u6599\u6765\u6478\u7d22\u7740\u638c\u63e1LA32R\uff0c\u786e\u5b9e\u5b58\u5728\u4e00\u5b9a\u7684\u96be\u5ea6\u4e14\u53d1\u751f\u7406\u89e3\u504f\u5dee\u3002\u56e0\u6b64\u6211\u4eec\u840c\u751f\u4e86\u7f16\u5199\u4e00\u4e2aLA32R\u6307\u4ee4\u96c6\u5b66\u4e60\u6307\u5bfc\u624b\u518c\u7684\u60f3\u6cd5\uff0c\u5e0c\u671b\u80fd\u7ed9\u521d\u5b66\u8005\u63d0\u4f9b\u4e00\u4e9b\u4fbf\u5229\u3002</p> <p>\u6574\u672c\u624b\u518c\u5728\u5185\u5bb9\u5b89\u6392\u4e0a\u8fd8\u662f\u504f\u5411\u8f6f\u4ef6\u5f00\u53d1\u8005\u89c6\u89d2\u591a\u4e00\u4e9b\u3002\u5982\u679c\u60a8\u7684\u9700\u6c42\u66f4\u591a\u504f\u5411\u4e8eCPU\u786c\u4ef6\u8bbe\u8ba1\u5f00\u53d1\uff0c\u90a3\u4e48\u53ef\u4ee5\u53c2\u8003\u300aCPU\u8bbe\u8ba1\u5b9e\u6218\uff1aLoongArch\u7248\u300b\u8fd9\u672c\u4e66\u3002\u672c\u624b\u518c\u4e2d\u6211\u4eec\u8bd5\u56fe\u4ece\u8f6f\u4ef6\u5f00\u53d1\u8005\u89c6\u89d2\u51fa\u53d1\uff0c\u9488\u5bf9\u6307\u4ee4\u96c6\u4e2d\u7684\u6280\u672f\u5185\u5bb9\u201c\u4e3a\u4ec0\u4e48\u8fd9\u6837\u8bbe\u8ba1\u201d\u3001\u201c\u8f6f\u786c\u4ef6\u5982\u4f55\u534f\u540c\u201d\u8c08\u4e00\u4e9b\u6211\u4eec\u7684\u7406\u89e3\u3002\u540c\u65f6\u4e3a\u4e86\u63a7\u5236\u6574\u672c\u624b\u518c\u7684\u7bc7\u5e45\uff0c\u5728\u884c\u6587\u7684\u8be6\u7565\u5c3a\u5ea6\u65b9\u9762\uff0c\u6211\u4eec\u4f1a\u4fa7\u91cd\u4e8e\u6307\u4ee4\u67b6\u6784\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u800c\u6307\u4ee4\u67b6\u6784\u65e0\u5173\u7684\u672c\u9886\u57df\u516c\u5171\u57fa\u7840\u77e5\u8bc6\uff0c\u5982ELF\u6587\u4ef6\u683c\u5f0f\u3001\u94fe\u63a5\u4e0e\u88c5\u8f7d\u7684\u5171\u6027\u6982\u5ff5\u3001GDB\u8c03\u8bd5\u547d\u4ee4\u3001Linux\u5185\u6838\u4e2d\u516c\u5171\u4ee3\u7801\u7684\u5904\u7406\u6d41\u7a0b\u7b49\uff0c\u6211\u4eec\u4f1a\u63d0\u53ca\u4f46\u4e0d\u4f1a\u5c55\u5f00\u3002\u76f8\u5173\u77e5\u8bc6\u5efa\u8bae\u8bfb\u8005\u4eec\u81ea\u884c\u67e5\u9605\u8d44\u6599\u3002\u6211\u4eec\u4e5f\u4f1a\u5728\u8bb2\u8ff0\u5230\u76f8\u5173\u5185\u5bb9\u65f6\u63a8\u8350\u4e00\u4e9b\u53c2\u8003\u6750\u6599\u4f9b\u8bfb\u8005\u8fdb\u4e00\u6b65\u9605\u8bfb\u3002</p> <p>\u6211\u4eec\u5e0c\u671b\u672c\u624b\u518c\u7684\u8bfb\u8005\u4e8b\u5148\u5df2\u4e86\u89e3\u8fc7\u81f3\u5c11\u4e00\u4e2a\u6307\u4ee4\u96c6\uff0c\u800c\u4e14\u6700\u597d\u662fRISC\u578b\u7684\u6307\u4ee4\u96c6\u3002\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u5f3a\u70c8\u5efa\u8bae\u901a\u8fc7\u5b66\u4e60\u4e00\u4e9b\u7ecf\u5178\u6559\u6750\u6765\u5efa\u7acb\u8fd9\u65b9\u9762\u7684\u8ba4\u8bc6\u3002\u63a8\u8350\u300aComputer Organization and Design: The Hardware Software Interface\u300b\u8fd9\u672c\u6559\u6750\u3002\u7b2c4\u7248\u6216\u7b2c5\u7248\u5c31\u53ef\u4ee5\uff0cMIPS\u7248\u3001ARMv8\u7248\u6216\u8005RISC-V\u7248\u4e5f\u90fd\u53ef\u4ee5\u3002\u6307\u4ee4\u96c6\u7684\u57fa\u7840\u5171\u6027\u77e5\u8bc6\u5df2\u5f88\u6210\u719f\uff0c\u4e0d\u540c\u6307\u4ee4\u96c6\u95f4\u90fd\u662f\u76f8\u901a\u7684\u3002\u8fd9\u672c\u6559\u6750\u8bb2\u6388\u7684\u5185\u5bb9\u5f88\u4e30\u5bcc\uff0c\u65f6\u95f4\u6709\u9650\u7684\u8bdd\u53ef\u4ee5\u53ea\u770b\u5176\u4e2d\u4ecb\u7ecd\u6307\u4ee4\u96c6\u7684\u7ae0\u8282\u3002</p> <p>\u6b64\u5916\u8fd8\u5efa\u8bae\u8bfb\u8005\u9605\u8bfb\u672c\u624b\u518c\u8fc7\u7a0b\u4e2d\uff0c\u591a\u53c2\u770bLA32R\u7684\u6307\u4ee4\u96c6\u624b\u518c\u300a\u9f99\u82af\u67b6\u678432\u4f4d\u7cbe\u7b80\u7248\u53c2\u8003\u624b\u518c\u300b\u3002</p> <p>\u672c\u624b\u518c\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u4e09\u65b9\u9762\u7684\u5185\u5bb9\uff1a</p> <ol> <li>LA32R\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4\u5e94\u7528\u8bb2\u89e3\uff1b</li> <li>LA32R\u7684\u6c47\u7f16\u7f16\u7a0b\u57fa\u672c\u77e5\u8bc6\uff1b</li> <li>LA32R\u4e2d\u7279\u6743\u6001\u76f8\u5173\u5185\u5bb9\uff0c\u5982\u4f8b\u5916\u3001\u5185\u5b58\u7ba1\u7406\u7b49\u3002</li> </ol> <p>\u4ee5\u4e0a\u7b2c1\u65b9\u9762\u5c06\u5c3d\u53ef\u80fd\u4ece\u8bfb\u8005\u8f83\u4e3a\u719f\u6089\u7684C\u8bed\u8a00\u7684\u529f\u80fd\u5207\u5165\uff0c\u5173\u8054\u5230\u5bf9\u5e94\u7684\u6307\u4ee4\uff0c\u9664\u4e86\u4ecb\u7ecdLA32R\u6307\u4ee4\u96c6\u624b\u518c\u4e2d\u5b9a\u4e49\u7684\u6307\u4ee4\uff08\u672c\u624b\u518c\u4e2d\u6211\u4eec\u79f0\u4e4b\u4e3a\u201c\u771f\u5b9e\u6307\u4ee4\u201d\uff09\uff0c\u4e5f\u4f1a\u4ecb\u7ecd\u6c47\u7f16\u5668\u652f\u6301\u7684\u4f2a\u6307\u4ee4\u3002\u7b2c2\u65b9\u9762\u5bf9\u4e8e\u6c47\u7f16\u7f16\u7a0b\u8fdb\u884c\u521d\u6b65\u4ecb\u7ecd\uff0c\u5e0c\u671b\u80fd\u591f\u5e2e\u52a9\u521d\u5b66\u8005\u8fbe\u5230\u770b\u5f97\u61c2\u6c47\u7f16\u7a0b\u5e8f\uff0c\u80fd\u5199\u4e00\u4e9b\u7b80\u5355\u7684\u6c47\u7f16\u7a0b\u5e8f\u7684\u72b6\u6001\u3002\u7b2c3\u65b9\u9762\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u5c06\u7ed3\u5408Linux\u5185\u6838\u7684\u5177\u4f53\u5b9e\u73b0\u5c06\u8f6f\u786c\u4ef6\u534f\u540c\u7684\u8fc7\u7a0b\u6574\u4f53\u5448\u73b0\u51fa\u6765\uff0c\u5c3d\u7ba1\u8bf4LA32R\u67b6\u6784\u4e0a\u5e76\u975e\u53ea\u80fd\u8fd0\u884cLinux\u8fd9\u4e00\u79cd\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4f46\u76f8\u4fe1Linux\u5185\u6838\u7684\u5b9e\u73b0\u5bf9\u4e8e\u5176\u5b83\u64cd\u4f5c\u7cfb\u7edf\u7684\u5b9e\u73b0\u4e5f\u6709\u5f88\u597d\u7684\u6307\u5bfc\u4f5c\u7528\u3002</p>"},{"location":"assembly/addr_space/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/addr_space/#_1","title":"\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\u89c4\u8303","text":"<p>\u901a\u5e38\u6765\u8bf4\uff0c\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7684\u5e03\u5c40\u662f\u7531\u6307\u4ee4\u7cfb\u7edf\u3001\u5de5\u5177\u94fe\u548c\u64cd\u4f5c\u7cfb\u7edf\u914d\u5408\u5728\u4e00\u8d77\u5171\u540c\u51b3\u5b9a\u7684\u3002ABI\u89c4\u8303\u4e2d\u5e76\u4e0d\u4f1a\u9650\u5b9a\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u7684\u5e03\u5c40\u89c4\u5219\u3002\u4e0d\u8fc7\uff0c\u4e3a\u4e86\u8ba9\u8bfb\u8005\u66f4\u597d\u5730\u4e86\u89e3\u8fd9\u90e8\u5206\u5185\u5bb9\uff0c\u6211\u4eec\u5c06\u7740\u91cd\u4ecb\u7ecdLinux/LA32R\u4e2d\u6240\u91c7\u7528\u7684\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\uff0c\u5e76\u5728\u6b64\u57fa\u7840\u4e4b\u4e0a\u7b80\u8981\u8ba8\u8bba\u4e00\u4e0b\u5d4c\u5165\u5f0f\u8bbe\u5907\u4e2d\u5e38\u89c1\u7684\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u4e0b\u7684\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7ba1\u7406\u3002</p>"},{"location":"assembly/addr_space/#linux","title":"Linux\u7cfb\u7edf\u4e0b\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4","text":"<p>\u5927\u591a\u6570\u6307\u4ee4\u67b6\u6784\u5728Linux\u7cfb\u7edf\u4e0b\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u89c1\u7684\u5185\u5b58\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\u90fd\u662f\u7b80\u5355\u5212\u5206\u4e3a\u7528\u6237\u7a7a\u95f4\uff08user space\uff09\u548c\u5185\u6838\u7a7a\u95f4\uff08kernel space\uff09\u3002\u4ee532\u4f4d\u6307\u4ee4\u67b6\u6784\u4e3a\u4f8b\uff0cX86-32\u5728Linux\u7cfb\u7edf\u4e0b\u6bcf\u4e2a\u8fdb\u7a0b\u76844GB\u865a\u5730\u5740\u7a7a\u95f4\u88ab\u5927\u81f4\u5212\u5206\u4e3a<code>0x0 ~ 0xBFFFFFFF(3GB)</code>\u7684\u7528\u6237\u7a7a\u95f4\u548c<code>0xC0000000 ~ 0xFFFFFFFF(1GB)</code>\u7684\u5185\u6838\u7a7a\u95f4\uff0c\u800cMIPS32\u5728Linux\u7cfb\u7edf\u4e0b\u6bcf\u4e2a\u8fdb\u7a0b\u76844GB\u865a\u5730\u5740\u7a7a\u95f4\u88ab\u5927\u81f4\u5212\u5206\u4e3a<code>0x0 ~ 0x7FFFFFFF(2GB)</code>\u7684\u7528\u6237\u7a7a\u95f4\u548c<code>0x80000000 ~ 0xFFFFFFFF(2GB)</code>\u7684\u5185\u6838\u7a7a\u95f4\u3002</p> <p>\u5bf9\u4e8eLA32R\u6765\u8bf4\uff0c\u5176\u5728Linux\u7cfb\u7edf\u4e0b\u6bcf\u4e2a\u8fdb\u7a0b\u76844GB\u865a\u5730\u5740\u7a7a\u95f4\u88ab\u5927\u81f4\u5212\u5206\u4e3a<code>0x0 ~ 0x7FFFFFFF(2GB)</code>\u7684\u7528\u6237\u7a7a\u95f4\u548c<code>0x80000000 ~ 0xFFFFFFFF(2GB)</code>\u7684\u5185\u6838\u7a7a\u95f4\u3002\u5176\u4e2d<code>0x80000000</code>\u4ee5\u4e0a\u7684\u5730\u5740\u7a7a\u95f4\u662f\u6240\u6709\u8fdb\u7a0b\u5171\u4eab\u7684\uff0c\u5176\u4e2d\u901a\u8fc7\u76f4\u63a5\u6620\u5c04\u7a97\u53e3\uff08Direct Mapping Window\uff09\u914d\u7f6e\u51fa<code>0x80000000 ~ 0x9FFFFFFF</code>\u548c<code>0xA0000000 ~ 0xBFFFFFFF</code>\u4e24\u4e2a\u5404512MB\u5927\u5c0f\u3001\u5b58\u50a8\u8bbf\u95ee\u7c7b\u578b\u5206\u522b\u662f\u5f3a\u5e8f\u975e\u7f13\u5b58\u548c\u4e00\u81f4\u53ef\u7f13\u5b58\u7684\u76f4\u63a5\u6620\u5c04\u533a\u57df\uff0c\u4f9b\u5185\u6838\u9ad8\u6548\u7387\u5730\u8bbf\u95ee\u7cfb\u7edf\u4e2d\u6700\u4f4e512MB\u7269\u7406\u5730\u5740\u7a7a\u95f4\u3002</p> LA32R\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u5206\u5e03 <p>\u6211\u4eec\u8fd9\u91cc\u5c06\u4e3b\u8981\u8ba8\u8bbaLinux\u7cfb\u7edf\u4e0b\u52a0\u8f7d\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u540e\u7684\u5730\u5740\u7a7a\u95f4\u5e03\u5c40\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4e3b\u8981\u5173\u6ce84GB\u865a\u62df\u5730\u5740\u7a7a\u95f4\u4e0b\u7684\u7528\u6237\u7a7a\u95f4\u90e8\u5206\u3002\u5728Linux\u7cfb\u7edf\u4e0b\uff0c\u53ef\u6267\u884c\u7a0b\u5e8f\u91c7\u7528ELF(Executable and Linkable Format)\u683c\u5f0f\u3002\u5728ELF\u6587\u4ef6\u4e2d\u5305\u542b\u7740\u4e00\u7cfb\u5217\u4e0d\u540c\u7684\u6bb5\uff08section\uff09\uff0c\u4e0d\u540c\u7684\u6bb5\u7528\u4e8e\u5b58\u653e\u4e0d\u540c\u7c7b\u578b\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u6700\u5e38\u89c1\u7684\u6bb5\u6709\uff1a</p> <ul> <li>.text\u6bb5\uff1a\u7528\u4e8e\u4fdd\u5b58\u7a0b\u5e8f\u4e2d\u7684\u4ee3\u7801\u7247\u6bb5\u3002</li> <li>.data\u6bb5\uff1a\u7528\u4e8e\u4fdd\u5b58\u5df2\u7ecf\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u5c40\u90e8\u53d8\u91cf\u3002</li> <li>.bss\u6bb5\uff1a\u7528\u4e8e\u4fdd\u5b58\u672a\u521d\u59cb\u5316\u7684\u5168\u5c40\u53d8\u91cf\u548c\u9759\u6001\u5c40\u90e8\u53d8\u91cf\u3002</li> <li>.rodata\u6bb5\uff1a\u7528\u4e8e\u4fdd\u5b58\u53ea\u8bfb\u7684\u53d8\u91cf\u3002</li> </ul> <p>\u5de5\u5177\u94fe\u5728\u7f16\u8bd1\u94fe\u63a5\u5e94\u7528\u7a0b\u5e8f\u65f6\uff0c\u4f1a\u6309\u7167\u9ed8\u8ba4\u914d\u7f6e\u7684\u94fe\u63a5\u53c2\u6570\u4e3a\u4e0a\u8ff0\u5404\u6bb5\u8bbe\u7f6e\u597d\u5730\u5740\u3002\u8fd0\u884c\u7a0b\u5e8f\u65f6\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u88c5\u8f7d\u5668\u5c06\u6839\u636e\u7a0b\u5e8f\u6587\u4ef6\u4e2d\u8bb0\u5f55\u7684\u5404\u6bb5\u7684\u5185\u5b58\u5730\u5740\u4fe1\u606f\uff0c\u628a\u4ee3\u7801\u548c\u6570\u636e\u88c5\u5165\u76f8\u5e94\u7684\u865a\u62df\u5185\u5b58\u5730\u5740\u3002\u5176\u4e2d.text\u6bb5\u4f1a\u88ab\u653e\u5728\u6700\u9760\u8fd10\u5730\u5740\u7684\u4f4d\u7f6e\uff08\u4f46\u662f\u8fd9\u4e2a\u4f4d\u7f6e\u4e0d\u4f1a\u662f0\u5730\u5740\uff0c\u5730\u57400\u5728\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u90fd\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u4e0d\u53ef\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u4ee5\u4fbf\u6355\u83b7\u7a7a\u6307\u9488\u8bbf\u95ee\uff09\uff0c\u7136\u540e\u5411\u9ad8\u5730\u5740\u4f9d\u6b21\u6446\u653e.rodata\u6bb5\u3001.data\u6bb5\u3001.bss\u6bb5\u3002\u88c5\u8f7d\u5668\u5c06ELF\u6587\u4ef6.text\u6bb5\u4e2d\u5b58\u653e\u7684\u4ee3\u7801\uff0c.rodata\u6bb5\u6570\u636e\u548c.data\u6bb5\u53d8\u91cf\u7684\u521d\u59cb\u503c\u590d\u5236\u5230\u5185\u5b58\u4e2d\u3002ELF\u6587\u4ef6\u4e2d\u7684.bss\u6bb5\u4e2d\u53ea\u8bb0\u5f55\u5404\u53d8\u91cf\u7684\u5927\u5c0f\uff0c\u7531\u88c5\u8f7d\u5668\u76f4\u63a5\u4e3a\u53d8\u91cf\u5206\u914d\u6240\u9700\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u7136\u540e\u6e05\u96f6\u3002.bss\u6bb5\u4e4b\u4e0a\u662f\u5806\uff08heap\uff09\u7a7a\u95f4\u3002\u5806\u7528\u4e8e\u7ba1\u7406\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u52a8\u6001\u5206\u914d\u7684\u5185\u5b58\uff0c\u5982C\u7a0b\u5e8f\u4e2d\u7528malloc\u51fd\u6570\u5206\u914d\u7684\u5185\u5b58\u5c31\u662f\u653e\u5728\u5806\u7a7a\u95f4\u8fdb\u884c\u7ba1\u7406\u7684\u3002\u5176\u5927\u4f53\u4ece\u4f4e\u5730\u5740\u5411\u9ad8\u5730\u5740\u589e\u957f\uff0c\u4e0d\u8fc7\u5806\u7684\u5206\u914d\u548c\u91ca\u653e\u884c\u4e3a\u6bd4\u8f83\u590d\u6742\uff0c\u5e76\u4e0d\u662f\u7b80\u5355\u7684\u8d85\u4e00\u4e2a\u65b9\u5411\u589e\u957f\u3002\u4ece\u63a5\u8fd1\u7528\u6237\u7a7a\u95f4\u6700\u9ad8\u53ef\u8bbf\u95ee\u5730\u5740\u5411\u4e0b\u7684\u4e00\u6bb5\u7a7a\u95f4\u88ab\u7528\u4f5c\u8be5\u8fdb\u7a0b\u7684\u6808\u3002\u6808\u6cbf\u7740\u9ad8\u5730\u5740\u5411\u4f4e\u5730\u5740\u65b9\u5411\u589e\u957f\uff0c\u5b83\u7528\u4f5c\u51fd\u6570\u7684\u4e34\u65f6\u5de5\u4f5c\u7a7a\u95f4\uff0c\u5b58\u50a8C\u7a0b\u5e8f\u4e2d\u7684\u975e\u9759\u6001\u5c40\u90e8\u53d8\u91cf\u3001\u5b50\u51fd\u6570\u53c2\u6570\u548c\u8fd4\u56de\u5730\u5740\u7b49\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u5c31\u53ef\u4ee5\u629b\u5f03\u7684\u6570\u636e\u3002\u5806\u548c\u6808\u4e4b\u95f4\u7684\u5730\u5740\u7a7a\u95f4\u901a\u5e38\u7528\u6765\u5b58\u653e\u7a0b\u5e8f\u6240\u7528\u5230\u7684\u52a8\u6001\u94fe\u63a5\u5e93\uff0c\u5176\u5177\u4f53\u5730\u5740\u7531\u52a8\u6001\u94fe\u63a5\u5668\u5728\u8fd9\u6bb5\u7a7a\u95f4\u4e2d\u5bfb\u627e\u51fa\u5408\u9002\u7684\u5730\u5740\u3002</p> \u8fdb\u7a0b\u4e2d\u7528\u6237\u5730\u5740\u7a7a\u95f4\u5206\u5e03"},{"location":"assembly/addr_space/#_2","title":"\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u4e0b\u7684\u8fdb\u7a0b\u865a\u62df\u5730\u5740\u7a7a\u95f4\u7ba1\u7406","text":"<p>\u5d4c\u5165\u5f0f\u8bbe\u5907\u4e2d\u5e38\u4f7f\u7528\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u3002\u6b64\u65f6\u8bbe\u5907\u4e0a\u5e76\u4e0d\u4f1a\u8fd0\u884c\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6240\u6709\u7684\u8f6f\u4ef6\u529f\u80fd\u5b9e\u73b0\u5728\u4e00\u4e2a\u8fdb\u7a0b\u4e4b\u4e2d\u3002\u7531\u4e8e\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u7684\u8f6f\u4ef6\u901a\u5e38\u4e5f\u662f\u7528\u6c47\u7f16\u8bed\u8a00\u548cC\u8bed\u8a00\u5f00\u53d1\uff0c\u90a3\u4e48\u81ea\u7136\u4e5f\u9700\u8981\u7528\u5de5\u5177\u94fe\u8fdb\u884c\u7f16\u8bd1\u548c\u94fe\u63a5\u3002\u7531\u4e8e\u6ca1\u6709\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301\u57fa\u4e8e\u9875\u8868\u6620\u5c04\u5730\u5740\u7ffb\u8bd1\u6a21\u5f0f\uff0c\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u4e2d\u901a\u5e38\u91c7\u7528\u76f4\u63a5\u5730\u5740\u6620\u5c04\u7ffb\u8bd1\u6a21\u5f0f1\u3002\u5728\u6b64\u79cd\u5730\u5740\u6620\u5c04\u65b9\u5f0f\u4e0b\uff0c\u7269\u7406\u5730\u5740\u548c\u865a\u5730\u5740\u7684\u6700\u4f4e28\u4f4d\u662f\u76f8\u540c\u7684\u3002\u5bf9\u4e8e\u4e00\u4e2a\u5c0f\u578b\u7684\u5d4c\u5165\u5f0f\u8bbe\u5907\u800c\u8a00\uff0c\u5176\u7269\u7406\u5730\u5740\u7a7a\u95f4\u8303\u56f4\u53ef\u80fd\u90fd\u4e0d\u8d85\u8fc7228\u5b57\u8282\uff0c\u800c\u5176\u4e2d\u80fd\u591f\u5b58\u653e\u4ee3\u7801\u3001\u80fd\u653e\u7f6e\u6808\u7a7a\u95f4\u5730\u5740\u533a\u57df\u90fd\u662f\u6709\u9650\u7684\uff0c\u4e14\u5730\u5740\u5206\u5e03\u672a\u5fc5\u548cLinux\u7cfb\u7edf\u4e0b\u7528\u6237\u8fdb\u7a0b\u5b58\u653e.text\u6bb5\u3001\u6808\u7684\u5730\u5740\u5206\u5e03\u4e00\u81f4\u3002\u56e0\u6b64\uff0c\u5728\u7f16\u8bd1\u94fe\u63a5\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u65f6\uff0c\u901a\u5e38\u90fd\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u5404\u7c7b\u94fe\u63a5\u53c2\u6570\u3002\u8b6c\u5982\uff0cchiplab\u9879\u76ee\u4e2d\u8fd0\u884c<code>my_program</code>\u7684\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u5728\u7f16\u8bd1\u65f6\uff0c\u5c31\u4f7f\u7528\u4e86<code>chiplab/toolchains/system_newlib/pmon.ld</code>\u4f5c\u4e3a\u65b0\u94fe\u63a5\u811a\u672c\u3002\u611f\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u7ed3\u5408\u8fd9\u4e2a\u811a\u672c\u5b66\u4e60\u4f53\u4f1a\u4e00\u4e0b\u3002\u5176\u5b9e\u524d\u9762\u63d0\u5230\u5728Linux\u7cfb\u7edf\u4e0b\u94fe\u63a5\u5668\u4f7f\u7528\u7684\u9ed8\u8ba4\u914d\u7f6e\u7684\u94fe\u63a5\u53c2\u6570\u4e5f\u662f\u901a\u8fc7\u94fe\u63a5\u811a\u672c\u63a7\u5236\u7684\u3002\u4ee5LA32R GCC\u4ea4\u53c9\u7f16\u8bd1\u5de5\u5177\u94fe\u4e3a\u4f8b\uff0c\u8fd9\u4e2a\u9ed8\u8ba4\u7684\u94fe\u63a5\u811a\u672c\u662f<code>loongarch32r-linux-gnusf/lib/ldscripts/elf32loongarch.x</code>\u6587\u4ef6\u3002</p> <ol> <li> <p>\u9664\u4e86\u590d\u4f4d\u7ed3\u675f\u540e\u7684\u4e00\u5c0f\u6bb5\u4ee3\u7801\uff0c\u6211\u4eec\u901a\u5e38\u4e0d\u5efa\u8bae\u8f6f\u4ef6\u8fd0\u884c\u5728\u76f4\u63a5\u5730\u5740\u7ffb\u8bd1\u6a21\u5f0f\u4e0b\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"assembly/as_example/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/as_example/#_1","title":"\u6c47\u7f16\u7f16\u7a0b\u793a\u4f8b","text":""},{"location":"assembly/as_example/#hello-world","title":"Hello, world!","text":"<p>\u9996\u5148\u6211\u4eec\u5148\u5b9e\u73b0\u4e00\u4e2a\u6700\u7ecf\u5178\u7684\u4f8b\u5b50\uff0c\u5373\u5411\u5c4f\u5e55\u4e2d\u8f93\u51fa\"Hello, world!\"\u3002\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u4e86\u89e3\u6c47\u7f16\u7a0b\u5e8f\u7684\u57fa\u672c\u7ed3\u6784\uff0c\u638c\u63e1\u51fd\u6570\u4f5c\u4e3a\u8c03\u7528\u8005\u548c\u88ab\u8c03\u7528\u8005\u9700\u8981\u8003\u8651\u7684\u5bc4\u5b58\u5668\u4f7f\u7528\u89c4\u8303\u3002</p> <p>\u6765\u770b\u770b\u5b83\u7684c\u8bed\u8a00\u63cf\u8ff0\uff1a</p> hello.c<pre><code>int main() {\nputs(\"Hello, world!\\n\");\nreturn 0;\n}\n</code></pre> <p>\u5c1d\u8bd5\u5bf9\u8fd9\u4e2ac\u8bed\u8a00\u63cf\u8ff0\u8fdb\u884c\u7ffb\u8bd1\u3002</p> <p>\u5b57\u7b26\u4e32\"Hello, world!\"\u9700\u8981\u5b58\u50a8\u4e8e\u6570\u636e\u6bb5<code>.data</code>\uff0c\u7ed9\u5176\u4e00\u4e2a\u53ef\u4ee5\u8bbf\u95ee\u7684\u6807\u53f7\uff0c\u8bb0\u4e3a<code>output</code>\u3002</p> hello.S<pre><code>.section .data\noutput: .asciz \"Hello, world!\\n\"\n</code></pre> <p>\u4ee3\u7801\u90e8\u5206\u4f4d\u4e8e<code>.text</code>\u4ee3\u7801\u6bb5\u3002\u7a0b\u5e8f\u7684\u5165\u53e3\u5730\u5740<code>main</code>\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u5168\u5c40\u7b26\u53f7\u3002\u6709\u8bfb\u8005\u5728\u5199\u5176\u4ed6\u8bed\u8a00\u6c47\u7f16\u65f6\u53ef\u80fd\u5c06\u7a0b\u5e8f\u5165\u53e3\u5730\u5740\u8bbe\u7f6e\u4e3a<code>_start</code>\uff0c\u5b9e\u9645\u4e0a\uff0c\u7cfb\u7edf\u6709<code>_start</code>\u51fd\u6570\u3002\u800c\u7cfb\u7edf\u7684<code>_start</code>\u4f1a\u9996\u5148\u505a\u521d\u59cb\u5316\u5de5\u4f5c\uff0c\u4e4b\u540e\u8df3\u8f6c\u81f3<code>main</code>\u6807\u53f7\u5904\uff0c\u7ed3\u675f\u540e\u4f1a\u8fdb\u884c\u56de\u6536\u5de5\u4f5c\u3002\u5982\u679c\u6211\u4eec\u5c06\u7528\u6237\u7a0b\u5e8f\u5165\u53e3\u5730\u5740\u5b9a\u4e49\u4e3a<code>_start</code>\u6807\u53f7\uff0c\u5219\u4f1a\u5c06\u7cfb\u7edf\u7684\u51fd\u6570\u8986\u76d6\u6389\u3002\u6709\u7684\u94fe\u63a5\u5668\u5141\u8bb8\u8fdb\u884c\u8fd9\u6837\u7684\u64cd\u4f5c\u3002\u800cla32r\u7684\u94fe\u63a5\u5668\u5219\u4f1a\u62a5\u544a\u5bf9<code>_start</code>\u7684\u591a\u91cd\u5b9a\u4e49\u9519\u8bef\uff08<code>multiple definition of</code>`<code>_start'</code>\uff09\uff0c\u4ee5\u53ca\u672a\u627e\u5230<code>main</code>\u9519\u8bef\uff08<code>undefined reference to</code>`<code>main'</code>\uff09\u3002\u56e0\u6b64\u6211\u4eec\u5728\u5b9a\u4e49\u7a0b\u5e8f\u5165\u53e3\u65f6\uff0c\u5e94\u5f53\u5b9a\u4e49\u4e00\u4e2a\u5168\u5c40\u7684<code>main</code>\u6807\u53f7\u3002</p> hello.S<pre><code>.section .text\n.globl main\nmain:\n</code></pre> <p>\u8003\u8651\u5230\u9700\u8981\u8c03\u7528<code>puts</code>\u51fd\u6570\uff0c<code>$ra</code>\u53ef\u80fd\u88ab\u6bc1\uff0c\u56e0\u6b64\u9700\u8981\u4fdd\u5b58\u5230\u6808\u5e27\u4e2d\u3002\u5982\u679c\u8be5\u51fd\u6570\u5c31\u662f\u53f6\u5b50\u51fd\u6570\uff0c\u5219\u4e0d\u9700\u8981\u4fdd\u5b58<code>$ra</code>\u3002\u76f8\u5e94\u5730\uff0c\u6808\u6307\u9488\u53ea\u9700\u8981\u51cf\u5c0f\u4e00\u4e2a\u5bc4\u5b58\u5668\u957f\u5ea6\uff0c\u53734\u5b57\u8282\u3002\uff08\u7b2c6\u30017\u884c\uff09</p> <p>\u5728\u8fd4\u56de\u5230<code>main</code>\u7684\u8c03\u7528\u51fd\u6570\u524d\uff0c\u9700\u8981\u6062\u590d<code>$ra</code>\u548c<code>$sp</code>\u3002\uff08\u7b2c11\u300112\u884c\uff09</p> <p>\u51fd\u6570\u8c03\u7528\u65f6\uff0c\u9488\u5bf9\u53c2\u6570\u9700\u8981\u8003\u8651\u4e24\u4e2a\u95ee\u9898\uff1a\u53c2\u6570\u5b58\u5728\u54ea\uff1f\u5b58\u4ec0\u4e48\u5185\u5bb9\uff1f<code>puts</code>\u53ea\u6709\u4e00\u4e2a\u53c2\u6570\uff0c\u6839\u636e\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\uff0c<code>$a0</code>\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668\uff0c\u56e0\u6b64\u5b58\u5165<code>$a0</code>\u4e2d\u3002\u90a3\u4e48<code>$a0</code>\u4e2d\u5b58\u4ec0\u4e48\u5462\uff1f\u6839\u636e</p> <pre><code>int puts(const char *str);\n</code></pre> <p>c\u51fd\u6570\u7684\u58f0\u660e\uff0c\u53ef\u4ee5\u770b\u5230\u5b83\u7684\u53c2\u6570\u662f\u5730\u5740\uff0c\u56e0\u6b64\u5c06\u9700\u8981\u8f93\u51fa\u7684\u5b57\u7b26\u4e32\u5730\u5740\u901a\u8fc7<code>la.local</code>\u6307\u4ee4\u52a0\u8f7d\u5230<code>$a0</code>\u4e2d\u3002\uff08\u7b2c8\u30019\u884c\uff09\u8bfb\u8005\u53ef\u4ee5\u601d\u8003\u4e00\u4e0b\uff0c\u5bf9\u4e8e<code>printf(\"%d\\n\", a);</code>\u548c<code>scanf(\"%d\", &amp;a);</code>\u53c2\u6570\u5e94\u8be5\u5206\u522b\u662f\u4ec0\u4e48\u5f62\u5f0f\u3002</p> <p>\u5728\u8fd4\u56de\u5230<code>main</code>\u7684\u8c03\u7528\u51fd\u6570\u524d\uff0c\u8fd8\u9700\u8981\u8bbe\u7f6e<code>main</code>\u51fd\u6570\u7684\u8fd4\u56de\u503c\u4e3a0\uff0c\u5b58\u5165\u8fd4\u56de\u503c\u5bc4\u5b58\u5668<code>$v0</code>\uff08\u5373<code>$a0</code>\uff09\u4e2d\u3002\uff08\u7b2c10\u300113\u884c\uff09</p> hello.S<pre><code>    addi.w      $sp, $sp, -4\nst.w        $ra, $sp, 0\nla.local    $a0, output\nbl          %plt(puts)\nli.w        $a0, 0\nld.w        $ra, $sp, 0\naddi.w      $sp, $sp, 4\njr          $ra\n</code></pre> <p></p>"},{"location":"assembly/as_example/#hello-world-syscall","title":"Hello, world! syscall\u7248\u672c","text":"<p>\u6b64\u65f6\u6211\u4eec\u805a\u7126\u4e8e\u51fd\u6570\u7684\u4e3b\u4f53\u529f\u80fd\u90e8\u5206\uff0c\u901a\u8fc7\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u4e86\u89e3\u7cfb\u7edf\u8c03\u7528\u7684\u6c47\u7f16\u7a0b\u5e8f\u7f16\u5199\u65b9\u6cd5\u3002</p> <p><code>puts</code>\u5728\u66f4\u5e95\u5c42\u662f\u901a\u8fc7<code>sys_write</code>\u6765\u5b9e\u73b0\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528<code>sys_write</code>\u5b9e\u73b0\u6253\u5370\u529f\u80fd\u3002\u9996\u5148\u8003\u5bdf<code>sys_write</code>\u7684\u53c2\u6570\u683c\u5f0f\uff0c\u5176\u4ed6<code>syscall</code>\u51fd\u6570\u6211\u4eec\u53ef\u4ee5\u67e5\u9605linux\u6e90\u7801<code>include/linux/syscalls.h</code>\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\uff1a</p> <pre><code>long sys_write(unsigned int fd, const char __user *buf, size_t count);\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570<code>fd</code>\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5728POSIX\u8bed\u4e49\u4e2d\uff0c0\u30011\u30012\u8fd9\u4e09\u4e2a\u503c\u5df2\u7ecf\u88ab\u8d4b\u4e88\u7279\u6b8a\u542b\u4e49\uff0c\u5206\u522b\u662f\u6807\u51c6\u8f93\u5165\uff08<code>STDIN_FILENO</code>\uff09\uff0c\u6807\u51c6\u8f93\u51fa\uff08<code>STDOUT_FILENO</code>\uff09\uff0c\u6807\u51c6\u9519\u8bef\uff08<code>STDERR_FILENO</code>\uff09\u3002\u5176\u4ed6\u6587\u4ef6\u63cf\u8ff0\u7b26\u7528\u4e8e\u63cf\u8ff0\u6253\u5f00\u7684\u6587\u4ef6\u3002\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u56e0\u4e3a\u662f\u5411\u5c4f\u5e55\u8f93\u51fa\uff0c\u6211\u4eec\u8bbe\u7f6e<code>fd = 1</code>\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u53c2\u6570\u5373\u4e3a\u524d\u8ff0<code>output</code>\u3002</p> <p>\u7b2c\u4e09\u4e2a\u53c2\u6570\u4e3a\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c\u8fd9\u4e2a\u9700\u8981\u624b\u52a8\u8ba1\u6570\u4e00\u4e0b\u3002</p> <p>\u53c2\u6570\u90fd\u786e\u5b9a\u597d\u4e4b\u540e\uff0c\u6211\u4eec\u9700\u8981\u56de\u5fc6\u4e00\u4e0b\u7cfb\u7edf\u8c03\u7528\u7684\u7ea6\u5b9a\u3002\u548c\u51fd\u6570\u8c03\u7528\u4e0d\u540c\uff0c\u6211\u4eec\u9700\u8981\u5c06\u7cfb\u7edf\u8c03\u7528\u53f7\u5b58\u653e\u4e8e<code>$a7</code>\u4e2d\uff0c\u7528\u5269\u4f59\u7684<code>$a0 ~ $a6</code>\u5bc4\u5b58\u5668\u4f20\u9012\u53c2\u6570\u3002\u5728\u5185\u6838\u6587\u4ef6<code>include/uapi/asm-generic/unistd.h</code>\u4e2d\u67e5\u8be2\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u53ef\u77e5<code>sys_write</code>\u7684\u7cfb\u7edf\u8c03\u7528\u53f7\u4e3a64\u3002\u56e0\u6b64\u80fd\u591f\u5199\u51fa\u4ee5\u4e0b\u4ee3\u7801\uff0c\u540c\u6837\u8fbe\u5230\u5411\u5c4f\u5e55\u6253\u5370\u7684\u6548\u679c\u3002</p> hello_sys.S<pre><code>    li.w        $a7, 64     # syscall number\nli.w        $a0, 1      # fd\nla.local    $a1, output # buf\nli.w        $a2, 14     # count\nsyscall     0\n</code></pre> <p></p>"},{"location":"assembly/as_example/#bubble-sort","title":"bubble sort","text":"<p>\u8fd9\u4e2a\u793a\u4f8b\u5e0c\u671b\u80fd\u591f\u589e\u5f3a\u8bfb\u8005\u5bf9\u51fd\u6570\u8c03\u7528\u8fc7\u7a0b\uff0c\u5bc4\u5b58\u5668\u4f7f\u7528\u89c4\u8303\uff0c\u4ee5\u53ca<code>if</code>/<code>for</code>/\u53cc\u91cd<code>for</code>\u63a7\u5236\u6d41\u7684\u7406\u89e3\u3002\u8fd9\u91cc\u5148\u7ed9\u51fa\u5b83\u7684c\u8bed\u8a00\u7248\u672c\uff0c\u8bfb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u5199\u51fa\u8fd9\u6bb5\u7a0b\u5e8f\u7684\u6c47\u7f16\u8bed\u8a00\u7248\u672c\uff0c\u5e76\u5728\u6211\u4eec\u7684\u5b9e\u9a8c\u5e73\u53f0\u4e0a\u8fd0\u884c\u4ee5\u53ca\u8c03\u8bd5\uff0c\u5982\u9047\u56f0\u96be\u518d\u8fdb\u884c\u540e\u9762\u7684\u9605\u8bfb\u3002</p> bubble_sort.c<pre><code>int arr[50];\nint len;\nvoid bubble_sort(int* array, int len) {\nfor (int i = 0; i &lt; len - 1; i++) {\nfor (int j = 0; j &lt; len \u2013 1 \u2013 i; j++) {\nif (array[j] &gt; array[j + 1]) {\nint temp = array[j];\narray[j] = array[j + 1];\narray[j + 1] = temp;\n}\n}\n}\n}\nint main() {\nscanf(\"%d\", &amp;len);\nfor (int i = 0; i &lt; len; i++) arr[i] = rand() % 100;\nfor (int i = 0; i &lt; len; i++) printf(\"%d \", arr[i]);\nprintf(\"\\n\");\nbubble_sort(arr, len);\nfor (int i = 0; i &lt; len; i++) printf(\"%d \", arr[i]);\nprintf(\"\\n\");\nreturn 0;\n}\n</code></pre> <p>\u8fd9\u4e2a\u4f8b\u5b50\u7684<code>main</code>\u51fd\u6570\u76f8\u5bf9\u6bd4\u8f83\u590d\u6742\u3002\u89c2\u5bdf\u5230<code>main</code>\u51fd\u6570\u4e3b\u8981\u5b8c\u6210\u4e94\u90e8\u5206\u5185\u5bb9\uff1a<code>scanf</code>\uff0c<code>rand</code>\uff0c<code>printf</code>\uff0c<code>bubble_sort</code>\uff0c<code>printf</code>\u3002\u6211\u4eec\u9010\u4e2a\u51fb\u7834\u3002</p>"},{"location":"assembly/as_example/#scanflen","title":"<code>scanf</code>\uff1a\u4ece\u6807\u51c6\u8f93\u5165\u4e2d\u8bfb\u53d6<code>len</code>\u503c","text":"<p>\u51fd\u6570\u8c03\u7528\u524d\u89e3\u51b3\u53c2\u6570\u95ee\u9898\uff1a</p> <pre><code>int scanf(const char *format, ...);\nscanf(\"%d\", &amp;a);\n</code></pre> <p>\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u5b57\u7b26\u4e32\u5730\u5740\uff0c\u4e4b\u540e\u7684\u53c2\u6570\u662f\u53d8\u91cf\u7684\u5730\u5740\u3002\u56e0\u6b64\u5728\u672c\u4f8b\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u63d0\u524d\u5b9a\u4e49\u597d\u5b57\u7b26\u4e32<code>\"%d\"</code>\u4ee5\u53ca<code>len</code>\u53d8\u91cf\uff0c\u4ee5\u4fbf\u4e8e\u540e\u7eed\u5f97\u5230\u5730\u5740\u3002</p> bubble_sort.S: .data<pre><code>.section .data\nlen: .int 0\ninput_format: .asciz \"%d\"\n</code></pre> bubble_sort.S: scanf<pre><code>    la.local    $a0, input_format\nla.local    $a1, len\nbl          scanf\n</code></pre>"},{"location":"assembly/as_example/#randlenlenarr","title":"<code>rand</code>\uff1a\u6839\u636e<code>len</code>\u503c\u751f\u6210<code>len</code>\u4e2a\u968f\u673a\u6570\uff0c\u5b58\u5165<code>arr</code>\u4e2d","text":"<p>\u5355\u91cd<code>for</code>\u5faa\u73af\u63a7\u5236\u6d41 \u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5206\u652f\u8df3\u8f6c\u7c7b\u6307\u4ee4\u4e00\u8282\u63d0\u5230\u7684<code>for</code>\u5faa\u73af\u7ed3\u6784\uff0c\u8fd9\u91cc\u518d\u4ecb\u7ecd\u4e00\u79cd\u7ed3\u6784\uff0c\u53ef\u4ee5\u5728\u5faa\u73af\u4e3b\u4f53\u51cf\u53bb\u4e00\u6761\u5206\u652f\u8df3\u8f6c\u7c7b\u6307\u4ee4\uff0c\u5982\u679c\u5df2\u77e5\u5faa\u73af\u81f3\u5c11\u6267\u884c\u4e00\u6b21\uff0c\u90a3\u4e48\u7b2c3\u884c\u8fd8\u80fd\u518d\u7701\u53bb\uff1a</p> <pre><code>    la.local    $t0, len\nld.w        $t0, $t0, 0\nbne         $t0, $zero, loop\njr          $ra\nloop:\n&lt;do_something&gt;\naddi.w      $t0, $t0, -1\nbgt         $t0, $zero, loop\n</code></pre> <p>\u7136\u800c\u5728\u5b9e\u9645\u5faa\u73af\u4e2d\uff0c\u4ecd\u6709\u4e24\u65b9\u9762\u9700\u8981\u6ce8\u610f\uff1a</p> <ol> <li> <p>\u5982\u679c<code>&lt;do_something&gt;</code>\u4e2d\u6709\u51fd\u6570\u7684\u8c03\u7528\uff0c\u90a3\u4e48\u5b58\u653e\u5faa\u73af\u8ba1\u6570\u7684\u5bc4\u5b58\u5668\u5c31\u4e0d\u80fd\u76f4\u63a5\u7528\u88ab\u8c03\u7528\u8005\u4e0d\u4fdd\u5b58\u7684\u5bc4\u5b58\u5668\uff0c\u5982<code>$t##</code>\u3001<code>$a##</code>\u3002\u90a3\u4e48\u89e3\u51b3\u65b9\u6cd5\uff0c\u53ef\u4ee5\u662f\u5c06<code>$t##</code>\u5728<code>&lt;do_something&gt;</code>\u524d\u4fdd\u5b58\u81f3\u6808\u4e2d\uff0c\u5728<code>&lt;do_something&gt;</code>\u540e\u53d6\u51fa\u4f7f\u7528\uff0c\u8be5\u65b9\u6cd5\u4f1a\u5728\u5faa\u73af\u4e2d\u4ea7\u751f\u8f83\u591a\u8bbf\u5b58\uff1b\u4e5f\u53ef\u4ee5\u8003\u8651\u4f7f\u7528<code>$s##</code>\u4f5c\u4e3a\u5faa\u73af\u8ba1\u6570\u53d8\u91cf\uff0c\u800c\u4ee3\u4ef7\u662f\u4f7f\u7528\u524d\u9700\u8981\u5c06\u65e7\u503c\u5b58\u5165\u6808\u4e2d\uff0c\u4ee5\u53ca\u5728\u8be5\u51fd\u6570\u8fd4\u56de\u524d\u5c06\u5176\u6062\u590d\u51fa\u6765\u3002\u76f4\u89c2\u611f\u89c9\u662f\u7b2c\u4e8c\u4e2a\u65b9\u6cd5\u66f4\u6709\u5229\u4e8e\u5faa\u73af\u7684\u9ad8\u6548\u6267\u884c\u3002</p> </li> <li> <p>\u867d\u7136\u6211\u4eec\u5728c\u8bed\u8a00\u4e2d\u5e38\u4f7f\u7528\u7684\u5faa\u73af\u589e\u91cf\u4e3a1\uff0c\u4f46\u5982\u679c\u8003\u8651\u5230\u8fd9\u4e2a\u5faa\u73af\u8ba1\u6570\u503c\u6211\u4eec\u5c06\u7528\u4e8e\u6570\u7ec4\u7684\u8bbf\u95ee\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u6570\u636e\u5bbd\u5ea6\u8bbe\u7f6e\u5faa\u73af\u589e\u91cf\uff0c\u5e76\u4e14\u5faa\u73af\u521d\u59cb\u503c\u3001\u7ed3\u675f\u6761\u4ef6\u53ef\u4ee5\u7a0d\u4f5c\u8c03\u6574\uff0c\u5c06\u5176\u8fdb\u884c\u7b49\u4ef7\u8f6c\u6362\uff1a</p> <pre><code>    // before\nfor (int i = 0; i &lt; len; i++) arr[i] = rand() % 100;\n// after    \nuint32_t addr;\nfor (addr = &amp;arr[0]; addr &lt;= &amp;arr[len - 1]; addr += 4) *(int*)addr = rand() % 100;\n</code></pre> <p>\u5982\u679c\u6211\u4eec\u7528\u4e00\u4e2a\u5bc4\u5b58\u5668\u4f5c\u4e3a\u5faa\u73af\u8ba1\u6570\u5bc4\u5b58\u5668\uff0c\u90a3\u4e48\u5728\u83b7\u53d6<code>arr[i]</code>\u65f6\uff0c\u9700\u8981\u5b8c\u6210<code>addr = (uint32_t)&amp;arr[0] + i * 4</code>\u7684\u8ba1\u7b97\u3002\u6211\u4eec\u53ef\u4ee5\u8f6c\u6362\u6210\u6c47\u7f16\u505a\u4e00\u4e2a\u5bf9\u6bd4\u3002</p> <pre><code># before\n# $t0 = i\n# $t1 = &amp;arr[0]\n# $t3 = store value\nloop:\nslli.w      $t2, $t0, 2     # $t2 = i * 4\nadd.w       $t2, $t1, $t2   # $t2 = i * 4 + &amp;arr[0]\nst.w        $t3, $t2, 0\naddi.w      $t0, $t0, 1\n# after\n# $t0 = &amp;arr[i]\n# $t1 = store value\nloop:\nst.w        $t1, $t0, 0\naddi.w      $t0, $t0, 4\n</code></pre> </li> </ol> <p>\u6570\u7ec4\u5b9a\u4e49 \u4e0e<code>len</code>\u7c7b\u4f3c\uff0c\u6570\u7ec4\u9700\u8981\u63d0\u524d\u5728\u6570\u636e\u6bb5\u5b9a\u4e49\u624d\u80fd\u8fdb\u884c\u8bbf\u95ee\u3002\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u4e4b\u524d\u63d0\u5230\u7684<code>.rept ... .endr</code>\u6c47\u7f16\u6307\u793a\u6765\u5b9a\u4e4950\u4e2a\u53d8\u91cf\u3002</p> <p>\u51fd\u6570\u8fd4\u56de \u8fd9\u91cc<code>rand</code>\u662f\u4e00\u4e2a\u65e0\u53c2\u6570\u4f46\u662f\u6709\u8fd4\u56de\u503c\u7684\u51fd\u6570\uff0c\u6ce8\u610f\u8fd4\u56de\u503c\u5b58\u4e8e<code>$a0</code>\u4e2d\u3002</p> <p>\u90a3\u4e48\u53ef\u4ee5\u5f00\u59cb\u7f16\u5199\u8fd9\u90e8\u5206\u5185\u5bb9\u3002</p> bubble_sort.S: .data<pre><code>.section .data\nvalue_array: .rept 50\n.int 0\n.endr\n</code></pre> bubble_sort.S: main: rand<pre><code>.section .text\n.globl main\nmain:\naddi.w      $sp, $sp, -16\nst.w        $ra, $sp, 0\nst.w        $s0, $sp, 4         # s0 = &amp;value_array\nst.w        $s1, $sp, 8         # s1 = len\nst.w        $s2, $sp, 12\n...\nla.local    $s0, value_array    # $s0 = &amp;arr[0]\nla.local    $s1, len\nld.w        $s1, $s1, 0         # $s1 = len\nmove        $s2, $s1\naddi.w      $s2, $s2, -1\nslli.w      $s2, $s2, 2\nadd.w       $s2, $s0, $s2       # $s2 = &amp;arr[len - 1]\nloop_r:\nbl          rand\nli.w        $t0, 100            # \u4f7f\u7528$t0\u5bc4\u5b58\u5668\uff0c\u6bcf\u6b21\u5faa\u73af\u90fd\u9700\u8981\u52a0\u8f7d\nmod.w       $t0, $a0, $t0\nst.w        $t0, $s2, 0\naddi.w      $s2, $s2, -4        # \u5012\u7740\u751f\u6210\u7684\u968f\u673a\u503c\nbge         $s2, $s0, loop_r\n...\nld.w        $ra, $sp, 0\nld.w        $s0, $sp, 4\nld.w        $s1, $sp, 8\nld.w        $s2, $sp, 12\naddi.w      $sp, $sp, 16\njr          $ra\n</code></pre>"},{"location":"assembly/as_example/#printf","title":"<code>printf</code>\uff1a\u6253\u5370\u6570\u7ec4\u503c","text":"<p>\u6ce8\u610f\u5230<code>main</code>\u4e2d\u4e24\u6b21<code>printf</code>\u7684\u64cd\u4f5c\u5185\u5bb9\u662f\u4e00\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u63d0\u53d6\u4e3a\u4e00\u4e2a\u516c\u5171\u51fd\u6570\uff1a</p> <pre><code>void output_data(int* array, int len) {\nfor (int i = 0; i &lt; len; i++) printf(\"%d \", arr[i]);\nputs(\"\\n\");\n}\n</code></pre> <p><code>for</code>\u5faa\u73af\u7684\u5199\u6cd5\u4e0e\u6ce8\u610f\u4e8b\u9879\u5df2\u5728\u524d\u4e00\u5c0f\u8282\u63d0\u53ca\uff0c\u8fd9\u91cc\u518d\u5f3a\u8c03\u4e00\u4e0b<code>printf</code>\u7684\u5199\u6cd5\u3002</p> <pre><code>int printf(const char *format, ...);\nprintf(\"%d \", a);\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230<code>printf</code>\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u5b57\u7b26\u4e32<code>\"%d \"</code>\u548c\u6574\u5f62\u53d8\u91cf<code>a</code>\uff0c\u5b57\u7b26\u4e32\u53d8\u91cf\u9700\u5728\u6570\u636e\u6bb5\u5b9a\u4e49\u3002\u6574\u5f62\u53d8\u91cf\u5373\u4e3a\u6570\u7ec4\u7b2c<code>i</code>\u9879\u7684\u503c\uff08\u6ce8\u610f\u4e0d\u662f\u5730\u5740\uff09\uff0c\u6b64\u5904\u6d89\u53ca\u8bbf\u5b58\u3002</p> bubble_sort.S: .data<pre><code>.section .data\nprint_format: .asciz \"%d \"\nprint_line: .asciz \"\\n\"\n</code></pre> bubble_sort.S: main: output_data<pre><code>    move        $a0, $s0            # arg1: start_addr = &amp;value_array\nmove        $a1, $s1            # arg2: len\nbl          output_data\n</code></pre> bubble_sort.S: printf<pre><code>.type output_data, @function\noutput_data:\naddi.w      $sp, $sp, -16\nst.w        $ra, $sp, 0\nst.w        $s0, $sp, 4\nst.w        $s1, $sp, 8\nst.w        $s2, $sp, 12\nmove        $s0, $a1            # s0 = len\nmove        $s1, $a0            # s1 = value addr\nla.local    $s2, print_format   # s2 = printf arg1(print_format)\nloop_o:\nmove        $a0, $s2            # a0 = s2\nld.w        $a1, $s1, 0         # a1 = printf arg2(value)\nbl          printf\naddi.w      $s1, $s1, 4\naddi.w      $s0, $s0, -1\nbne         $s0, $zero, loop_o\nla.local    $a0, print_line\nbl          puts\nld.w        $ra, $sp, 0\nld.w        $s0, $sp, 4\nld.w        $s1, $sp, 8\nld.w        $s2, $sp, 12\naddi.w      $sp, $sp, 16\njr          $ra\n</code></pre>"},{"location":"assembly/as_example/#bubble_sort","title":"<code>bubble_sort</code>\uff1a\u5192\u6ce1\u6392\u5e8f","text":"<p>\u8fd9\u662f\u4e00\u4e2a\u53cc\u91cd<code>for</code>\u5faa\u73af\u7684\u63a7\u5236\u6d41\uff0c\u5728\u7f16\u5199<code>for</code>\u5faa\u73af\u65f6\uff0c\u6211\u4eec\u9700\u8981\u60f3\u6e05\u695a\u521d\u59cb\u503c\u662f\u4ec0\u4e48\uff0c\u7ec8\u6b62\u6761\u4ef6\u662f\u4ec0\u4e48\uff0c\u5faa\u73af\u589e\u91cf\u600e\u4e48\u8bbe\u7f6e\uff0c\u5faa\u73af\u4e3b\u4f53\u8981\u505a\u4ec0\u4e48\u3002</p> <p>\u524d\u9762\u6211\u4eec\u63d0\u5230\uff0c\u51fa\u4e8e\u8bbf\u95ee\u6570\u7ec4\u7684\u4fbf\u6377\u6027\u8003\u8651\uff0c\u6211\u4eec\u4f1a\u5c06\u5faa\u73af\u8ba1\u6570\u53d8\u91cf\u6539\u9020\u4e3a\u6bcf\u6b21\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u8fd9\u91cc\u8fdb\u884c\u76f8\u540c\u7684\u6539\u9020\uff1a</p> <pre><code>    // before\nfor (int i = 0; i &lt; len - 1; i++) {\nfor (int j = 0; j &lt; len \u2013 1 \u2013 i; j++) {\nif (array[j] &gt; array[j + 1]) {\nint temp = array[j];\narray[j] = array[j + 1];\narray[j + 1] = temp;\n}\n}\n}\n// after\nuint32_t addr_i, addr_j;\nfor (addr_i = &amp;array[0]; addr_i &lt; &amp;array[len - 1]; addr_i += 4) {\nfor (addr_j = (uint32_t)&amp;array[0]; \\\n             addr_j &lt;= (uint32_t)&amp;array[len - 1] - 4 * i; \\\n             addr_j += 4) {\nint a = *(int*)addr_j;\nint b = *(int*)(addr_j + 4);\nif (a &gt; b) {\n*(int*)addr_j = b;\n*(int*)(addr_j + 4) = a;\n}\n}\n}\n</code></pre> <p>\u6ce8\u610f\u5230\u8fd9\u91cc\u5faa\u73af\u5185\u90e8\u6ca1\u6709\u51fd\u6570\u8c03\u7528\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u653e\u5fc3\u5927\u80c6\u5730\u4f7f\u7528<code>$t##</code>\u548c<code>$a##</code>\u3002</p> <p>\u5206\u6790\u4e00\u4e0b\u5bc4\u5b58\u5668\u5206\u914d\u65b9\u6848\uff1a</p> <ol> <li> <p><code>addr_j</code>\u6bcf\u6b21\u90fd\u4ece<code>&amp;array[0]</code>\u5f00\u59cb\uff0c\u6240\u4ee5\u5fc5\u987b\u5b58<code>&amp;array[0]</code>\uff0c<code>$a0</code>\u4f5c\u4e3a\u53c2\u6570\u5929\u7136\u5b58\u4e86\u8fd9\u4e2a\u503c\u3002</p> </li> <li> <p><code>addr_i</code>\u8981\u4e0e\u7ec8\u6b62\u6761\u4ef6<code>&amp;array[len - 1]</code>\u5224\u65ad\uff0c\u56e0\u6b64\u8981\u5b58<code>&amp;array[len - 1]</code>\uff0c<code>$a1</code>\u539f\u672c\u5b58<code>len</code>\uff0c\u7ecf\u8fc7<code>(len - 1) &lt;&lt; 2 + $a0</code>\u7684\u53d8\u6362\u53ef\u4ee5\u5f97\u5230\uff0c\u76f4\u63a5\u5b58\u4e8e<code>$a1</code>\u4e2d\u5373\u53ef\u3002</p> </li> <li> <p>\u5b58\u50a8<code>addr_i</code>\u9700\u8981\u4e00\u4e2a\u5bc4\u5b58\u5668\uff0c\u8bb0\u4e3a<code>$a2</code>\uff1b\u5b58\u50a8<code>addr_j</code>\u9700\u8981\u4e00\u4e2a\u5bc4\u5b58\u5668\uff0c\u8bb0\u4e3a<code>$t0</code>\u3002</p> </li> <li> <p><code>addr_j</code>\u7684\u7ec8\u6b62\u503c\u4e0d\u7528\u6bcf\u6b21\u90fd\u8ba1\u7b97\uff0c\u53ef\u4ee5\u5728\u6bcf\u6b21\u5916\u5c42\u5faa\u73af\u66f4\u65b0\u53d8\u91cf\u65f6\u66f4\u65b0\u5185\u5c42\u5faa\u73af\u7ec8\u6b62\u503c\uff0c\u521d\u59cb\u8bbe\u4e3a<code>$a1</code>\uff0c\u6bcf\u6b21\u51cf4\u5373\u53ef\uff0c\u8bb0\u4e3a<code>$t1</code>\u3002</p> </li> <li> <p>\u9700\u8981\u83b7\u53d6<code>addr_j</code>\u548c<code>addr_j + 4</code>\u5730\u5740\u5904\u7684\u503c\uff0c\u5206\u522b\u8bb0\u4e3a<code>$t2</code>\u548c<code>$t3</code>\u3002</p> </li> </ol> <p>\u636e\u6b64\uff0c\u53ef\u4ee5\u8bbe\u8ba1<code>bubble_sort</code>\u7684\u4ee3\u7801\u4e86\u3002</p>"},{"location":"assembly/as_example/#_2","title":"\u5b8c\u6574\u6c47\u7f16\u7a0b\u5e8f","text":"<p>\u8fd9\u91cc\u7ed9\u8bfb\u8005\u63d0\u4f9b\u4e00\u4e2a\u80fd\u591f\u6b63\u786e\u5b9e\u73b0bubble sort\u7684\u6c47\u7f16\u4ee3\u7801\u793a\u4f8b\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002</p> bubble_sort.S<pre><code>.section .data\nvalue_array: .rept 50\n.int 0\n.endr\nlen: .int 0\ninput_format: .asciz \"%d\"\nprint_format: .asciz \"%d \"\nprint_line: .asciz \"\\n\"\n.section .text\n.globl main\nmain:\naddi.w      $sp, $sp, -16\nst.w        $ra, $sp, 0\nst.w        $s0, $sp, 4         # s0 = &amp;value_array\nst.w        $s1, $sp, 8         # s1 = len\nst.w        $s2, $sp, 12\nla.local    $a0, input_format\nla.local    $a1, len\nbl          scanf\nla.local    $s0, value_array\nla.local    $s1, len\nld.w        $s1, $s1, 0\nmove        $s2, $s1\naddi.w      $s2, $s2, -1\nslli.w      $s2, $s2, 2\nadd.w       $s2, $s0, $s2\nloop_r:\nbl          rand\nli.w        $t0, 100\nmod.w       $t0, $a0, $t0\nst.w        $t0, $s2, 0\naddi.w      $s2, $s2, -4\nbge         $s2, $s0, loop_r\nmove        $a0, $s0            # arg1: start_addr = &amp;value_array\nmove        $a1, $s1            # arg2: len\nbl          output_data\nmove        $a0, $s0            # arg1: start_addr = &amp;value_array\nmove        $a1, $s1            # arg2: len\nbl          bubble_sort\nmove        $a0, $s0            # arg1: start_addr = &amp;value_array\nmove        $a1, $s1            # arg2: len\nbl          output_data\nmove        $a0, $zero\nld.w        $ra, $sp, 0\nld.w        $s0, $sp, 4\nld.w        $s1, $sp, 8\nld.w        $s2, $sp, 12\naddi.w      $sp, $sp, 16\njr          $ra\n.type bubble_sort, @function\nbubble_sort:\naddi.w      $t0, $zero, 1\nbne         $a1, $t0, sort\njr          $ra\nsort:\naddi.w      $sp, $sp, -4\nst.w        $ra, $sp, 0\n# a0 = value start addr\nmove        $a2, $a0            # a2 = i start addr\naddi.w      $a1, $a1, -1\nslli.w      $a1, $a1, 2\nadd.w       $a1, $a1, $a0       # a1 = value end addr\nmove        $t1, $a1            # t1 = j end addr, i loop changes\nloop_i:\nmove        $t0, $a0            # t0 = j start addr, j loop changes\nloop_j:\nld.w        $t2, $t0, 0         # t2 = value[j]\nld.w        $t3, $t0, 4         # t3 = value[j+1]\nble         $t2, $t3, noswap\nst.w        $t2, $t0, 4\nst.w        $t3, $t0, 0\nnoswap:\naddi.w      $t0, $t0, 4\nbne         $t0, $t1, loop_j\naddi.w      $a2, $a2, 4\naddi.w      $t1, $t1, -4\nbne         $a2, $a1, loop_i\nend_loop_i:\nld.w        $ra, $sp, 0\naddi.w      $sp, $sp, 4\njr          $ra\n.type output_data, @function\noutput_data:\naddi.w      $sp, $sp, -16\nst.w        $ra, $sp, 0\nst.w        $s0, $sp, 4\nst.w        $s1, $sp, 8\nst.w        $s2, $sp, 12\nmove        $s0, $a1            # s0 = len\nmove        $s1, $a0            # s1 = value addr\nla.local    $s2, print_format   # s2 = printf arg1(print_format)\nloop_o:\nmove        $a0, $s2            # a0 = s2\nld.w        $a1, $s1, 0         # a1 = printf arg2(value)\nbl          printf\naddi.w      $s1, $s1, 4\naddi.w      $s0, $s0, -1\nbne         $s0, $zero, loop_o\nla.local    $a0, print_line\nbl          puts\nld.w        $ra, $sp, 0\nld.w        $s0, $sp, 4\nld.w        $s1, $sp, 8\nld.w        $s2, $sp, 12\naddi.w      $sp, $sp, 16\njr          $ra\n</code></pre>"},{"location":"assembly/calling_convention/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/calling_convention/#_1","title":"\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a","text":""},{"location":"assembly/calling_convention/#ilp32-abi","title":"ILP32 ABI\u57fa\u672c\u6574\u578b\u8c03\u7528\u89c4\u8303","text":"<p>\u6211\u4eec\u8fd9\u91cc\u53ea\u4ecb\u7ecdLA32R\u6700\u5e38\u7528\u7684ILP32 ABI\u4e2d\u7684\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a\u3002\u5176\u5b9e\u8bfb\u8005\u4e86\u89e3\u5176\u4e2d\u7b2c1\u30012\u300110\u6761\u5c31\u80fd\u6ee1\u8db3\u5927\u591a\u6570\u573a\u666f\u4e0b\u7684\u6c47\u7f16\u5f00\u53d1\u9700\u6c42\u3002</p> <ol> <li>\u57fa\u672c\u6574\u578b\u8c03\u7528\u89c4\u8303\u63d0\u4f9b\u4e868\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668<code>$a0 ~ $a7</code>\u7528\u4e8e\u53c2\u6570\u4f20\u9012\uff0c\u524d\u4e24\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668<code>$a0 ~ $a1</code>\u4e5f\u7528\u4e8e\u8fd4\u56de\u503c\u3002</li> <li>\u82e5\u4e00\u4e2a\u6807\u91cf\u4f4d\u5bbd\u81f3\u591a32\u4f4d\uff0c\u5219\u5b83\u5728\u5355\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u82e5\u6ca1\u6709\u53ef\u7528\u7684\u5bc4\u5b58\u5668\uff0c\u5219\u5728\u5806\u6808\u4e2d\u4f20\u9012\uff1b\u82e5\u4e00\u4e2a\u6807\u91cf\u5bbd\u5ea6\u8d85\u8fc732\u4f4d\uff0c\u4e0d\u8d85\u8fc764\u4f4d\uff0c\u5219\u53ef\u4ee5\u5728\u4e00\u5bf9\u53c2\u6570\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u4f4e32\u4f4d\u5728\u5c0f\u7f16\u53f7\u5bc4\u5b58\u5668\u4e2d\uff0c\u9ad832\u4f4d\u5728\u5927\u7f16\u53f7\u5bc4\u5b58\u5668\u4e2d\uff1b\u82e5\u6ca1\u6709\u53ef\u7528\u7684\u53c2\u6570\u5bc4\u5b58\u5668\uff0c\u5219\u5728\u5806\u6808\u4e0a\u4f20\u9012\u6807\u91cf\uff1b\u82e5\u53ea\u6709\u4e00\u4e2a\u5bc4\u5b58\u5668\u53ef\u7528\uff0c\u5219\u4f4e32\u4f4d\u5728\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u9ad832\u4f4d\u5728\u5806\u6808\u4e2d\u4f20\u9012\u3002\u82e5\u4e00\u4e2a\u6807\u91cf\u5bbd\u5ea6\u5927\u4e8e64\u4f4d\uff0c\u5219\u901a\u8fc7\u5f15\u7528\u4f20\u9012\uff0c\u5e76\u5728\u53c2\u6570\u5217\u8868\u4e2d\u7528\u5730\u5740\u66ff\u6362\u3002\u4f20\u9012\u5230\u5806\u6808\u4e0a\u7684\u6807\u91cf\u4f1a\u5bf9\u9f50\u5230\u7c7b\u578b\u5bf9\u9f50\uff08Type Alignment\uff09\u548c32\u4e2d\u7684\u8f83\u5927\u8005\uff0c\u4f46\u4e0d\u4f1a\u8d85\u8fc7\u5806\u6808\u5bf9\u9f50\u3002\u5f53\u6574\u578b\u53c2\u6570\u4f20\u5165\u5bc4\u5b58\u5668\u6216\u5806\u6808\u65f6\uff0c\u5c0f\u4e8e32\u4f4d\u7684\u6574\u578b\u6807\u91cf\u6839\u636e\u5176\u7c7b\u578b\u7684\u7b26\u53f7\u6269\u5c55\u81f332\u4f4d\u3002\u5f53\u6d6e\u70b9\u578b\u53c2\u6570\u4f20\u5165\u5bc4\u5b58\u5668\u6216\u5806\u6808\u65f6\uff0c\u6bd432\u4f4d\u7a84\u7684\u6d6e\u70b9\u7c7b\u578b\u5c06\u88ab\u6269\u5c55\u4e3a32\u4f4d\u3002</li> <li>\u82e5\u4e00\u4e2a\u805a\u5408\u4f53\u7684\u7684\u4f4d\u5bbd\u4e0d\u8d85\u8fc732\u4f4d\uff0c\u5219\u8fd9\u4e2a\u805a\u5408\u4f53\u53ef\u4ee5\u5728\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u5e76\u4e14\u8fd9\u4e2a\u805a\u5408\u4f53\u5728\u5bc4\u5b58\u5668\u4e2d\u7684\u5b57\u6bb5\u5e03\u5c40\u540c\u5b83\u5728\u5185\u5b58\u4e2d\u7684\u5b57\u6bb5\u5e03\u5c40\u4fdd\u6301\u4e00\u81f4\uff1b\u82e5\u6ca1\u6709\u53ef\u7528\u7684\u5bc4\u5b58\u5668\uff0c\u5219\u5728\u5806\u6808\u4e0a\u4f20\u9012\u805a\u5408\u4f53\uff1b\u82e5\u4e00\u4e2a\u805a\u5408\u4f53\u7684\u4f4d\u5bbd\u8d85\u8fc732\u4f4d\uff0c\u4e0d\u8d85\u8fc764\u4f4d\uff0c\u5219\u53ef\u4ee5\u5728\u4e00\u5bf9\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u82e5\u53ea\u6709\u4e00\u4e2a\u5bc4\u5b58\u5668\u53ef\u7528\uff0c\u5219\u805a\u5408\u4f53\u7684\u524d\u534a\u90e8\u5206\u5728\u5bc4\u5b58\u5668\u4e2d\u4f20\u9012\uff0c\u540e\u534a\u90e8\u5206\u5728\u5806\u6808\u4e2d\u4f20\u9012\uff1b\u82e5\u6ca1\u6709\u53ef\u7528\u7684\u5bc4\u5b58\u5668\uff0c\u5219\u5728\u5806\u6808\u4e0a\u4f20\u9012\u805a\u5408\u4f53\u3002\u7531\u4e8e\u586b\u5145\uff08padding\uff09\u800c\u672a\u4f7f\u7528\u7684\u4f4d\uff0c\u4ee5\u53ca\u4ece\u805a\u5408\u4f53\u7684\u672b\u5c3e\u81f3\u4e0b\u4e00\u4e2a\u5bf9\u9f50\u4f4d\u7f6e\u4e4b\u95f4\u7684\u4f4d\uff0c\u90fd\u662f\u672a\u5b9a\u4e49\u7684\uff1b\u82e5\u4e00\u4e2a\u805a\u5408\u4f53\u4f4d\u5bbd\u5927\u4e8e64\u4f4d\uff0c\u5219\u5b83\u901a\u8fc7\u5f15\u7528\u4f20\u9012\uff0c\u5e76\u5728\u53c2\u6570\u5217\u8868\u4e2d\u88ab\u66ff\u6362\u4e3a\u5730\u5740\u3002\u4f20\u9012\u5230\u5806\u6808\u4e0a\u7684\u805a\u5408\u4f53\u4f1a\u5bf9\u9f50\u5230\u7c7b\u578b\u5bf9\u9f50\uff08type alignment\uff09\u548c32\u4e2d\u7684\u8f83\u5927\u8005\uff0c\u4f46\u4e0d\u4f1a\u8d85\u8fc7\u5806\u6808\u5bf9\u9f50\u3002</li> <li>\u5bf9\u4e8e\u7a7a\u7684\u7ed3\u6784\u4f53\u6216\u8054\u5408\u4f53\uff08unions\uff09\u53c2\u6570\u6216\u8fd4\u56de\u503c\uff0cC\u7f16\u8bd1\u5668\u4f1a\u8ba4\u4e3a\u5b83\u4eec\u662f\u975e\u6807\u51c6\u6269\u5c55\u5e76\u5ffd\u7565\uff1b C++\u7f16\u8bd1\u5668\u5219\u4e0d\u662f\u8fd9\u6837\uff0cC++\u7f16\u8bd1\u5668\u8981\u6c42\u5b83\u4eec\u5fc5\u987b\u662f\u5206\u914d\u4e86\u5927\u5c0f\u7684\u7c7b\u578b\uff08sized types\uff09\u3002</li> <li> <p>\u4f4d\u57df\uff08bitfields\uff09\u4ee5\u5c0f\u7aef\u987a\u5e8f\u6392\u5217\u3002\u8de8\u8d8a\u5176\u6574\u578b\u7c7b\u578b\u7684\u5bf9\u9f50\u8fb9\u754c\u7684\u4f4d\u57df\u5c06\u4ece\u4e0b\u4e00\u4e2a\u5bf9\u9f50\u8fb9\u754c\u5f00\u59cb\u3002\u4f8b\u5982:</p> <ul> <li> <p><code>struct {int x:10; int y:12;}</code>\u662f\u4e00\u4e2a32\u4f4d\u7c7b\u578b\uff0c<code>x</code> \u4e3a 9-0 \u4f4d\uff0c<code>y</code> \u4e3a 21-10 \u4f4d\uff0c31-22 \u4f4d\u672a\u5b9a\u4e49\u3002</p> </li> <li> <p><code>struct {short x:10; short y:12;}</code>\u662f\u4e00\u4e2a 32 \u4f4d\u7c7b\u578b\uff0c<code>x</code> \u4e3a 9-0 \u4f4d\uff0c<code>y</code> \u4e3a 27-16 \u4f4d\uff0c31-28 \u4f4d\u548c 15-10\u4f4d\u672a\u5b9a\u4e49\u3002</p> </li> </ul> </li> <li> <p>\u901a\u8fc7\u5f15\u7528\u4f20\u9012\u7684\u5b9e\u53c2\u53ef\u4ee5\u7531\u88ab\u8c03\u7528\u65b9\u4fee\u6539\u3002</p> </li> <li>\u6d6e\u70b9\u5b9e\u6570\u7684\u4f20\u9012\u65b9\u5f0f\u4e0e\u76f8\u540c\u5927\u5c0f\u7684\u805a\u5408\u4f53\u76f8\u540c\uff0c\u6d6e\u70b9\u578b\u590d\u6570\u7684\u4f20\u9012\u65b9\u5f0f\u4e0e\u5305\u542b\u4e24\u4e2a\u6d6e\u70b9\u5b9e\u6570\u7684\u7ed3\u6784\u4f53\u76f8\u540c\u3002</li> <li>\u5728\u57fa\u672c\u6574\u578b\u8c03\u7528\u89c4\u8303\u4e2d\uff0c\u53ef\u53d8\u53c2\u6570\u7684\u4f20\u9012\u65b9\u5f0f\u4e0e\u547d\u540d\u53c2\u6570\u76f8\u540c\uff0c\u4f46\u6709\u4e00\u4e2a\u4f8b\u5916\u300264\u4f4d\u5bf9\u9f50\u7684\u53ef\u53d8\u53c2\u6570\u548c\u81f3\u591a64\u4f4d\u5927\u5c0f\u7684\u53ef\u53d8\u53c2\u6570\u901a\u8fc7\u4e00\u5bf9\u5bf9\u9f50\u7684\u5bc4\u5b58\u5668\u4f20\u9012\uff08\u4f8b\u5982\uff1a\u5bc4\u5b58\u5668\u5bf9\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5bc4\u5b58\u5668\u4e3a\u5076\u6570\uff09\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u5bc4\u5b58\u5668\uff0c\u5219\u5728\u5806\u6808\u4e0a\u4f20\u9012\u3002\u5f53\u53ef\u53d8\u53c2\u6570\u5728\u5806\u6808\u4e0a\u88ab\u4f20\u9012\u540e\uff0c\u6240\u6709\u4e4b\u540e\u7684\u53c2\u6570\u4e5f\u5c06\u5728\u5806\u6808\u4e0a\u88ab\u4f20\u9012\uff08\u4f8b\u5982\uff0c\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u5bc4\u5b58\u5668\u53ef\u80fd\u7531\u4e8e\u5bf9\u9f50\u5bc4\u5b58\u5668\u5bf9\u89c4\u5219\u800c\u672a\u88ab\u4f7f\u7528\uff09\u3002</li> <li>\u8fd4\u56de\u503c\u7684\u4f20\u9012\u65b9\u5f0f\u4e0e\u7b2c\u4e00\u4e2a\u540c\u7c7b\u578b\u547d\u540d\u53c2\u6570\uff08named value\uff09\u7684\u4f20\u9012\u65b9\u5f0f\u76f8\u540c\u3002\u5982\u679c\u8fd9\u6837\u7684\u5b9e\u53c2\u662f\u901a\u8fc7\u5f15\u7528\u4f20\u9012\u7684\uff0c\u5219\u8c03\u7528\u8005\u4e3a\u8fd4\u56de\u503c\u5206\u914d\u5185\u5b58\uff0c\u5e76\u5c06\u5730\u5740\u4f5c\u4e3a\u9690\u5f0f\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u4f20\u9012\u3002</li> <li>\u5806\u6808\u5411\u4e0b\u589e\u957f\uff08\u671d\u5411\u66f4\u4f4e\u7684\u5730\u5740\uff09\uff0c\u5806\u6808\u6307\u9488\u5e94\u8be5\u5bf9\u9f50\u5230\u4e00\u4e2a16\u5b57\u8282\u7684\u8fb9\u754c\u4e0a\u4f5c\u4e3a\u51fd\u6570\u5165\u53e3\u3002\u5728\u5806\u6808\u4e0a\u4f20\u9012\u7684\u7b2c\u4e00\u4e2a\u5b9e\u53c2\u4f4d\u4e8e\u51fd\u6570\u5165\u53e3\u7684\u5806\u6808\u6307\u9488\u504f\u79fb\u91cf\u4e3a\u96f6\u7684\u5730\u65b9\uff1b\u540e\u9762\u7684\u53c2\u6570\u5b58\u50a8\u5728\u66f4\u9ad8\u7684\u5730\u5740\u4e2d\u3002</li> <li>\u5728\u6807\u51c6 ABI \u4e2d\uff0c\u5806\u6808\u6307\u9488\u5728\u6574\u4e2a\u51fd\u6570\u6267\u884c\u8fc7\u7a0b\u4e2d\u5fc5\u987b\u4fdd\u6301\u5bf9\u9f50\u3002\u975e\u6807\u51c6 ABI \u4ee3\u7801\u5fc5\u987b\u5728\u8c03\u7528\u6807\u51c6 ABI \u8fc7\u7a0b\u4e4b\u524d\u91cd\u65b0\u8c03\u6574\u5806\u6808\u6307\u9488\u3002\u64cd\u4f5c\u7cfb\u7edf\u5728\u8c03\u7528\u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u4e4b\u524d\u5fc5\u987b\u91cd\u65b0\u8c03\u6574\u5806\u6808\u6307\u9488\uff1b\u56e0\u6b64\uff0cPOSIX \u4fe1\u53f7\u5904\u7406\u7a0b\u5e8f\u4e0d\u9700\u8981\u91cd\u65b0\u8c03\u6574\u5806\u6808\u6307\u9488\u3002\u5728\u670d\u52a1\u4e2d\u65ad\u7684\u7cfb\u7edf\u4e2d\u4f7f\u7528\u88ab\u4e2d\u65ad\u5bf9\u8c61\u7684\u5806\u6808\uff0c\u5982\u679c\u8fde\u63a5\u5230\u4efb\u4f55\u4f7f\u7528\u975e\u6807\u51c6\u5806\u6808\u5bf9\u9f50\u89c4\u5219\u7684\u4ee3\u7801\uff0c\u4e2d\u65ad\u670d\u52a1\u4f8b\u7a0b\u5fc5\u987b\u91cd\u65b0\u8c03\u6574\u5806\u6808\u6307\u9488\uff0c\u4f46\u5982\u679c\u6240\u6709\u4ee3\u7801\u90fd\u9075\u5faa\u6807\u51c6 ABI \uff0c\u5219\u4e0d\u9700\u8981\u91cd\u65b0\u8c03\u6574\u5806\u6808\u6307\u9488\u3002</li> <li>\u51fd\u6570\u6240\u4f9d\u8d56\u7684\u6570\u636e\u5fc5\u987b\u4f4d\u4e8e\u51fd\u6570\u6808\u5e27\u8303\u56f4\u4e4b\u5185\u3002</li> <li>\u88ab\u8c03\u7528\u51fd\u6570\u5e94\u8be5\u8d1f\u8d23\u4fdd\u8bc1\u5bc4\u5b58\u5668<code>$s0 ~ $s8</code>\u7684\u503c\u5728\u8fd4\u56de\u65f6\u548c\u8c03\u7528\u5165\u53e3\u5904\u4e00\u81f4\u3002</li> </ol> <p>\u4e0a\u9762\u7684\u89c4\u8303\u63cf\u8ff0\u63d0\u5230\u7684\u201c\u5806\u6808\u5bf9\u9f50\u201d\u7684\u6982\u5ff5\u5c31\u662f\u5176\u4e2d\u7684\u7b2c10\u6761\u3002</p> <p>\u4e0a\u9762\u7684\u89c4\u8303\u63cf\u8ff0\u8fd8\u63d0\u5230\u4e86\u201c\u7c7b\u578b\u5bf9\u9f50\u201d\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u6807\u91cfint\u578b\u7684\u7c7b\u578b\u5bf9\u9f50\u610f\u5473\u7740\u5b83\u7684\u8bbf\u5b58\u5730\u5740\u5fc5\u987b\u662f4\u7684\u500d\u6570\u3002\u4e0b\u9762\u662f\u6240\u6709\u6807\u91cf\u7c7b\u578b\u7684\u5bf9\u9f50\u60c5\u51b5\uff1a</p> \u6807\u91cf\u7c7b\u578b \u5927\u5c0f(\u5b57\u8282) \u5bf9\u9f50(\u5b57\u8282) unsinged/signed char 1 1 unsinged/signed short 2 2 unsinged/signed int 4 4 unsinged/signed long 4 4 unsinged/signed long long 8 8 pointer 4 4 float 4 4 double 8 8 long double 16 16"},{"location":"assembly/calling_convention/#_2","title":"\u7cfb\u7edf\u8c03\u7528\u7ea6\u5b9a","text":"<p>\u7cfb\u7edf\u8c03\u7528\u662f\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e3a\u7528\u6237\u6001\u7a0b\u5e8f\u5b9e\u73b0\u7684\u5b50\u7a0b\u5e8f\u3002\u7c7b\u4f3c\u4e8e\u4e00\u822c\u7684\u51fd\u6570\u8c03\u7528\uff0c\u7cfb\u7edf\u8c03\u7528\u4e5f\u9700\u8981\u8fdb\u884c\u53c2\u6570\u4f20\u9012\u3002LA32R\u4e2d\uff0c\u7cfb\u7edf\u8c03\u7528\u7684\u53c2\u6570\u4f20\u9012\u89c4\u5219\u5982\u4e0b\uff1a</p> <ol> <li>\u7cfb\u7edf\u8c03\u7528\u53f7\u5b58\u653e\u5728<code>$a7</code>\u5bc4\u5b58\u5668\u4e2d\u3002</li> <li>\u5bc4\u5b58\u5668<code>$a0 ~ $a6</code>\u7528\u6765\u4f20\u9012\u53c2\u6570\u3002</li> <li>\u8fd4\u56de\u503c\u5b58\u653e\u5728<code>$a0</code>\u3001<code>$a1</code>\u5bc4\u5b58\u5668\u4e2d\u3002</li> <li>\u7cfb\u7edf\u8c03\u7528\u4fdd\u5b58<code>$s0 ~ $s8</code>\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u4e0d\u4fdd\u8bc1\u4fdd\u6301\u53c2\u6570\u5bc4\u5b58\u5668\uff08<code>$a0 ~ $a7</code>\uff09\u548c\u6682\u5b58\u5bc4\u5b58\u5668\uff08<code>$t0 ~ $t8</code>\uff09\u7684\u503c\u3002</li> </ol> <p>\u4e0a\u9762\u63d0\u5230\u7684\u7cfb\u7edf\u8c03\u7528\u53f7\uff0c\u5728Linux/LA32R\u7cfb\u7edf\u4e2d\u7684\u5b9a\u4e49\u53ef\u4ee5\u4ece\u5185\u6838\u6e90\u7801\u7684<code>include/uapi/asm-generic/unistd.h</code>\u6587\u4ef6\u4e2d\u83b7\u5f97\u3002</p>"},{"location":"assembly/common_directives/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/common_directives/#assembler-directives","title":"\u5e38\u7528\u6c47\u7f16\u5668\u6307\u793a\uff08Assembler Directives\uff09","text":""},{"location":"assembly/common_directives/#symbol","title":"\u7b26\u53f7\uff08Symbol\uff09\u5b9a\u4e49\u76f8\u5173\u7684\u6c47\u7f16\u5668\u6307\u793a","text":"<p>\u6709\u4e24\u4e2a\u6982\u5ff5\u95f4\u7684\u5173\u7cfb\u5148\u63d0\u793a\u4e00\u4e0b\uff1a\u6807\u53f7\uff08Label\uff09\u662f\u4e00\u79cd\u7b26\u53f7\uff08Symbol\uff09\u3002</p>"},{"location":"assembly/common_directives/#_1","title":"\u8bbe\u7f6e\u7b26\u53f7\u7c7b\u578b","text":"<p><code>.type SSS, @function</code> \u8868\u793a\u7b26\u53f7SSS\u7684\u7c7b\u578b\u4e3a\u51fd\u6570\u3002</p> <p><code>.type SSS, @object</code> \u8868\u793a\u7b26\u53f7SSS\u7684\u7c7b\u578b\u4e3a\u53d8\u91cf\u3002</p>"},{"location":"assembly/common_directives/#_2","title":"\u8bbe\u7f6e\u7b26\u53f7\u5927\u5c0f","text":"<p><code>.size VVV, 4</code> \u8868\u793a\u53d8\u91cfVVV\u7684\u5927\u5c0f\u4e3a4\u5b57\u8282\u3002</p> <p><code>.size FFF, .-FFF</code> \u8868\u793a\u51fd\u6570FFF\u7684\u5927\u5c0f\u4e3a\u5f53\u524d\u4f4d\u7f6e\u51cf\u53bbFFF\u8d77\u59cb\u4f4d\u7f6e\uff08\u5373\u6807\u53f7FFF\u6240\u5728\u4f4d\u7f6e\uff09\u3002</p>"},{"location":"assembly/common_directives/#_3","title":"\u6307\u5b9a\u7b26\u53f7\u7684\u5730\u5740\u5bf9\u9f50\u65b9\u5f0f","text":"<p>\u7528<code>.align N</code>\u6765\u6307\u793a\u63a5\u4e0b\u6765\u7684\u6570\u636e\u5728\u76ee\u6807\u6587\u4ef6\u4e2d\u7684\u5730\u5740\u5bf9\u9f50\u52302\u7684N\u6b21\u65b9\u3002\u4f8b\u5982\uff0c</p> <pre><code>    .align 4\nmain:\n</code></pre> <p>\u6307\u793a\u5c06main\u51fd\u6570\u7684\u5165\u53e3\u5730\u5740\u5bf9\u9f50\u52302\u76844\u6b21\u65b9\u537316\u5b57\u8282\u3002</p>"},{"location":"assembly/common_directives/#_4","title":"\u6307\u5b9a\u7b26\u53f7\u7684\u4f5c\u7528\u57df","text":"<p>\u5f53\u4e0d\u52a0\u4efb\u4f55\u6307\u5b9a\u7b26\u53f7\u4f5c\u7528\u57df\u7684\u7f16\u8bd1\u63d0\u793a\u65f6\uff0c\u7b26\u53f7\u7684\u4f5c\u7528\u57df\u4ec5\u9650\u5f53\u524d\u6c47\u7f16\u6587\u4ef6\u5185\u3002<code>.globl SSS</code> \u7528\u4e8e\u6307\u5b9a\u7b26\u53f7SSS\u4e3a\u5168\u5c40\u53ef\u89c1\u3002</p>"},{"location":"assembly/common_directives/#_5","title":"\u6307\u5b9a\u6570\u636e\u7c7b\u578b","text":"\u5199\u6cd5 \u7c7b\u578b <code>.byte &lt;value&gt;, &lt;value&gt;, ...</code> \u5b57\u8282\u6574\u6570\uff0c\u53ef\u5b9a\u4e49\u591a\u4e2a\u4e00\u4e2a\u5b57\u8282\u7684\u6570\u636e <code>.word &lt;value&gt;, &lt;value&gt;, ...</code> \u5b57\u6574\u6570\uff0c\u53ef\u5b9a\u4e49\u591a\u4e2a\u4e24\u4e2a\u5b57\u8282\u7684\u6570\u636e <code>.int &lt;value&gt;, &lt;value&gt;, ...</code> \u6574\u6570\uff0c\u53ef\u5b9a\u4e49\u591a\u4e2a\u56db\u4e2a\u5b57\u8282\u7684\u6570\u636e <code>.rept &lt;repeat time&gt;</code><code>&lt;repeat content&gt;</code><code>.endr</code> \u5b9a\u4e49\u91cd\u590d\u7684\u5185\u5bb9\uff0c\u5730\u5740\u8fde\u7eed <code>.ascii \"&lt;string value&gt;\"</code> \u5b57\u7b26\u4e32\uff0c\u5b9a\u4e49\u4ee5\u975e'\\0'\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32 <code>.asciz \"&lt;string value&gt;\"</code><code>.string \"&lt;string value&gt;\"</code> \u5b57\u7b26\u4e32\uff0c\u5b9a\u4e49\u4ee5'\\0'\u7ed3\u5c3e\u7684\u5b57\u7b26\u4e32 <p>\u4ee5\u4e0b3\u79cd\u65b9\u5f0f\u90fd\u80fd\u5b9a\u4e49\"Hello World!\"\u5b57\u7b26\u4e32\uff0c\u5b83\u4eec\u662f\u7b49\u4ef7\u7684\u3002</p> <pre><code>.ascii  \"Hello World!\\0\"\n.asciz  \"Hello World!\"\n.string \"Hello World!\"\n</code></pre>"},{"location":"assembly/common_directives/#_6","title":"\u6307\u5b9a\u7b26\u53f7\u6570\u636e\u5b58\u653e\u6bb5","text":"<p><code>.text</code> \u6307\u5b9a\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u8981\u653e\u5728\u76ee\u6807\u6587\u4ef6\u7684\u4ee3\u7801\u6bb5\u3002<code>.data</code> \u6307\u5b9a\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u8981\u653e\u5728\u76ee\u6807\u6587\u4ef6\u7684\u6570\u636e\u6bb5\u3002<code>.bss</code> \u6307\u5b9a\u63a5\u4e0b\u6765\u7684\u7b26\u53f7\u8981\u653e\u5728\u76ee\u6807\u6587\u4ef6\u7684BSS\u6bb5\u3002<code>.rodata</code> \u6307\u5b9a\u63a5\u4e0b\u6765\u7684\u5185\u5bb9\u8981\u653e\u5728\u76ee\u6807\u6587\u4ef6\u7684\u53ea\u8bfb\u6570\u636e\u6bb5\u3002</p> <p>\u4ee5\u4e0a\u53ea\u662f\u4e00\u4e9b\u5e38\u7528\u7684\u6c47\u7f16\u5668\u63d0\u793a\uff0c\u5982\u679c\u60f3\u4e86\u89e3\u66f4\u591a\uff0c\u53ef\u4ee5\u67e5\u9605\u6c47\u7f16\u5668\u624b\u518c\u7684\u7b2c7\u7ae0\u3002</p>"},{"location":"assembly/pesudo_instrs/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/pesudo_instrs/#la32r_1","title":"LA32R\u6c47\u7f16\u5668\u652f\u6301\u7684\u4f2a\u6307\u4ee4\u6c47\u603b","text":""},{"location":"assembly/pesudo_instrs/#_1","title":"\u8f6c\u79fb\u7c7b","text":"\u4f2a\u6307\u4ee4 \u5bf9\u5e94\u7684\u771f\u5b9e\u6307\u4ee4\uff08\u5e8f\u5217\uff09 \u63cf\u8ff0 jr $rx jirl $r0, rx, 0 \u5c06\u901a\u7528\u5bc4\u5b58\u5668 rx \u4e2d\u7684\u503c\u4f5c\u4e3a\u8df3\u8f6c\u76ee\u6807\u5730\u5740\uff0c\u65e0\u6761\u4ef6\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\u5904\u3002 bgt $rx, $ry, label blt $ry, $rx, label \u5c06\u901a\u7528\u5bc4\u5b58\u5668 rx \u548c\u901a\u7528\u5bc4\u5b58\u5668 ry \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u524d\u8005\u5927\u4e8e\u540e\u8005\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 bgtu $rx, $ry, label bltu $ry, $rx, label \u5c06\u901a\u7528\u5bc4\u5b58\u5668 rx \u548c\u901a\u7528\u5bc4\u5b58\u5668 ry \u7684\u503c\u89c6\u4f5c\u65e0\u7b26\u53f7\u6570\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u524d\u8005\u5927\u4e8e\u540e\u8005\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 ble $rx, $ry, label bge $ry, $rx, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u548c\u901a\u7528\u5bc4\u5b58\u5668 ry \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u524d\u8005\u5c0f\u4e8e\u7b49\u4e8e\u540e\u8005\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 bleu $rx, $ry, label bgeu $ry, $rx, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u548c\u901a\u7528\u5bc4\u5b58\u5668 ry \u7684\u503c\u89c6\u4f5c\u65e0\u7b26\u53f7\u6570\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679c\u524d\u8005\u5c0f\u4e8e\u7b49\u4e8e\u540e\u8005\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 bltz $rx, label blt $rx, $r0, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u4e0e0\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679crx\u5c0f\u4e8e0\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 bgtz $rx, label blt $r0, $rx, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u4e0e0\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679crx\u5927\u4e8e0\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 blez $rx, label bge $r0, $rx, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u4e0e0\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679crx\u5c0f\u4e8e\u7b49\u4e8e0\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002 bgez $rx, label bge $rx, $r0, label \u901a\u7528\u5bc4\u5b58\u5668 rx \u7684\u503c\u89c6\u4f5c\u6709\u7b26\u53f7\u6570\u4e0e0\u8fdb\u884c\u6bd4\u8f83\uff0c\u5982\u679crx\u5927\u4e8e\u7b49\u4e8e0\u5219\u8df3\u8f6c\u5230\u76ee\u6807\u5730\u5740\uff0c\u5426\u5219\u4e0d\u8df3\u8f6c\u3002"},{"location":"assembly/pesudo_instrs/#_2","title":"\u8fd0\u7b97\u7c7b","text":"\u4f2a\u6307\u4ee4 \u5bf9\u5e94\u7684\u771f\u5b9e\u6307\u4ee4\uff08\u5e8f\u5217\uff09 \u63cf\u8ff0 li.w $rx, imm \u89c6imm\u53d6\u503c\u8303\u56f4\u4ea7\u751f\u76f8\u5e94\u7684\u6307\u4ee4\uff08\u5e8f\u5217\uff09 \u5c06\u7acb\u5373\u6570imm\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 move $rx, $ry or $rx, $ry, $r0 \u5c06\u901a\u7528\u5bc4\u5b58\u5668ry\u7684\u503c\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 nop addi $r0, $r0, 0 \u7a7a\u6307\u4ee4"},{"location":"assembly/pesudo_instrs/#_3","title":"\u52a0\u8f7d\u5730\u5740","text":"\u4f2a\u6307\u4ee4 \u5bf9\u5e94\u7684\u771f\u5b9e\u6307\u4ee4\uff08\u5e8f\u5217\uff09 \u63cf\u8ff0 la $rx, label(+addend) \u4e0ela.global $rx, label(+addend)\u4e00\u81f4 \u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.local $rx, label(+addend) lu12i.w $rx, abs(l_a)&gt;&gt;12;  ori $rx, $rx, abs(l_a)&amp;0xfff \u5176\u4e2dl_a\u8868\u793alabel(+addend)\uff0cabs\u8868\u793a\u7edd\u5bf9\u5730\u5740\uff0c\u4e0b\u540c\uff1b\u9002\u7528\u4e8e\u4f7f\u7528\u7f16\u8bd1\u9009\u9879-Wa, -mla-local-with-abs\u7684\u60c5\u51b5\uff0c\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.local $rx, label(+addend) pcaddu12i $rx, pcrel(l_a+0x800)&lt;&lt;32&gt;&gt;44;  addi.w $rx, $rx, pcrel(l_a+4)-(pcrel(l_a+4+0x800)&gt;&gt;12&lt;&lt;12); \u5176\u4e2dpcrel\u8868\u793a\u4e0ePC\u5730\u5740\u7684\u76f8\u5bf9\u504f\u79fb\uff0c\u4e0b\u540c\uff1b\u9002\u7528\u4e8e\u4e0d\u989d\u5916\u4f7f\u7528\u7f16\u8bd1\u9009\u9879\u7684\u60c5\u51b5\uff0c\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.global $rx, label(+addend) pcaddu12i $rx, pcrel(l_a+0x800)&lt;&lt;32&gt;&gt;44;  addi.w $rx, $rx, pcrel(l_a+4)-(pcrel(l_a+4+0x800)&gt;&gt;12&lt;&lt;12); \u9002\u7528\u4e8e\u4f7f\u7528\u7f16\u8bd1\u9009\u9879-Wa, -mla-global-with-pcrel\u7684\u60c5\u51b5\uff0c\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.global $rx, label(+addend) lu12i.w $rx, abs(l_a)&gt;&gt;12;  ori $rx, $rx, abs(l_a)&amp;0xfff; \u9002\u7528\u4e8e\u4f7f\u7528\u7f16\u8bd1\u9009\u9879-Wa, -mla-global-with-abs\u7684\u60c5\u51b5\uff0c\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.got $rx, label pcaddu12i $rx, (pcrel(_GOT_+0x800)+gprel(label))&lt;&lt;32&gt;&gt;44;  ld.w $rx, $rx, pcrel(_GOT_+4)+gprel(label)-((pcrel(_GOT_+4+0x800)+gprel(label))&gt;&gt;12&lt;&lt;12); \u5176\u4e2d_GOT_\u8868\u793a\u7b26\u53f7_GLOBAL_OFFSET_TABLE_\uff0c\u4ee3\u8868GOT\u57fa\u5740; gprel\u8868\u793a\u76f8\u5bf9GOT\u504f\u79fb\uff0c\u4e0b\u540c\uff1b\u501f\u52a9GOT\u5c06label\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.pcrel $rx, label(+addend) pcaddu12i $rx, pcrel(l_a+0x800)&lt;&lt;32&gt;&gt;44;  addi.w $rx, $rx, pcrel(l_a+4)-(pcrel(l_a+4+0x800)&gt;&gt;12&lt;&lt;12); \u501f\u52a9PC\u76f8\u5bf9\u504f\u79fb\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.abs $rx, label(+addend) lu12i.w $rx, abs(l_a)&gt;&gt;12;  ori $rx, $rx, abs(l_a)&amp;0xfff; \u501f\u52a9\u7edd\u5bf9\u5730\u5740\u5c06label(+addend)\u7684\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.tls.le $rx, label(+addend) lu12i.w $rx, tprel(l_a)&gt;&gt;12;  ori $rx, $rx, tprel(l_a)&amp;0xfff \u5b58\u50a8(TLS)\u901a\u8fc7tp\u504f\u79fb\u5c06label\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.tls.ie $rx, label pcaddu12i $rx, (pcrel(_GOT_+0x800)+tlsgot(label))&lt;&lt;32&gt;&gt;44;  ld.w $rx, $rx, pcrel(_GOT_+4)+tlsgot(label)-((pcrel(_GOT_+4+0x800)+tlsgot(label))&gt;&gt;12&lt;&lt;12); \u5b58\u50a8(TLS)\u901a\u8fc7tlsgot\u8868\u673a\u5236\u5c06label\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.tls.ld $rx, label pcaddu12i $rx, (pcrel(_GOT_+0x800)+tlsgd(label))&lt;&lt;32&gt;&gt;44;  addi.w $rx, $rx, pcrel(_GOT_+4)+tlsgd(label)-((pcrel(_GOT_+4+0x800)+tlsgd(label))&gt;&gt;12&lt;&lt;12); \u5b58\u50a8(TLS)\u901a\u8fc7tlsld\u673a\u5236(\u76ee\u524d\u4f7f\u7528\u7684\u662ftlsgd)\u5c06label\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002 la.tls.gd $rx, label pcaddu12i $rx, (pcrel(_GOT_+0x800)+tlsgd(label))&lt;&lt;32&gt;&gt;44;  addi.w $rx, $rx, pcrel(_GOT_+4)+tlsgd(label)-((pcrel(_GOT_+4+0x800)+tlsgd(label))&gt;&gt;12&lt;&lt;12); \u5b58\u50a8(TLS)\u901a\u8fc7tlsgd\u673a\u5236\u5c06label\u5730\u5740\u5199\u5165\u901a\u7528\u5bc4\u5b58\u5668rx\u4e2d\u3002"},{"location":"assembly/register_convention/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/register_convention/#_1","title":"\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a","text":"<p>LA32R\u6700\u5e38\u7528\u7684ILP32 ABI\uff0c\u5176\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\u4e0eLA64\u6240\u7528\u7684LP64 ABI\u662f\u4e00\u81f4\u7684\uff0c\u5177\u4f53\u5982\u4e0b\u6240\u793a\uff1a</p> \u5bc4\u5b58\u5668\u53f7 ABI\u522b\u540d \u7528\u9014 \u8c03\u7528\u8005\u4fdd\u5b58 \u88ab\u8c03\u7528\u8005\u4fdd\u5b58 $r0 $zero \u5e38\u503c\u96f6 $r1 $ra \u51fd\u6570\u8fd4\u56de\u5730\u5740 \u00d7 $r2 $tp \u6307\u5411\u7ebf\u7a0b\u79c1\u6709\u5b58\u50a8\u533a(TLS)\u7684\u6307\u9488 $r3 $sp \u6808\u6307\u9488 \u00d7 $r4 - $r11 $a0 - $a7 \u51fd\u6570\u4f20\u5165\u7684\u53c2\u6570 \u00d7 $r4 - $r5 $v0 - $v1 \u51fd\u6570\u8fd4\u56de\u503c \u00d7 $r12 - $r20 $t0 - $t8 \u6682\u5b58\u5bc4\u5b58\u5668 \u00d7 $r21 - Reserved $r22 $fp \u6808\u5e27\u6307\u9488 \u00d7 $r23 - $r31 $s0 - $s8 \u4fdd\u5b58\u7684\u5bc4\u5b58\u5668 \u00d7 <p>\u4e0a\u8868\u4e2d\u8c03\u7528\u8005\u4fdd\u5b58\u8fd8\u662f\u88ab\u8c03\u7528\u4fdd\u5b58\uff0c\u662f\u914d\u5408\u7740\u8c03\u7528\u51fd\u6570\u540e\u54ea\u4e9b\u5bc4\u5b58\u5668\u503c\u4fdd\u6301\u4e0d\u53d8\u7684\u7ea6\u5b9a\u800c\u6765\u7684\u3002</p> <p>\u4ee5<code>$s0 ~ $s8</code>\u8fd9\u4e9b\u5bc4\u5b58\u5668\u4e3a\u4f8b\uff0c\u5f53\u53d1\u751f\u51fd\u6570\u8c03\u7528\u65f6\uff0c\u5982\u679c\u88ab\u8c03\u7528\u8005\u9700\u8981\u4fee\u6539\u5176\u4e2d\u67d0\u4e9b\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u90a3\u4e48\u88ab\u8c03\u7528\u8005\u5728\u4fee\u6539\u524d\u9700\u8981\u5c06\u76f8\u5173\u5bc4\u5b58\u5668\u65e7\u503c\u5b58\u653e\u5728\u81ea\u5df1\u7684\u6808\u5e27\u4e0a\uff0c\u7b49\u5230\u8fd4\u56de\u524d\u518d\u4ece\u6808\u4e2d\u6062\u590d\u51fa\u6765\u3002\u8fd9\u6837\u4ece\u8c03\u7528\u8005\u7684\u89c6\u89d2\u6765\u770b\uff0c<code>$s0 ~ $s8</code>\u8fd9\u4e9b\u5bc4\u5b58\u5668\u5728\u51fd\u6570\u8c03\u7528\u8fc7\u7a0b\u4e2d\u503c\u662f\u4fdd\u6301\u4e0d\u53d8\u7684\u3002</p> <p>\u4e0e\u4e4b\u76f8\u53cd\u7684\uff0c\u5982<code>$t0 ~ $t8</code>\u8fd9\u4e9b\u5bc4\u5b58\u5668\uff0c\u5e76\u672a\u5f3a\u5236\u8981\u6c42\u88ab\u8c03\u7528\u8005\u4fdd\u5b58\u5b83\u4eec\uff0c\u90a3\u5c31\u610f\u5473\u7740\uff0c\u5982\u679c\u8c03\u7528\u8005\u5e0c\u671b\u5728\u8c03\u7528\u6267\u884c\u51fd\u6570\u524d\u540e\u5b83\u4eec\u7684\u503c\u4fdd\u6301\u4e0d\u53d8\uff0c\u5219\u9700\u8981\u8c03\u7528\u8005\u81ea\u5df1\u5728\u8c03\u7528\u6267\u884c\u5176\u5b83\u51fd\u6570\u524d\uff0c\u5c06<code>$t0 ~ $t8</code>\u8fd9\u4e9b\u5bc4\u5b58\u5668\u4e2d\u9700\u8981\u4fdd\u6301\u4e0d\u53d8\u7684\u503c\u5b58\u653e\u5230\u8c03\u7528\u8005\u81ea\u5df1\u7684\u6808\u5e27\u4e0a\uff0c\u7b49\u5230\u51fd\u6570\u8c03\u7528\u6267\u884c\u7ed3\u675f\u8fd4\u56de\u540e\uff0c\u518d\u4ece\u8c03\u7528\u8005\u81ea\u5df1\u7684\u6808\u5e27\u4e0a\u6062\u590d\u51fa\u6765\u3002<code>$a0 ~ $a7</code>\u4ee5\u53ca<code>$ra</code>\u4e0e\u4e4b\u540c\u7406\u3002</p>"},{"location":"assembly/stack_frame/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/stack_frame/#_1","title":"\u6808\u5e27\u5e03\u5c40","text":"<p>\u901a\u8fc7\u524d\u4e00\u8282\u7684\u4ecb\u7ecd\uff0c\u6211\u4eec\u4e86\u89e3\u5230\u8fdb\u7a0b\u6267\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u5728\u5185\u5b58\u4e2d\u4e3a\u5176\u5206\u914d\u6808\u7a7a\u95f4\u3002\u6808\u662f\u6211\u4eec\u6700\u5e38\u7528\u5230\u7684\u5b58\u653e\u53ef\u8bfb\u5199\u4e34\u65f6\u6570\u636e\u7684\u533a\u57df\u3002\u901a\u5e38\u6211\u4eec\u4f1a\u4f7f\u7528\u6808\u6765\u7ba1\u7406\u51fd\u6570\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u8fd4\u56de\u5730\u5740\u3001\u53c2\u6570\u548c\u5c40\u90e8\u53d8\u91cf\u7b49\u4fe1\u606f\u3002\u6808\u7684\u5927\u5c0f\u5728\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u662f\u4e0d\u65ad\u52a8\u6001\u8c03\u6574\u7684\u3002</p> <p>LA32R\u67b6\u6784\u4e0b\u51fd\u6570\u6808\u5b9e\u73b0\u4e3a\u6ee1\u9012\u51cf\u6808\uff08Full Descending Stack\uff09\u7c7b\u578b\u3002\u8fd9\u91cc\u201c\u9012\u51cf\u201d\u6307\u7684\u662f\u6808\u5411\u7740\u5730\u5740\u51cf\u5c0f\u7684\u65b9\u5411\u589e\u957f\u3002\u201c\u6ee1\u201d\u662f\u6307\u6808\u9876\u6307\u9488\uff08<code>$sp</code>\uff09\u603b\u662f\u6307\u5411\u6700\u540e\u4e00\u4e2a\u538b\u5165\u6808\u7684\u5143\u7d20\u3002</p> <p>\u6808\u88ab\u7ec4\u7ec7\u6210\u4e00\u4e2a\u4e2a\u6808\u5e27\uff08Stack Frame\uff09\u3002\u6bcf\u4e2a\u6808\u5e27\u662f\u6808\u4e0a\u4e00\u6bb5\u5730\u5740\u8fde\u7eed\u7684\u7a7a\u95f4\uff0c\u5bf9\u5e94\u7740\u4e00\u4e2a\u5904\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u51fd\u6570\u3002</p> LA32R\u6808\u5e27\u5e03\u5c40 <p>\u4e0a\u56fe\u4e2d\u6211\u4eec\u7ed9\u51fa\u4e86\u4e00\u4e2a\u6808\u5e27\u5e03\u5c40\u7684\u793a\u610f\u3002\u5176\u4e2d\u4ece\u9ad8\u5730\u5740\u5411\u4e0b\uff0c\u4f9d\u6b21\u662f\u8c03\u7528\u5f53\u524d\u51fd\u6570\u7684\u8c03\u7528\u8005\u6808\u5e27\u3001\u5f53\u524d\u51fd\u6570\u7684\u6808\u5e27\uff0c\u5982\u679c\u6b64\u65f6\u5f53\u524d\u51fd\u6570\u518d\u8c03\u7528\u5176\u5b83\u51fd\u6570\uff0c\u5219\u88ab\u8c03\u7528\u51fd\u6570\u7684\u6808\u5e27\u7d27\u9760\u5728\u5f53\u524d\u6808\u5e27\u5411\u4e0b\u5e03\u5c40\u3002\u6bcf\u4e2a\u51fd\u6570\u7684\u6808\u5e27\u4e2d\u4ece\u9ad8\u5730\u5740\u5411\u4e0b\u901a\u5e38\u5927\u81f4\u5212\u5206\u4e3a\u4e09\u4e2a\u533a\u57df\uff0c\u9996\u5148\u662f\u5b58\u653e\u5f53\u524d\u51fd\u6570\u7684\u5c40\u90e8\u53d8\u91cf\u4ee5\u53caCaller Save\u5bc4\u5b58\u5668\u7684\u503c\uff0c\u63a5\u4e0b\u6765\u662f\u52a8\u6001\u6808\u7a7a\u95f4\uff08\u5982\u679c\u5f53\u524d\u51fd\u6570\u4f7f\u7528\u5e76\u5206\u914d\u4e86\u52a8\u6001\u6808\u7a7a\u95f4\u7684\u8bdd\uff09\uff0c\u518d\u5f80\u4e0b\u9760\u8fd1\u88ab\u8c03\u7528\u51fd\u6570\u6808\u5e27\u7684\u533a\u57df\u662f\u7528\u6765\u5b58\u653e\u90a3\u4e9b\u65e0\u6cd5\u901a\u8fc7\u5bc4\u5b58\u5668\u4f20\u9012\u7684\u5b50\u51fd\u6570\u53c2\u6570\u503c\u7684\u3002\u7ed3\u5408\u7740\u4e0a\u8ff0\u6808\u5e27\u5e03\u5c40\u7684\u793a\u610f\uff0c\u8bfb\u8005\u5e94\u8be5\u66f4\u76f4\u89c2\u7684\u4f53\u4f1a\uff1a\u524d\u9762\u8bb2\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\u65f6\u7684Caller Save\u548cCallee Save\u5bc4\u5b58\u5668\u5206\u522b\u5b58\u5728\u54ea\u4e2a\u51fd\u6570\u5bf9\u5e94\u7684\u6808\u5e27\uff0c\u4ee5\u53ca\u524d\u9762\u8bb2\u5230\u51fd\u6570\u8c03\u7528\u7ea6\u5b9a\u65f6\u7528\u6808\u4f20\u53c2\u65f6\u53c2\u6570\u662f\u5b58\u653e\u5728\u54ea\u4e2a\u51fd\u6570\u7684\u6808\u5e27\u4e0a\u3002</p> <p>\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u51fd\u6570\u53ea\u9700\u8981\u7528<code>$sp</code>\u6765\u7ba1\u7406\u6808\u5e27\u3002\u5982\u679c\u5728\u7f16\u8bd1\u65f6\u80fd\u591f\u786e\u5b9a\u6808\u5e27\u7684\u5927\u5c0f\uff0c\u90a3\u4e48\u5728\u8fdb\u5165\u4e00\u4e2a\u51fd\u6570\u65f6\uff0c\u53ef\u4ee5\u4e00\u6b21\u6027\u5206\u914d\u6240\u9700\u7684\u6808\u7a7a\u95f4\uff08\u4e00\u6b21\u6027\u610f\u5473\u7740\u540e\u9762\u64cd\u4f5c\u5f53\u524d\u6808\u5e27\u8fc7\u7a0b\u4e2d<code>$sp</code>\u7684\u503c\u4e0d\u518d\u53d8\u5316\uff09\uff0c\u540c\u65f6\u6808\u5e27\u4e2d\u7684\u5185\u5bb9\u76f8\u5bf9\u4e8e<code>$sp</code>\u7684\u504f\u79fb\u4e5f\u662f\u5bb9\u6613\u8ba1\u7b97\u7684\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u4e00\u4e2a\u51fd\u6570\u7684\u6808\u5e27\u5728\u7f16\u8bd1\u671f\u65e0\u6cd5\u786e\u5b9a\u5927\u5c0f\uff0c\u4f8b\u5982C\u8bed\u8a00\u4e2d\u4f7f\u7528alloca()\u8c03\u7528\u5206\u914d\u52a8\u6001\u6808\u7a7a\u95f4\uff0c\u4f1a\u4f7f\u5f97\u5728\u64cd\u4f5c\u5f53\u524d\u6808\u5e27\u7684\u8fc7\u7a0b\u4e2d<code>$sp</code>\u7684\u503c\u53d1\u751f\u53d8\u5316\uff0c\u8fd9\u5c31\u4f1a\u5bfc\u81f4\u6808\u5e27\u4e2d\u7684\u5185\u5bb9\u76f8\u5bf9\u4e8e<code>$sp</code>\u7684\u504f\u79fb\u503c\u8ba1\u7b97\u8d77\u6765\u53d8\u5f97\u9ebb\u70e6\u3002\u4e8e\u662f\u5f15\u5165\u4e86\u6808\u5e27\u6307\u9488\uff08Frame Pointer\uff09\u3002\u5b83\u603b\u662f\u6307\u5411\u5f53\u524d\u6d3b\u8dc3\u6808\u5e27\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u800c\u5728\u64cd\u4f5c\u5f53\u524d\u6808\u5e27\u8fc7\u7a0b\u4e2d\u8fd9\u4e2a\u4f4d\u7f6e\u603b\u662f\u56fa\u5b9a\u4e0d\u53d8\uff0c\u56e0\u6b64\u5728\u6808\u5e27\u6307\u9488\u7684\u534f\u52a9\u4e0b\uff0c\u80fd\u591f\u65b9\u4fbf\u7ef4\u62a4\u6808\u5e27\u4e2d\u5185\u5bb9\u4f4d\u7f6e\u7684\u8ba1\u7b97\u3002\u6700\u5e38\u89c1\u5730\uff0c\u5728\u91ca\u653e\u5f53\u524d\u6808\u5e27\u65f6\uff0c<code>$sp</code>\u4e0d\u7528\u518d\u91cd\u65b0\u8ba1\u7b97\u5b83\u5e94\u8be5\u5411\u4e0a\u79fb\u52a8\u591a\u5c11\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5229\u7528<code>$fp</code>\u4e2d\u7684\u503c\u6765\u5feb\u901f\u6062\u590d\u3002</p> <p>\u4e0b\u9762\u6765\u770b\u51e0\u4e2a\u4f8b\u5b50\uff0c\u6765\u5e2e\u52a9\u8bfb\u8005\u5efa\u7acb\u8d77\u76f4\u89c2\u7684\u8ba4\u8bc6\u3002</p> <pre><code>extern int foo(int a, int b, int c, int d, int e, int f, int g, int h, int i, int j); int normal(void) {\nreturn foo(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);\n}\n</code></pre> <p>\u4e0a\u8ff0C\u7a0b\u5e8f\u5982\u679c\u7528gcc -O2 -S\u6765\u7f16\u8bd1\uff0c\u5219\u751f\u6210\u5982\u4e0b\u7684\u6c47\u7f16\u4ee3\u7801\uff08\u4e3a\u65b9\u4fbf\u9605\u8bfb\uff0c\u5df2\u5c06\u5f62\u5982$r##\u7684\u5bc4\u5b58\u5668\u540d\u66ff\u6362\u4e3a\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\u4e2d\u7684ABI\u522b\u540d\uff09\u3002\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u53ea\u901a\u8fc7sp\u6765\u786e\u5b9a\u5404\u5185\u5bb9\u5728\u6808\u4e2d\u7684\u4f4d\u7f6e\u3002</p> <pre><code>normal:\naddi.w      $sp, $sp, -32       #\u5206\u914d\u6808\u5e27\naddi.w      $t0, $zero, 10      #\u7b2c10\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 4         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c10\u4e2a\u53c2\u6570\naddi.w      $t0, $zero, 9       #\u7b2c9\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 0         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c9\u4e2a\u53c2\u6570\naddi.w      $a7, $zero, 8       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c8\u4e2a\u53c2\u6570\naddi.w      $a6, $zero, 7       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c7\u4e2a\u53c2\u6570\naddi.w      $a5, $zero, 6       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c6\u4e2a\u53c2\u6570\naddi.w      $a4, $zero, 5       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c5\u4e2a\u53c2\u6570\naddi.w      $a3, $zero, 4       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c4\u4e2a\u53c2\u6570\naddi.w      $a2, $zero, 3       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c3\u4e2a\u53c2\u6570\naddi.w      $a1, $zero, 2       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c2\u4e2a\u53c2\u6570\naddi.w      $a0, $zero, 1       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c1\u4e2a\u53c2\u6570\nst.w        $ra, $sp, 28        #\u5728\u6808\u4e2d\u4fdd\u5b58ra\nbl          %plt(foo)           #\u8c03\u7528foo\u51fd\u6570\nld.w        $ra, $sp, 28        #\u4ece\u6808\u4e2d\u6062\u590dra\naddi.w      $sp, $sp, 32        #\u91ca\u653e\u6808\u5e27\njr          $ra                 #\u51fd\u6570\u8fd4\u56de\n</code></pre> <p>\u5982\u679c\u524d\u8ff0C\u7a0b\u5e8f\u7528gcc -O2 -fno-omit-frame-pointer\u6765\u7f16\u8bd1\uff0c\u4f7f\u5176\u5f3a\u884c\u4f7f\u7528\u6808\u5e27\u6307\u9488\uff0c\u5219\u751f\u6210\u5982\u4e0b\u7684\u4ee3\u7801\u3002\u53ef\u4ee5\u770b\u5230\u51fd\u6570\u4e00\u5f00\u59cb\u4f1a\u5c06<code>$fp</code>\u7684\u65e7\u503c\u538b\u5165\u6808\u4e2d\uff0c\u7136\u540e\u5c06\u5176\u6307\u5411\u5f53\u524d\u6808\u5e27\u7684\u8d77\u59cb\u4f4d\u7f6e\u5904\u3002</p> <pre><code>normal:\naddi.w      $sp, $sp, -32       #\u5206\u914d\u6808\u5e27\nst.w        $fp, $sp, 24        #\u5728\u6808\u4e2d\u4fdd\u5b58fp\nst.w        $ra, $sp, 28        #\u5728\u6808\u4e2d\u4fdd\u5b58ra\naddi.w      $fp, $sp, 32        #fp\u6307\u5411\u6808\u5e27\u8d77\u59cb\u4f4d\u7f6e\naddi.w      $t0, $zero, 10      #\u7b2c10\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 4         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c10\u4e2a\u53c2\u6570\naddi.w      $t0, $zero, 9       #\u7b2c9\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 0         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c9\u4e2a\u53c2\u6570\naddi.w      $a7, $zero, 8       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c8\u4e2a\u53c2\u6570\naddi.w      $a6, $zero, 7       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c7\u4e2a\u53c2\u6570\naddi.w      $a5, $zero, 6       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c6\u4e2a\u53c2\u6570\naddi.w      $a4, $zero, 5       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c5\u4e2a\u53c2\u6570\naddi.w      $a3, $zero, 4       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c4\u4e2a\u53c2\u6570\naddi.w      $a2, $zero, 3       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c3\u4e2a\u53c2\u6570\naddi.w      $a1, $zero, 2       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c2\u4e2a\u53c2\u6570\naddi.w      $a0, $zero, 1       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c1\u4e2a\u53c2\u6570\nbl          %plt(foo)           #\u8c03\u7528foo\u51fd\u6570\nld.w        $ra, $sp, 28        #\u4ece\u6808\u4e2d\u6062\u590dra\nld.w        $fp, $sp, 24        #\u4ece\u6808\u4e2d\u6062\u590dfp\naddi.w      $sp, $sp, 32        #\u91ca\u653e\u6808\u5e27\njr          $ra                 #\u51fd\u6570\u8fd4\u56de\n</code></pre> <p>\u6211\u4eec\u770b\u5230\u4e0a\u9762\u7684\u6c47\u7f16\u4e2d<code>$fp</code>\u5e76\u6ca1\u6709\u7528\u6765\u505a\u4ec0\u4e48\u4e8b\u60c5\uff0c\u7ef4\u62a4\u5b83\u7684\u4ee3\u7801\u662f\u5197\u4f59\u7684\uff0c\u4e0b\u9762\u6211\u4eec\u6240\u8981\u770b\u770b\u4f8b\u5b50\u4e2d\u5c06\u5b9e\u9645\u7528\u5230<code>$fp</code>\u3002</p> <pre><code>#include &lt;alloca.h&gt;\nextern int foo(int a, int b, int c, int d, int e,\nint f, int g, int h, int i, int j);\nint dynamic(unsigned int size) {\nint *p = alloca(size);\np[0] = 0x123;\nreturn foo((int)p, p[0], 3, 4, 5, 6, 7, 8, 9, 10);\n}\n</code></pre> <pre><code>dynamic:\naddi.w      $a0, $a0, 15        #size\u5411\u4e0a\u5bf9\u9f50\u523016\u6574\u500d\u6570\uff0c\u6b65\u9aa41/3\naddi.w      $sp, $sp, -32       #\u5206\u914d\u6808\u5e27\u4e2d\u56fa\u5b9a\u5927\u5c0f\u7684\u90e8\u5206\nsrli.w      $a0, $a0, 4         #size\u5411\u4e0a\u5bf9\u9f50\u523016\u6574\u500d\u6570\uff0c\u6b65\u9aa42/3\nst.w        $fp, $sp, 24        #\u5728\u6808\u4e2d\u4fdd\u5b58fp\nst.w        $ra, $sp, 28        #\u5728\u6808\u4e2d\u4fdd\u5b58ra\naddi.w      $fp, $sp, 32        #fp\u6307\u5411\u6808\u5e27\u8d77\u59cb\u4f4d\u7f6e\nslli.w      $a0, $a0, 4         #size\u5411\u4e0a\u5bf9\u9f50\u523016\u6574\u500d\u6570\uff0c\u6b65\u9aa43/3\nsub.w       $sp, $sp, $a0       #\u5728\u6808\u4e0a\u5206\u914dalloca\u7533\u8bf7\u7684\u7a7a\u95f4\naddi.w      $a0, $sp, 16        #p\u6570\u7ec4\u7684\u8d77\u59cb\u5730\u5740\uff0c\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c1\u4e2a\u53c2\u6570\naddi.w      $t0, $a0, 291       #0x123\nst.w        $t0, $a0, 0         #\u5411p[0]\u5b58\u51650x123\naddi.w      $t0, $zero, 10      #\u7b2c10\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 4         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c10\u4e2a\u53c2\u6570\naddi.w      $t0, $zero, 9       #\u7b2c9\u4e2a\u53c2\u6570\u7684\u503c\nst.w        $t0, $sp, 0         #\u901a\u8fc7\u6808\u5411foo\u4f20\u7b2c9\u4e2a\u53c2\u6570\naddi.w      $a7, $zero, 8       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c8\u4e2a\u53c2\u6570\naddi.w      $a6, $zero, 7       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c7\u4e2a\u53c2\u6570\naddi.w      $a5, $zero, 6       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c6\u4e2a\u53c2\u6570\naddi.w      $a4, $zero, 5       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c5\u4e2a\u53c2\u6570\naddi.w      $a3, $zero, 4       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c4\u4e2a\u53c2\u6570\naddi.w      $a2, $zero, 3       #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c3\u4e2a\u53c2\u6570\naddi.w      $a1, $zero, 291     #\u901a\u8fc7\u5bc4\u5b58\u5668\u5411foo\u4f20\u7b2c2\u4e2a\u53c2\u6570\nbl          %plt(foo)           #\u8c03\u7528foo\u51fd\u6570\naddi.w      $sp, $fp, -32       #\u91ca\u653e\u6389\u5f53\u524d\u6808\u5e27\u901a\u8fc7alloca\u52a8\u6001\u5206\u914d\u7684\u90e8\u5206\nld.w        $ra, $sp, 28        #\u4ece\u6808\u4e2d\u6062\u590dra\nld.w        $fp, $sp, 24        #\u4ece\u6808\u4e2d\u6062\u590dfp\naddi.w      $sp, $sp, 32        #\u91ca\u653e\u6389\u5f53\u524d\u6808\u5e27\u4f59\u4e0b\u7684\u56fa\u5b9a\u5927\u5c0f\u7684\u90e8\u5206\njr          $ra                 #\u51fd\u6570\u8fd4\u56de\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u4e2dsize\u8981\u5411\u4e0a\u5bf9\u9f50\u523016\u6574\u500d\u6570\u7684\u539f\u56e0\u662fLA32R\u7684ABI\u8981\u6c42\u6808\u5e2716\u5b57\u8282\u5bf9\u9f50\u3002</p>"},{"location":"assembly/workenv/","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u7b80\u4ecb","text":""},{"location":"assembly/workenv/#la32r_1","title":"LA32R\u6c47\u7f16\u7f16\u7a0b\u5b66\u4e60\u73af\u5883\u4ecb\u7ecd","text":""},{"location":"assembly/workenv/#_1","title":"\u4ea4\u53c9\u5de5\u5177\u94fe","text":"<p>\u5728\u8fdb\u884c\u57fa\u4e8eLA32R\u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u64cd\u4f5c\u7cfb\u7edf\u5f00\u53d1\u65f6\uff0c\u7531\u4e8e\u6211\u4eec\u624b\u8fb9\u7f3a\u5c11\u771f\u5b9e\u7684\u4ee5LA32R\u4e3a\u67b6\u6784\u7684CPU\uff0c\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u4ea4\u53c9\u5de5\u5177\u94fe\u8fdb\u884c\u4ee3\u7801\u7684\u7f16\u8bd1\u4e0e\u7a0b\u5e8f\u7684\u6a21\u62df\u8fd0\u884c\u3002</p> <p>\u5728\u4ea4\u53c9\u5f00\u53d1\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5e94\u533a\u5206\u5bbf\u4e3b\u673a\u548c\u76ee\u6807\u673a\u3002\u76ee\u6807\u673a\u7684\u6307\u4ee4\u96c6\u67b6\u6784\u662f\u671f\u671b\u8fd0\u884c\u7684\u67b6\u6784\uff0c\u4e5f\u5c31\u662f\u672c\u624b\u518c\u7684LA32R\u67b6\u6784\uff1b\u5bbf\u4e3b\u673a\u662f\u6267\u884c\u7f16\u8bd1\u3001\u63d0\u4f9b\u6a21\u62df\u8fd0\u884c\u73af\u5883\u7684\u673a\u5668\uff0c\u5982\u6211\u4eec\u5e38\u7528\u7684x86\u67b6\u6784\u673a\u5668\u3002\u4ea4\u53c9\u7f16\u8bd1\u8981\u5b9e\u73b0\u7684\u76ee\u6807\u662f\u5728\u5bbf\u4e3b\u673a\u4e0a\u751f\u6210\u76ee\u6807\u673a\u67b6\u6784\u7684\u4ee3\u7801\uff0c\u6a21\u62df\u8fd0\u884c\u5b9e\u73b0\u7684\u76ee\u6807\u662f\u5728\u5bbf\u4e3b\u673a\u4e0a\u8fd0\u884c\u76ee\u6807\u673a\u67b6\u6784\u7684\u7a0b\u5e8f\u3002</p> <p>\u4e0b\u8868\u4e2d\u7684\u5de5\u5177\u4e3aLA32R\u6c47\u7f16\u7f16\u7a0b\u73af\u5883\u6240\u9700\u7684\u5de5\u5177\u4e0e\u8f6f\u4ef6\u73af\u5883\uff0c\u8bf7\u9009\u62e9\u5bf9\u5e94\u7248\u672c\u4e0b\u8f7d\u597d\uff0c\u4e0b\u4e00\u5c0f\u8282\u5c06\u4ecb\u7ecd\u5b83\u4eec\u7684\u4f7f\u7528\u65b9\u6cd5\u3002</p> \u5de5\u5177 \u7528\u9014 \u4e0b\u8f7d\u5730\u5740 loongarch32r-linux-gnusf-{gcc/objdump/gdb/...} \u4ea4\u53c9\u7f16\u8bd1\u5668\u3001\u53cd\u6c47\u7f16\u5668\u3001\u8c03\u8bd5\u5668\u2026\u2026 \u5de5\u5177\u53d1\u884c\u7248\u5730\u5740 la32r-QEMU LA32R\u6a21\u62df\u5668 \u6e90\u7801\u4ed3\u5e93\u5730\u5740 la32r-Linux LA32R\u5185\u6838 \u6e90\u7801\u4ed3\u5e93\u5730\u5740"},{"location":"assembly/workenv/#_2","title":"\u73af\u5883\u642d\u5efa\u4e0e\u5de5\u5177\u4f7f\u7528\u65b9\u6cd5\u4ecb\u7ecd","text":""},{"location":"assembly/workenv/#loongarch32r-linux-gnusf-","title":"<code>loongarch32r-linux-gnusf-*</code>","text":"<p>\u4ea4\u53c9\u5de5\u5177\u94fe\u76ee\u524d\u4ec5\u652f\u6301\u5bbf\u4e3b\u673a\u4e3ax86\u67b6\u6784\u548cLA64\u67b6\u6784\u7684\u7248\u672c\u3002\u4e0b\u8f7d\u540e\u53ef\u4ee5\u901a\u8fc7</p> <p><pre><code>$ echo 'export PATH=&lt;your loongarch32r-linux-gnusf path&gt;/bin:$PATH' &gt;&gt; ~/.bashrc\n$ source ~/.bashrc\n</code></pre> \u5c06\u5176\u6dfb\u52a0\u81f3\u73af\u5883\u53d8\u91cf\u4e2d\u5e76\u4f7f\u5176\u751f\u6548\u3002\u53ef\u4ee5\u5728\u547d\u4ee4\u884c\u4e2d\u8f93\u5165<code>loong</code>\u540e\u6309<code>&lt;TAB&gt;</code>\u952e\u67e5\u770b\u662f\u5426\u80fd\u591f\u81ea\u52a8\u8054\u60f3\u51fa<code>loongarch32r-linux-gnusf-</code>\uff0c\u6765\u68c0\u67e5\u8def\u5f84\u914d\u7f6e\u662f\u5426\u6b63\u786e\u3002</p> <p>\u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5\u4e0e\u4e0d\u5e26\u4ea4\u53c9\u524d\u7f00\u7684\u4f7f\u7528\u65b9\u6cd5\u4e00\u81f4\u3002\u6700\u5e38\u4f7f\u7528\u7684\u4e24\u4e2a\u5de5\u5177\u4e3a<code>gcc</code>\u548c<code>objdump</code>\u3002\u524d\u8005\u7528\u4e8e\u7f16\u8bd1<code>.c</code>\u6216<code>.S</code>\u6e90\u6587\u4ef6\u751f\u6210\u76ee\u6807\u673a\u53ef\u6267\u884c\u7a0b\u5e8f\uff1b\u540e\u8005\u7528\u4e8e\u751f\u6210\u53cd\u6c47\u7f16\u6587\u4ef6\uff0c\u5e38\u7528\u4e8edebug\uff0c\u67e5\u770b\u6307\u4ee4\u5730\u5740<code>PC</code>\u548c\u6307\u4ee4<code>inst</code>\u7684\u5173\u7cfb\uff0c\u67e5\u770b\u53d8\u91cf\u7684\u5185\u5b58\u5730\u5740\u7b49\u7b49\uff0c\u5b83\u7684\u4e0d\u540c\u53c2\u6570\u4f1a\u8f93\u51fa\u4e0d\u540c\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u67e5\u9605GNU\u5de5\u5177\u624b\u518c\u7684<code>objdump</code>\u90e8\u5206\u4e86\u89e3\u66f4\u591a\u3002</p> <p><pre><code># compile source\n$ loongarch32r-linux-gnusf-gcc &lt;file_name&gt;.S -o &lt;file_name&gt;\n\n# dump disassembly file\n$ loongarch32r-linux-gnusf-objdump -D &lt;file_name&gt; &gt; &lt;file_name&gt;.s\n</code></pre> </p>"},{"location":"assembly/workenv/#la32r-qemu","title":"<code>la32r-QEMU</code>","text":"<p>\u901a\u8fc7<code>qemu</code>\uff08Quick Emulator\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u5bbf\u4e3b\u673a\u4e0a\u8fd0\u884c\u76ee\u6807\u673a\u67b6\u6784\u7a0b\u5e8f\uff0c\u80fd\u591f\u8fd0\u884c\u6211\u4eec\u7f16\u5199\u7684LA32R\u6c47\u7f16\u7a0b\u5e8f\u3002</p> <p>qemu\u7f16\u8bd1 \u56e0\u4e3a\u63d0\u4f9b\u7684\u662fqemu\u6e90\u7801\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728\u5404\u81ea\u5bbf\u4e3b\u673a\u4e0a\u8fdb\u884c\u7f16\u8bd1\u8fd0\u884c\u3002\u7f16\u8bd1qemu\u524d\u8bf7\u9605\u8bfb\u4ed3\u5e93\u7684wiki\uff0c\u5b89\u88c5\u597d\u7f16\u8bd1\u65f6\u7684\u4f9d\u8d56\u3002\u7f16\u5199\u7f16\u8bd1\u811a\u672c<code>&lt;your qemu path&gt;/build.sh</code>\uff0c\u5efa\u8bae\u6dfb\u52a0<code>--static</code>\u7f16\u8bd1\u9009\u9879\u751f\u6210\u9759\u6001\u53ef\u6267\u884cqemu\u3002\u751f\u6210\u7684qemu\u4e3a<code>&lt;your qemu path&gt;/build/qemu-system-loongarch32</code>\u3002</p> build.sh<pre><code>#!/bin/bash\nif [ ! -d \"build\" ]; then\nmkdir build\nfi\ncd build\n../configure --target-list=loongarch32-softmmu  \\\n--disable-werror --enable-debug    \\\n--static\nmake -j\n</code></pre> <p>qemu\u8fd0\u884c</p> <p>QEMU\u7684\u4e24\u79cd\u8fd0\u884c\u6a21\u5f0f\uff1a</p> <p>User Mode\uff08\u4f7f\u7528\u8005\u6a21\u5f0f\uff09\uff1a\u7528\u6237\u53ea\u9700\u8981\u5c06\u76ee\u6807\u673a\u67b6\u6784\u7a0b\u5e8f\u653e\u5728QEMU\u4e2d\u8fd0\u884c\u5373\u53ef\uff0c\u5176\u4ed6\u7684\u4e8b\u60c5\u5168\u90e8\u7531QEMU\u865a\u62df\u673a\u6765\u5b8c\u6210\uff0c\u4e0d\u9700\u8981\u7528\u6237\u81ea\u5b9a\u4e49\u5185\u6838\u548c\u865a\u62df\u78c1\u76d8\u7b49\u6587\u4ef6\u3002</p> <p>System Mode\uff08\u7cfb\u7edf\u6a21\u5f0f\uff09\uff1a\u7528\u6237\u9700\u8981\u4e3aQEMU\u6307\u5b9a\u8fd0\u884c\u7684\u5185\u6838\u6216\u8005\u865a\u62df\u786c\u76d8\u7b49\u6587\u4ef6\u3002</p> <p>\u76ee\u524dla32r\u7684qemu\u4ec5\u652f\u6301<code>system</code>\u6a21\u5f0f\uff0c\u56e0\u6b64\u5728\u4f7f\u7528\u65f6\u6211\u4eec\u9700\u8981\u901a\u8fc7<code>-kernel</code>\u9009\u9879\u4e3a\u5176\u6307\u5b9a\u5185\u6838\u6587\u4ef6\uff0c\u4e0b\u4e00\u5c0f\u8282\u5bf9\u5185\u6838\u6587\u4ef6\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\u3002\u5176\u4ed6\u53c2\u6570\u914d\u7f6e\u8be6\u89c1qemu\u4ed3\u5e93\u7684wiki\u3002\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u7f16\u5199\u8fd0\u884c\u811a\u672c<code>&lt;your qemu path&gt;/system_run.sh</code>\u3002</p> <p>\u5982\u679c\u5728qemu\u4e0a\u8fd0\u884c\u51fa\u9519\uff0c\u9700\u8981debug\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528<code>loongarch32r-linux-gnusf-gdb</code>\u901a\u8fc7\u7aef\u53e3\u8fde\u63a5\u540e\u8fdb\u884c\u4ea4\u53c9\u8c03\u8bd5\u3002\u6b64\u65f6\u9700\u8981\u6dfb\u52a0<code>-gdb tcp::1234</code>\u914d\u7f6e\u7aef\u53e3\u53f7\uff0c\u4ee5\u53ca<code>-S</code>\u8ba9qemu\u4e0d\u81ea\u52a8\u8fd0\u884c\uff0c\u4e0egdb\u8fde\u63a5\u540e\u518d\u8fd0\u884c\u3002</p> system_run.shsystem_run_gdb.sh <pre><code>#!/bin/bash\n/build/qemu-system-loongarch32 \\\n-M ls3a5k32 \\\n-kernel &lt;your linux image path&gt; \\\n-nographic \\\n-serial mon:stdio \\\n-m 128 \\\n-append \"console=ttyS0,115200 rdinit=/init loglevel=9\" \\\n-monitor tcp::4278,server,nowait \\\n-smp 1\n</code></pre> <pre><code>#!/bin/bash\n/build/qemu-system-loongarch32 \\\n-M ls3a5k32 \\\n-kernel &lt;your linux image path&gt; \\\n-nographic \\\n-serial mon:stdio \\\n-m 128 \\\n-append \"console=ttyS0,115200 rdinit=/init loglevel=9\" \\\n-monitor tcp::4278,server,nowait \\\n-smp 1 \\\n-gdb tcp::1234 \\\n-S\n</code></pre> <p></p>"},{"location":"assembly/workenv/#la32r-linux","title":"<code>la32r-Linux</code>","text":"<p>\u7531\u4e8e\u76ee\u524dla32r\u7684qemu\u4ec5\u652f\u6301<code>system</code>\u6a21\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u6307\u5b9a\u5185\u6838\u6587\u4ef6\uff0c\u5373\u4e3a\u7531\u8be5\u6e90\u7801\u7f16\u8bd1\u5b8c\u6210\u7684\u5185\u5b58\u955c\u50cf\u6587\u4ef6\u3002</p> <p><code>initrd</code>\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf \u7531\u4e8e\u76ee\u524dla32r\u7684linux\u5c1a\u4e0d\u652f\u6301\u6587\u4ef6\u7cfb\u7edf\uff0c\u4ec5\u652f\u6301<code>initrd</code>\u5185\u5b58\u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u9700\u8981\u628a\u7531gcc\u7f16\u8bd1\u597d\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u653e\u5165<code>initrd</code>\u6587\u4ef6\u5939\u4e2d\uff0c\u7f16\u8bd1\u5185\u6838\uff0c\u4ece\u800c\u8fd0\u884cqemu\u540e\u53ef\u4ee5\u5728\u540c\u4e00\u8def\u5f84\u4e2d\u627e\u5230\u53ef\u6267\u884c\u7a0b\u5e8f\u5e76\u8fdb\u884c\u6267\u884c\u3002\u6bcf\u6b21\u5bf9<code>initrd</code>\u4e2d\u7684\u6587\u4ef6\u4fee\u6539\u540e\u90fd\u5fc5\u987b\u91cd\u65b0\u7f16\u8bd1\u5185\u6838\u3002la32r\u7684linux\u63d0\u4f9b\u4e00\u4e2a\u57fa\u7840\u7684<code>initrd</code>\u5305\uff0c\u4e0b\u8f7d\u540e\u89e3\u538b\u53ef\u76f4\u63a5\u4f7f\u7528\u3002</p> <p>\u53ef\u4ee5\u770b\u5230<code>initrd</code>\u7684\u76ee\u5f55\u7ed3\u6784\u5c31\u662f\u6211\u4eec\u5e73\u5e38\u6240\u89c1\u7684\u6839\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u7cfb\u7edf\u7684\u7ed3\u6784\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u5199\u597d\u7684\u5e94\u7528\u7a0b\u5e8f\u653e\u7f6e\u4e8e<code>initrd_d/home</code>\u76ee\u5f55\u4e0b\uff0c\u5e76\u4fee\u6539<code>initrd_d/etc/profile</code>\u4f7f\u5f97\u6bcf\u6b21\u542f\u52a8linux\u540e\u76f4\u63a5\u8fdb\u5165\u53ef\u6267\u884c\u7a0b\u5e8f\u6240\u5728\u8def\u5f84\u3002</p> tree initrd_dinitrd_d/etc/profile <pre><code>initrd_d\n\u251c\u2500\u2500 bin\n\u251c\u2500\u2500 dev\n\u251c\u2500\u2500 emb\n\u251c\u2500\u2500 etc\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 init.d\n\u251c\u2500\u2500 home\n\u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 modules\n\u251c\u2500\u2500 lib32 -&gt; lib\n\u251c\u2500\u2500 media\n\u251c\u2500\u2500 mnt\n\u251c\u2500\u2500 proc\n\u251c\u2500\u2500 sbin\n\u251c\u2500\u2500 sys\n\u251c\u2500\u2500 tmp\n\u251c\u2500\u2500 usr\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 sbin\n\u2514\u2500\u2500 var\n</code></pre> <pre><code># /etc/profile: system-wide .profile file for the Bourne shells                  \necho\necho -n \"Processing /etc/profile... \"\n# no-op\necho \"Done\"\necho\nexport HOME=/home/\ncd $HOME\n</code></pre> <p>linux\u7f16\u8bd1 \u56e0\u4e3a\u63d0\u4f9b\u7684\u662flinux\u6e90\u7801\uff0c\u6211\u4eec\u9700\u8981\u5728\u5bbf\u4e3b\u673a\u4e0a\u8fdb\u884c\u4ea4\u53c9\u7f16\u8bd1\u3002\u7f16\u8bd1linux\u524d\u8bf7\u9605\u8bfb\u4ed3\u5e93\u7684<code>README</code>\u3002\u4fee\u6539\u7f16\u8bd1\u811a\u672c<code>&lt;your linux path&gt;/la_build.sh</code>\uff0c\u6ce8\u610f\u4fee\u6539<code>CROSS_COMPILE</code>\u53d8\u91cf\uff0c\u56e0\u4e3a\u524d\u9762\u6211\u4eec\u5df2\u5c06\u5176\u6dfb\u52a0\u5230\u73af\u5883\u53d8\u91cf\u4e2d\uff0c\u53ef\u4ee5\u4e0d\u6307\u660e\u4ea4\u53c9\u7f16\u8bd1\u5668\u8def\u5f84\u3002\u751f\u6210\u7684linux\u4e3a<code>&lt;your linux path&gt;/la_build/vmlinux</code>\u3002</p> la_build.sh<pre><code>#!/bin/bash\nexport CROSS_COMPILE=loongarch32r-linux-gnusf-\nexport ARCH=loongarch\nOUT=la_build\n\nif [ ! -d la_build ] ;then\nmkdir la_build\n    make la32_defconfig O=${OUT}\nfi\necho \"----------------output ${OUT}----------------\"\nmake menuconfig O=${OUT}\nmake vmlinux -j  O=${OUT} 2&gt;&amp;1 | tee -a build_error.log\n</code></pre> <p>\u7f16\u8bd1linux\u65f6\uff0c\u6211\u4eec\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u660e<code>initrd_d</code>\u7684\u8def\u5f84\u3002\u4e00\u4e2a\u529e\u6cd5\u662f\u901a\u8fc7<code>menuconfig</code>\u56fe\u5f62\u754c\u9762\u5b8c\u6210\u914d\u7f6e\uff0c\u6ce8\u610f\u8def\u5f84\u6309\u7167\u4e2a\u4eba\u914d\u7f6e\u6765\u8bbe\u7f6e\u3002</p> menuconfig <p>\u53e6\u4e00\u4e2a\u529e\u6cd5\u662f\u4e0e<code>menuconfig</code>\u5177\u6709\u76f8\u540c\u529f\u80fd\u7684\u975e\u56fe\u5f62\u5316\u914d\u7f6e\uff0c\u4fee\u6539<code>la_build/.config</code>\u6587\u4ef6\u4e2d\u7684\u5982\u4e0b\u53c2\u6570\u5373\u53ef\u3002</p> <pre><code>CONFIG_INITRAMFS_SOURCE=\"&lt;your initrd path&gt;\"\n</code></pre> <p></p>"},{"location":"assembly/workenv/#loongarch32r-linux-gnusf-gdb","title":"loongarch32r-linux-gnusf-gdb","text":"<p>\u5982\u679c\u5728qemu\u4e0a\u7a0b\u5e8f\u8fd0\u884c\u51fa\u9519\uff0c\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5229\u7528gdb\u8fdb\u884cdebug\u3002\u524d\u9762\u63d0\u5230\uff0c\u53ef\u4ee5\u5728qemu\u8fd0\u884c\u65f6\u6dfb\u52a0<code>-gdb tcp::1234</code>\u548c<code>-S</code>\u53c2\u6570\uff0c\u7b49\u5f85gdb\u901a\u8fc7\u7aef\u53e31234\u6765\u8fde\u63a5\u3002\u8fde\u63a5\u540e\uff0c\u50cf\u8c03\u8bd5\u666e\u901a\u5bbf\u4e3b\u673a\u7a0b\u5e8f\u4e00\u6837\u8c03\u8bd5\u5373\u53ef\u3002</p> <p>qemu\u4e0egdb\u7684\u8fde\u63a5\u8fc7\u7a0b</p> \u5bbf\u4e3b\u673a terminal 1: qemu\u5bbf\u4e3b\u673a terminal 2: gdb <pre><code># start qemu\n$ cd &lt;your qemu path&gt;\n$ ./system_run_gdb.sh\n# qemu wait for connection\n</code></pre> <pre><code>$ cd &lt;your initrd_d path&gt;\n# load file's symbol table\n$ loongarch32r-linux-gnusf-gdb &lt;file_name&gt;\n</code></pre> <pre><code># connect with gdb\n</code></pre> <pre><code># at gdb terminal\n(gdb) target remote :1234\n(gdb) b main\n(gdb) b &lt;somewhere_you_want&gt;\n(gdb) c\n</code></pre> <pre><code># qemu start run\n# at qemu kernel terminal\n/home $ ./&lt;file_name&gt;\n</code></pre> <pre><code># \u2026 reach breakpoints\n# trail for bugs\n(gdb) &lt;command&gt;\n</code></pre> <p>gdb\u5e38\u7528\u547d\u4ee4</p> \u547d\u4ee4 \u4f8b\u5b50 \u7528\u6cd5 <code>c</code> - \u7ee7\u7eed\u6267\u884c\uff0c\u76f4\u5230\u9047\u5230\u65ad\u70b9 <code>si</code> - \u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\uff0c\u5982\u679c\u6709\u51fd\u6570\u8c03\u7528\uff0c\u5219\u8fdb\u5165\u51fd\u6570\u5185\u90e8 <code>ni</code> - \u6267\u884c\u4e0b\u4e00\u6761\u6307\u4ee4\uff0c\u5373\u4f7f\u6709\u51fd\u6570\u8c03\u7528\uff0c\u4e5f\u4e0d\u4f1a\u8fdb\u5165\u51fd\u6570\u5185\u90e8 <code>i r</code>(<code>info registers</code>) - \u67e5\u770b\u5168\u90e8\u901a\u7528\u5bc4\u5b58\u5668\u503c <code>b &lt;symbol&gt;</code> <code>b main</code> \u5728\u6807\u53f7\u5904\u8bbe\u65ad\u70b9 <code>b *&lt;addr&gt;</code> <code>b *0x10518</code> \u5728\u67d0\u5730\u5740\u5904\u8bbe\u65ad\u70b9 <code>p /&lt;basic_format&gt; &lt;symbol&gt;</code> <code>p /x $sp</code> \u4ee5\u67d0\u79cd\u683c\u5f0f\u6253\u5370\u67d0\u4e2a\u6807\u53f7\uff08\u5bc4\u5b58\u5668\u6216\u53d8\u91cf\uff09\u7684\u503c<code>&lt;basic_format&gt;</code>:<code>c-&gt;char</code><code>d-&gt;decimal</code><code>o-&gt;octal</code><code>x-&gt;hex</code> <code>x /&lt;format&gt; &lt;symbol&gt;</code> <code>x /10x 0x10580</code><code>x /20i 0x10580</code><code>x /20i $pc</code> \u4ee5\u67d0\u79cd\u683c\u5f0f\u6253\u5370\u5185\u5b58\u5730\u5740\u7684\u503c<code>&lt;format&gt; = &lt;num&gt;&lt;basic_format&gt;</code><code>&lt;basic_format&gt;</code>:<code>c-&gt;char</code><code>d-&gt;decimal</code><code>o-&gt;octal</code><code>x-&gt;hex</code><code>i-&gt;instruction</code> <code>disassemble</code> - \u67e5\u770b\u5f53\u524d<code>PC</code>\u6240\u5728\u5730\u5740\u7684\u4e00\u6bb5\u6c47\u7f16\u6307\u4ee4"},{"location":"instructions/br_jump_instrs/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/br_jump_instrs/#_1","title":"\u5206\u652f\u8df3\u8f6c\u7c7b\u6307\u4ee4","text":"<p>LA32R\u4e2d\u7684\u5206\u652f\u8df3\u8f6c\u7c7b\u6307\u4ee4\u7528\u4e8e\u63a7\u5236\u6307\u4ee4\u6267\u884c\u6d41\u6d41\u5411\uff08Instruction Flow Control\uff09\uff0c\u5176\u4e2d\u9700\u8981\u8fdb\u884c\u6761\u4ef6\u5224\u65ad\u51b3\u5b9a\u8df3\u8f6c\uff08Taken\uff09\u8fd8\u662f\u4e0d\u8df3\u8f6c\uff08Not Taken\uff09\u7684\u6211\u4eec\u79f0\u4e3a\u6761\u4ef6\u5206\u652f\u6307\u4ee4\uff0c\u4f59\u4e0b\u7684\u5219\u662f\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\u3002</p>"},{"location":"instructions/br_jump_instrs/#_2","title":"\u6761\u4ef6\u5206\u652f\u6307\u4ee4","text":""},{"location":"instructions/br_jump_instrs/#_3","title":"\u6761\u4ef6\u5206\u652f\u6307\u4ee4\u901f\u67e5\u8868","text":"<p>LA32R\u4e2d\u5728\u6307\u4ee4\u96c6\u624b\u518c\u4e2d\u5b9a\u4e49\u7684\u771f\u5b9e\u6761\u4ef6\u5206\u652f\u6307\u4ee4\u6709\u5982\u4e0b6\u6761\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca beq (branch if equal) beq $rx, $ry, off16 if (GR[x] == GR[y]) PC += sext32(off16 &lt;&lt; 2) bne (branch if not equal) bne $rx, $ry, off16 if (GR[x] != GR[y]) PC += sext32(off16 &lt;&lt; 2) blt (branch if less than signed) blt $rx, $ry, off16 if (GR[x] &lt;s GR[y]) PC += sext32(off16 &lt;&lt; 2) bge (branch if greater than or equal signed) bge $rx, $ry, off16 if (GR[x] &gt;=s GR[y]) PC += sext32(off16 &lt;&lt; 2) bltu (branch if less than unsigned) bltu $rx, $ry, off16 if (GR[x] &lt;u GR[y]) PC += sext32(off16 &lt;&lt; 2) bgeu (branch if greater than or equal unsigned) bgeu $rx, $ry, off16 if (GR[x] &gt;=u GR[y]) PC += sext32(off16 &lt;&lt; 2) <p>\u6709\u7231\u597d\u8005\u95ee\uff0c\u4e0d\u662f\u8bf4LA\u7684\u5206\u652f\u6307\u4ee4\u652f\u6301\u6240\u6709\u7684\u6574\u6570\u6bd4\u8f83\u7c7b\u578b\uff0c\u90a3\u4e48\u4e3a\u4ec0\u4e48\u201c\u5c0f\u4e8e\u7b49\u4e8e\u201d\u548c\u201c\u5927\u4e8e\u201d\u6ca1\u6709\u5462\u3002\u5176\u5b9e\uff0c<code>A</code>\u5c0f\u4e8e\u7b49\u4e8e<code>B</code>\u7b49\u4ef7\u4e8e<code>B</code>\u5927\u4e8e\u7b49\u4e8e<code>A</code>\uff0c<code>A</code>\u5927\u4e8e<code>B</code>\u7b49\u4ef7\u4e8e<code>B</code>\u5c0f\u4e8e<code>A</code>\u3002\u8c03\u6574\u88ab\u6bd4\u8f83\u5bf9\u8c61\u5728\u5206\u652f\u6307\u4ee4\u4e2d<code>rd</code>\u548c<code>rj</code>\u57df\u7684\u4f4d\u7f6e\uff0c\u5c31\u80fd\u5b9e\u73b0\u6240\u6709\u7684\u6574\u6570\u6bd4\u8f83\u7c7b\u578b\u3002\u5373\u4fbf\u5982\u6b64\uff0cLA32R\u7684\u6c47\u7f16\u5668\u8fd8\u662f\u975e\u5e38\u8d34\u5fc3\u7684\u5b9a\u4e49\u4e86\u4e0b\u9762\u4e00\u7cfb\u5217\u4f2a\u6307\u4ee4\uff0c\u8ba9\u6c47\u7f16\u4ee3\u7801\u66f4\u4fbf\u4e8e\u9605\u8bfb\u3002</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca bgt (branch if greater than signed) bgt $rx, $ry, off16 if (GR[x] &gt;s GR[y]) PC += sext32(off16 &lt;&lt; 2) bgtu (branch if greater than unsigned) bgtu $rx, $ry, off16 if (GR[x] &gt;u GR[y]) PC += sext32(off16 &lt;&lt; 2) ble (branch if less than or equal signed) ble $rx, $ry, off16 if (GR[x] &lt;=s GR[y]) PC += sext32(off16 &lt;&lt; 2) bleu (branch if less than or equal unsigned) bleu $rx, $ry, off16 if (GR[x] &lt;=u GR[y]) PC += sext32(off16 &lt;&lt; 2) bltz (branch if less than zero signed) bltz $rx, off16 if (GR[x] &lt;s 0) PC += sext32(off16 &lt;&lt; 2) bgtz (branch if greater than zero signed) bgtz $rx, off16 if (GR[x] &gt;s 0) PC += sext32(off16 &lt;&lt; 2) blez (branch if less than or equal to zero signed) blez $rx, off16 if (GR[x] &lt;=s 0) PC += sext32(off16 &lt;&lt; 2) bgez (branch if greater than or equal to zero signed) bgez $rx, off16 if (GR[x] &gt;=s 0) PC += sext32(off16 &lt;&lt; 2) <p>\u5c3d\u7ba1\u6709\u4e0a\u8ff0\u4f2a\u6307\u4ee4\uff0c\u7ec6\u5fc3\u7684\u8bfb\u8005\u53ef\u80fd\u53c8\u53d1\u73b0\u95ee\u9898\u4e86\uff0c\u4e3a\u4ec0\u4e48\u6ca1\u6709<code>beqz</code>(branch if equal zero)\u548c<code>bnez</code>(branch if not equal zero)\uff1f\u56e0\u4e3aLA64\u548cLA32\u7684\u6307\u4ee4\u96c6\u4e2d\u5df2\u7ecf\u5b9a\u4e49\u4e86<code>beqz</code>\u548c<code>bnez</code>\u6307\u4ee4\uff0c\u6240\u4ee5LA32R\u5982\u679c\u5b9a\u4e49\u540c\u540d\u7684\u4f2a\u6307\u4ee4\u4f1a\u7ed9\u8f6f\u4ef6\u7684\u7ef4\u62a4\u5e26\u6765\u56f0\u6270\u3002\u5728LA32R\u6c47\u7f16\u7f16\u7a0b\u4e2d\uff0c\u8bf7\u76f4\u63a5\u7528<code>beq $r##, $zero</code>\u548c<code>bne $r##, $zero</code>\u6765\u5b9e\u73b0\u6240\u9700\u7684\u529f\u80fd\u3002</p>"},{"location":"instructions/br_jump_instrs/#labeltaken-target","title":"\u7528\u6807\u7b7e\uff08Label\uff09\u6765\u6307\u793a\u8df3\u8f6c\u76ee\u6807\uff08Taken Target\uff09","text":"<p>\u5206\u652f\u6307\u4ee4\u7684\u5b9a\u4e49\u4e2d\u90fd\u6709\u4e00\u4e2a\u7acb\u5373\u6570\u504f\u79fb\u503c<code>off16</code>\uff0c\u90a3\u4e48\u6c47\u7f16\u7f16\u7a0b\u65f6\u662f\u4e0d\u662f\u8981\u81ea\u5df1\u8ba1\u7b97\u51fa\u8df3\u8f6c\u76ee\u6807\u5904\u4e0e\u8fd9\u6761\u5206\u652f\u6307\u4ee4\u7684\u76f8\u5bf9\u504f\u79fb\u91cf\u5462\uff1f\u6211\u4eec\u5f3a\u70c8\u4e0d\u63a8\u8350\u8fd9\u6837\u505a\u3002\u4e14\u4e0d\u8bf4\u7531\u4e8e\u4f2a\u6307\u4ee4\u548c\u5b8f\u7684\u5b58\u5728\u4e3a\u8ba1\u7b97\u76f8\u5bf9\u504f\u79fb\u91cf\u589e\u52a0\u96be\u5ea6\uff0c\u5c31\u7b97\u53ef\u4ee5\u7b97\u5f97\u51c6\uff0c\u5982\u679c\u4ee3\u7801\u6709\u6240\u589e\u51cf\u5c82\u4e0d\u662f\u53c8\u8981\u91cd\u65b0\u8ba1\u7b97\u4e00\u904d\u3002\u901a\u5e38\u6211\u4eec\u5728\u6c47\u7f16\u7f16\u7a0b\u65f6\u90fd\u662f\u91c7\u7528<code>beq $r##, $r##, label</code>\u8fd9\u79cd\u5199\u6cd5\uff0c\u5373\u5728\u8fd9\u6761\u5206\u652f\u7684\u8df3\u8f6c\u76ee\u6807\u5904\u8bbe\u7f6e\u4e00\u4e2a\u6807\u7b7e\uff0c\u7136\u540e\u5728\u5206\u652f\u6307\u4ee4\u4e2d\u76f4\u63a5\u5199\u8fd9\u4e2a\u6807\u7b7e\u7684\u540d\u5b57\u5c31\u53ef\u4ee5\u4e86\u3002\u5206\u652f\u6307\u4ee4\u4e2d\u7684off16\u53c2\u6570\u5177\u4f53\u8be5\u586b\u4ec0\u4e48\uff0c\u5c31\u4ea4\u7ed9\u5de5\u5177\u94fe\u8f6f\u4ef6\u4e86\u3002\u5177\u4f53\u7684\u7528\u6cd5\u5728\u4e0b\u4e00\u5c0f\u8282\u7684\u4f8b\u5b50\u4e2d\u4f1a\u6709\u770b\u5230\u3002</p>"},{"location":"instructions/br_jump_instrs/#c","title":"\u5e38\u89c1C\u8bed\u8a00\u63a7\u5236\u7ed3\u6784\u5bf9\u5e94\u7684\u6c47\u7f16\u8868\u8fbe","text":"<p>\u5148\u6765\u770bif-else\u7ed3\u6784</p> <pre><code>if (cond_exp)\n&lt;then_statement&gt;\nelse\n&lt;else_statement&gt;\n</code></pre> <pre><code>    move    $t0, cond_exp\nbeq     $t0, $zero, .L1\n&lt;then_statement&gt;\nb       .L2\n.L1:\n&lt;else_statement&gt;\n.L2:\n</code></pre> <p>\u4e0a\u9762\u793a\u4f8b\u4e2d\u7684<code>b</code>\u6307\u4ee4\u5728LA32R\u4e2d\u5e76\u4e0d\u662f\u4e00\u6761\u4f2a\u6307\u4ee4\uff0c\u5b83\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u6761\u65e0\u6761\u4ef6\u7684PC\u76f8\u5bf9\u8df3\u8f6c\u6307\u4ee4\uff0c\u5b8c\u6210\u7c7b\u4f3c\u4e8eC\u8bed\u8a00\u4e2d<code>goto</code>\u8bed\u53e5\u7684\u6548\u679c\u3002</p> <p>\u518d\u6765\u770b\u770b\u5982\u4f55\u7528\u5206\u652f\u6307\u4ee4\u6784\u6210\u5faa\u73af\u7ed3\u6784\u3002</p> <pre><code>int test_for(int a) {\nint sum = 0;\nint i = 0;\nfor (i = 0; i &lt; a; i++) {\nsum += i;\n}\nreturn sum;\n}\n</code></pre> <pre><code>test_for:\nmove    $t0, $zero\nmove    $t1, $zero\n.L2:    blt     $t0, $a0, .L3\nmove    $a0, $t1\njr      $ra\n.L3:    add.w   $t1, $t1, $t0\naddi.w  $t0, $t0, 1\nb       .L2\n</code></pre> <pre><code>int test_while(int a) {\nint sum = 0;\nint i = 0;\nwhile (i &lt; a) {\nsum += i;\ni++;\n}\nreturn sum;\n}\n</code></pre> <pre><code>test_while:\nmove    $t0, $zero\nmove    $t1, $zero\n.L2:\nblt     $t0, $a0, .L3\nmove    $a0, $t1\njr      $ra\n.L3:\nadd.w   $t1, $t1, $t0\naddi.w  $t0, $t0, 1\nb       .L2\n</code></pre> <pre><code>int test_dowhile(int a) {\nint sum = 0;\nint i = 0;\ndo {\nsum += i;\ni++;\n} while (i &lt; a);\nreturn sum;\n}\n</code></pre> <pre><code>test_dowhile:\nmove    $t0, $zero move    $t3, $zero\n.L2:\nadd.w   $t1, $t3, $t0\naddi.w  $t2, $t0, 1\nmove    $t3, $t1\nmove    $t0, $t2\nblt     $t2, $a0, .L2\nmove    $a0, $t1\njr      $ra\n</code></pre> <p>\u4e0a\u9762\u7684\u6c47\u7f16\u4ee3\u7801\u4e2d\u7684label\u6cbf\u7528\u4e86\u7f16\u8bd1\u5668\u751f\u6210\u51fa\u7684\u6c47\u7f16\u4ee3\u7801\u4e2d\u7684\u98ce\u683c\uff0c\u5728\u4eba\u5de5\u5f00\u53d1\u6c47\u7f16\u7a0b\u5e8f\u65f6\uff0c\u5982\u679c\u8df3\u8f6c\u8ddd\u79bb\u4e0d\u592a\u8fdc\uff0c\u8fd8\u6709\u4e00\u79cd\u5e38\u7528\u7684\u547d\u540d\u548c\u6807\u8bc6\u5f62\u5f0f\u3002\u6211\u4eec\u6765\u770b\u4e0b\u9762\u4e24\u6bb5\u4ee3\u7801\uff1a</p> <pre><code>    ...\nTarget1:\nbeq     $t0, $zero, Target2\n...\nblt     $t1, $a0, Target1\nTarget2:\n...\n</code></pre> <pre><code>    ...\n1:\nbeq     $t0, $zero, 1f\n...\nblt     $t1, $a0, 1b\n1:\n...\n</code></pre> <p>\u4e0a\u9762\u4e24\u6bb5\u6c47\u7f16\u4ee3\u7801\u5b9e\u9645\u4e0a\u662f\u7b49\u4ef7\u7684\u3002\u6211\u4eec\u770b\u5230\u7b2c\u4e8c\u6bb5\u6c47\u7f16\u4e2d\u4e24\u4e2a\u6807\u53f7\u90fd\u662f\u201c1\u201d\uff0c\u90a3\u4e48\u4e24\u6761\u5206\u652f\u6307\u4ee4\u662f\u5982\u4f55\u533a\u5206\u5b83\u4eec\u7684\u5462\uff1f\u5176\u4e2d<code>beq  $t0, $zero, 1f</code>\u4e2d\u7684<code>1f</code>\u662f\u8fd9\u6761\u6307\u4ee4\u5411\u4e0b\uff08\u4e5f\u53ef\u4ee5\u8bf4\u662f\u5411\u524d\uff0cforward\uff09\u9047\u5230\u7684\u7b2c\u4e00\u4e2a\u6807\u8bb0\u4e3a<code>1</code>\u7684\u6807\u53f7\uff0c\u800c<code>blt  $t1, $a0, 1b</code>\u4e2d\u7684<code>1b</code>\u662f\u8fd9\u6761\u6307\u4ee4\u5411\u4e0a\uff08\u4e5f\u53ef\u4ee5\u8bf4\u662f\u5411\u540e\uff0cbackward\uff09\u9047\u5230\u7684\u7b2c\u4e00\u4e2a\u6807\u8bb0\u4e3a<code>1</code>\u7684\u6807\u53f7\u3002\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u5bf9\u4e8e\u6c47\u7f16\u7f16\u7a0b\u5f00\u53d1\u63d0\u4f9b\u4e86\u4fbf\u5229\uff0c\u6bd5\u7adf\u4f60\u4e0d\u7528\u8d39\u52b2\u5fc3\u601d\u4fdd\u8bc1\u4e00\u4e2a\u6587\u4ef6\u5185\u6240\u6709\u7684\u6807\u53f7\u7684\u540d\u5b57\u90fd\u4e0d\u540c\u3002</p>"},{"location":"instructions/br_jump_instrs/#_4","title":"\u6574\u6570\u6bd4\u8f83\u7f6e\u7ed3\u679c\u7684\u6307\u4ee4","text":"<p>\u5c3d\u7ba1\u5206\u652f\u6307\u4ee4\u53ef\u4ee5\u5b8c\u6210\u4e24\u4e2a\u6574\u578b\u6570\u4e4b\u95f4\u7684\u6240\u6709\u6bd4\u8f83\u64cd\u4f5c\uff0c\u4f46\u662f\u5f53\u6d89\u53ca\u591a\u4e2a\u53d8\u91cf\u95f4\u66f4\u590d\u6742\u7684\u6761\u4ef6\u8868\u8fbe\u5f0f\u65f6\uff0c\u7f16\u8bd1\u5668\u6216\u6c47\u7f16\u8bed\u8a00\u7a0b\u5e8f\u5458\u53ef\u4ee5\u5229\u7528\u6574\u6570\u6bd4\u8f83\u7f6e\u7ed3\u679c\u7684\u6307\u4ee4\u4e0e\u903b\u8f91\u6307\u4ee4\u8ba1\u7b97\u51fa\u8fd9\u7c7b\u6761\u4ef6\u8868\u8fbe\u5f0f\u7684\u503c\u3002\u8fd9\u7c7b\u6307\u4ee4\u51714\u6761\uff0c\u5217\u4e3e\u5982\u4e0b\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca slt (set less than) slt $rx, $ry, $rz GR[x] = (GR[y] &lt;s GR[z]) ? 1 : 0 sltu (set less than unsigned) sltu $rx, $ry, $rz GR[x] = (GR[y] &lt;u GR[z]) ? 1 : 0 slti (set less than immediate) slt $rx, $ry, si12 GR[x] = (GR[y] &lt;s sext32(si12)) ? 1 : 0 sltui (set less than unsigned immediate) slt $rx, $ry, si12 GR[x] = (GR[y] &lt;u sext32(si12)) ? 1 : 0"},{"location":"instructions/br_jump_instrs/#_5","title":"\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4","text":""},{"location":"instructions/br_jump_instrs/#_6","title":"\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\u901f\u67e5","text":"<p>LA32R\u4e2d\u5728\u6307\u4ee4\u96c6\u624b\u518c\u4e2d\u5b9a\u4e49\u7684\u771f\u5b9e\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\u6709\u5982\u4e0b3\u6761\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca b (branch) b offs26 PC += sext32(offs26 &lt;&lt; 2) bl (branch and link) bl offs26 GR[1] = PC + 4; PC += sext32(offs26 &lt;&lt; 2) jirl (jump indirect register link) jirl $rx, $ry, offs16 GR[x] = PC + 4; PC = GR[y] + sext32(offs16 &lt;&lt; 2) <p>\u4e0a\u9762\u7684<code>jirl</code>\u6307\u4ee4\u7684\u529f\u80fd\u6bd4\u8f83\u591a\uff0c\u65e2\u6709\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u95f4\u63a5\u8df3\u8f6c\u529f\u80fd\uff0c\u53c8\u6709\u4fdd\u5b58\u8fd4\u56de\u5730\u5740\u7684Link\u529f\u80fd\u3002\u8003\u8651\u5230\u5f88\u591a\u5e94\u7528\u573a\u666f\u4e2d\u53ea\u9700\u8981\u57fa\u4e8e\u5bc4\u5b58\u5668\u7684\u95f4\u63a5\u8df3\u8f6c\u7684\u529f\u80fd\uff08\u4f8b\u5982\u51fd\u6570\u8fd4\u56de\u65f6\u7684\u8df3\u8f6c\uff09\uff0c\u4e3a\u4e86\u589e\u52a0\u4ee3\u7801\u7684\u53ef\u9605\u8bfb\u6027\uff0cLA32R\u7684\u6c47\u7f16\u5668\u652f\u6301\u4e86<code>jr</code>\u8fd9\u6761\u6c47\u7f16\u4f2a\u6307\u4ee4\u3002</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca jr (jump register) jr $rx PC = GR[x]"},{"location":"instructions/br_jump_instrs/#_7","title":"\u51fd\u6570\u8c03\u7528\u4e0e\u51fd\u6570\u8fd4\u56de","text":"<p>\u65e0\u6761\u4ef6\u8df3\u8f6c\u6307\u4ee4\u6700\u5178\u578b\u7684\u5e94\u7528\u573a\u666f\u662f\u51fd\u6570\u8c03\u7528\u548c\u51fd\u6570\u8fd4\u56de\u3002\u5728LA32R\u4e2d\uff0c\u5b8c\u6210\u51fd\u6570\u8c03\u7528\u529f\u80fd\u7684\u662f<code>bl</code>\u6307\u4ee4\uff0c\u5b8c\u6210\u51fd\u6570\u8fd4\u56de\u529f\u80fd\u7684\u662f<code>jr $ra</code>\u4f2a\u6307\u4ee4\u3002\u6574\u4e2a\u51fd\u6570\u8c03\u7528\u3001\u6267\u884c\u5e76\u8fd4\u56de\u7684\u8fc7\u7a0b\u6240\u8981\u8fdb\u884c\u7684\u64cd\u4f5c\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <ul> <li>\u8c03\u7528\u8005\u5c06\u53c2\u6570\uff08\u5b9e\u53c2\uff09\u5b58\u5165\u5bc4\u5b58\u5668\u6216\u6808\u4e2d\uff1b</li> <li>\u8c03\u7528\u8005\u4f7f\u7528<code>bl</code>\u6307\u4ee4\u8c03\u7528\u88ab\u8c03\u7528\u8005\uff1b</li> <li>\u88ab\u8c03\u7528\u8005\u5728\u6808\u4e2d\u4e3a\u81ea\u5df1\u6240\u9700\u8981\u7684\u5c40\u90e8\u53d8\u91cf\u5206\u914d\u7a7a\u95f4\uff08\u6808\u6307\u9488\u8c03\u6574\u4e0b\u79fb\uff09\uff1b</li> <li>\u88ab\u8c03\u7528\u8005\u81ea\u8eab\u6267\u884c\uff1b</li> <li>\u88ab\u8c03\u7528\u8005\u91ca\u653e\u81ea\u8eab\u5c40\u90e8\u53d8\u91cf\u5728\u6808\u4e2d\u7684\u7a7a\u95f4\uff08\u6808\u6307\u9488\u4e0a\u79fb\u590d\u539f\uff09\uff1b</li> <li>\u88ab\u8c03\u7528\u8005\u6267\u884c<code>jr $ra</code>\u8fd4\u56de\u8c03\u7528\u8005\u3002</li> </ul> <p>\u63a5\u4e0b\u6765\u901a\u8fc7\u4e00\u4e2a\u5177\u4f53\u4f8b\u5b50\u6765\u52a0\u6df1\u4e0a\u8ff0\u8fc7\u7a0b\u7684\u8ba4\u8bc6\u3002</p> <pre><code>int add(int a,int b)\n{ return a+b; }\nint ref()\n{\nint t1 = 12;\nint t2 = 34;\nreturn add(t1,t2);\n}\n</code></pre> <pre><code>add:\nadd.w   $a0, $a0, $a1   # a+b\njr      $ra             # return\nref:\naddi.w  $sp, $sp, -16   # stack allocate\nli.w    $a1, 34         # t2=34\nli.w    $a0, 12         # t1=12\nst.w    $ra, $sp, 4     # save $ra\nbl      add             # call add()\nld.w    $ra, $sp, 4     # restore $ra\naddi.w  $sp, $sp, 16    # stack release\njr      $ra             # return\n</code></pre> <p><code>bl</code>\u6307\u4ee4\u7684\u5bfb\u5740\u8303\u56f4\u662f\u8be5\u6307\u4ee4\u524d\u540e\u5404227\u5b57\u8282\u7684\u7a7a\u95f4\uff0c\u5c3d\u7ba1\u8bf4\u8fd9\u5c1a\u4e0d\u80fd\u8986\u76d6\u6574\u4e2a32\u4f4d\u5730\u5740\u7a7a\u95f4\uff0c\u4f46\u662f\u5bf9\u4e8e\u7edd\u5927\u591a\u657032\u4f4d\u5e94\u7528\u7a0b\u5e8f\u7684text\u6bb5\u6765\u8bf4\uff0c\u8fd9\u4e2a\u5bfb\u5740\u8ddd\u79bb\u662f\u8db3\u591f\u7684\u4e86\u3002\u6240\u4ee5\u6c47\u7f16\u7f16\u7a0b\u4e2d\u7684\u51fd\u6570\u8c03\u7528\u7528<code>bl</code>\u6307\u4ee4\u57fa\u672c\u5c31\u591f\u7528\u4e86\uff0c\u4e0d\u518d\u9700\u8981\u4f7f\u7528Link\u81f3<code>$ra</code>\u5bc4\u5b58\u5668\u7684\u95f4\u63a5\u8df3\u8f6c\u6307\u4ee4<code>jirl $ra, $r##, ####</code>\u3002</p>"},{"location":"instructions/compute_instrs/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/compute_instrs/#_1","title":"\u7b97\u672f\u903b\u8f91\u79fb\u4f4d\u7c7b\u6307\u4ee4","text":"<p>\u8fd9\u4e00\u8282\u6211\u4eec\u5148\u6765\u770b\u6700\u5bb9\u6613\u7406\u89e3\u638c\u63e1\u7684\u7b97\u672f\u903b\u8f91\u7c7b\u6307\u4ee4\u3002</p>"},{"location":"instructions/compute_instrs/#_2","title":"\u7b97\u672f\u903b\u8f91\u79fb\u4f4d\u7c7b\u6307\u4ee4\u901f\u67e5\u8868","text":"\u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca add.w (add word) add.w $rx, $ry, $rz GR[x] = GR[y] + GR[z] sub.w (subtract word) sub.w $rx, $ry, $rz GR[x] = GR[y] - GR[z] addi.w (add immediate word) addi.w $rx, $ry, si12 GR[x] = GR[y] + sext32(si12) mul.w (multiply word) mul.w $rx, $ry, $rz GR[x] = (GR[y] * GR[z])[31:0] mulh.w (multiply high word signed) mulh.w $rx, $ry, $rz GR[x] = (GR[y] s*s GR[z])[63:32] mulh.wu (multiply high word usigned) mulh.wu $rx, $ry, $rz GR[x] = (GR[y] u*u GR[z])[63:32] div.w (divide word signed) div.w $rx, $ry, $rz GR[x] = GR[y] /s GR[z] mod.w (modulo word signed) mod.w $rx, $ry, $rz GR[x] = GR[y] %s GR[z] div.wu (divide word usigned) div.wu $rx, $ry, $rz GR[x] = GR[y] /u GR[z] mod.wu (modulo word usigned) mod.wu $rx, $ry, $rz GR[x] = GR[y] %u GR[z] and (and) and $rx, $ry, $rz GR[x] = GR[y] &amp; GR[z] or (or) or $rx, $ry, $rz GR[x] = GR[y] | GR[z] nor (not or) nor $rx, $ry, $rz GR[x] = ~(GR[y] | GR[z]) xor (exclusive or) xor $rx, $ry, $rz GR[x] = GR[y] ^ GR[z] andi (and immediate) andi $rx, $ry, ui12 GR[x] = GR[y] &amp; zext32(ui12) ori (or immediate) ori $rx, $ry, ui12 GR[x] = GR[y] | zext32(ui12) xori (exclusive or immediate) xori $rx, $ry, ui12 GR[x] = GR[y] ^ zext32(ui12) sll.w (shift left logic word) sll.w $rx, $ry, $rz GR[x] = GR[y] &lt;&lt; GR[z][4:0] srl.w (shift right logic word) srl.w $rx, $ry, $rz GR[x] = GR[y] &gt;&gt;u GR[z][4:0] sra.w (shift right arithmetic word) sra.w $rx, $ry, $rz GR[x] = GR[y] &gt;&gt;s GR[z][4:0] slli.w (shift left logic immediate word) slli.w $rx, $ry, ui5 GR[x] = GR[y] &lt;&lt; ui5 srli.w (shift right logic immediate word) srli.w $rx, $ry, ui5 GR[x] = GR[y] &gt;&gt;u ui5 srai.w (shift right arithmetic immediate word) srai.w $rx, $ry, ui5 GR[x] = GR[y] &gt;&gt;s ui5 <p>\u4e0a\u8868\u4e2d\u7684\u529f\u80fd\u89e3\u91ca\u501f\u7528\u4e86C\u8bed\u8a00\u4e2d\u7684<code>+</code>\u3001<code>-</code>\u3001<code>*</code>\u3001<code>/</code>\u3001<code>%</code>\u3001<code>&gt;&gt;</code>\u3001<code>&lt;&lt;</code>\u3001<code>&amp;</code>\u3001<code>|</code>\u3001<code>^</code>\u3001<code>~</code>\u8fd0\u7b97\u7b26\uff0c\u540c\u65f6\u4e5f\u4f53\u73b0\u4e86\u8fd9\u4e9b\u6307\u4ee4\u4e0eC\u8bed\u8a00\u4e2d\u7684\u7b97\u672f\u903b\u8f91\u64cd\u4f5c\u4e4b\u95f4\u7684\u5173\u8054\u6027\u3002\u6b64\u5916<code>sext32(IMM)</code>\u8868\u793a\u5c06\u6570\u503cIMM\u6709\u7b26\u53f7\u6269\u5c55\u81f332\u4f4d\uff0c<code>zext32(IMM)</code>\u8868\u793a\u5c06\u6570\u503cIMM\u96f6\u6269\u5c55\uff08\u4e5f\u5c31\u662f\u65e0\u7b26\u53f7\u6269\u5c55\uff09\u81f332\u4f4d\u3002</p>"},{"location":"instructions/compute_instrs/#_3","title":"\u90e8\u5206\u64cd\u4f5c\u7684\u8fdb\u4e00\u6b65\u8bf4\u660e","text":""},{"location":"instructions/compute_instrs/#_4","title":"\u53d8\u91cf\u51cf\u4e00\u4e2a\u5c0f\u5e38\u6570\u7684\u64cd\u4f5c","text":"<p>\u6c47\u7f16\u7f16\u7a0b\u4e2d\u4f60\u53ef\u80fd\u9700\u8981\u5b8c\u6210\u53d8\u91cf\u51cf\u4e00\u4e2a\u5c0f\u5e38\u6570<code>N</code>\uff08N &lt; 211\uff09\u7684\u64cd\u4f5c\u3002\u7ecf\u5e38\u6709\u521d\u5b66\u8005\u56e0\u4e3a\u5728LA23R\u7684\u6307\u4ee4\u96c6\u624b\u518c\u6216\u8005\u6c47\u7f16\u4f2a\u6307\u4ee4\u4e2d\u770b\u4e0d\u5230\u5f62\u5982<code>subi.w</code>\u8fd9\u6837\u7684\u6307\u4ee4\uff0c\u5c31\u4f1a\u4f7f\u7528<code>li.w</code>+<code>sub.w</code>\u4e24\u6761\u6307\u4ee4\u6765\u5b9e\u73b0\u3002\u8fd9\u91cc\u63d0\u793a\u4e00\u4e0b\uff0c<code>addi.w</code>\u6307\u4ee4\u4e2d\u768412\u4f4d\u7acb\u5373\u6570\u662f\u6709\u7b26\u53f7\u6269\u5c55\u81f3\u518d\u8fdb\u884c\u64cd\u4f5c\uff0c\u6362\u8a00\u4e4b\uff0c\u8be5\u6307\u4ee4\u768412\u4f4d\u7acb\u5373\u6570\u57df\u4e2d\u53ef\u4ee5\u5b58\u4e00\u4e2a\u8d1f\u6570\u3002\u52a0\u4e00\u4e2a\u8d1f\u7684\u5e38\u6570\uff0c\u5c31\u662f\u51cf\u4e00\u4e2a\u6b63\u7684\u5e38\u6570\u3002\u6240\u4ee5\uff0c\u53ea\u8981\u51cf\u53bb\u7684\u5e38\u6570<code>N</code>\u7684\u5927\u5c0f\u7b26\u5408\u524d\u9762\u8bb2\u7684\u6761\u4ef6\uff0c\u662f\u53ef\u4ee5\u7528\u5355\u6761\u6307\u4ee4<code>addi.w $r##, $r##, -N</code>\u5b8c\u6210\u7684\u3002</p>"},{"location":"instructions/compute_instrs/#_5","title":"\u4e58\u6cd5\u64cd\u4f5c","text":"<p>\u672c\u8282\u5f00\u5934\u8868\u4e2d\u7b26\u53f7 s*s\u8868\u793a\u4e24\u4e2a\u6709\u7b26\u53f7\u6570\u76f8\u4e58\uff0c\u7b26\u53f7 u*u\u8868\u793a\u4e24\u4e2a\u65e0\u7b26\u53f7\u6570\u76f8\u4e58\u3002\u4e3a\u4ec0\u4e48\u4e58\u6cd5\u8981\u533a\u5206\u6709\u7b26\u53f7\u548c\u65e0\u7b26\u53f7\uff0c\u800c\u52a0\u51cf\u6cd5\u5c31\u4e0d\u7528\u8fd9\u6837\u533a\u5206\u3002\u641e\u6e05\u695a\u8fd9\u4e2a\u95ee\u9898\u9700\u8981\u77e5\u6653\u4e8c\u8fdb\u5236\u8865\u7801\u7b97\u672f\u8fd0\u7b97\u76f8\u5173\u77e5\u8bc6\u3002\u5982\u679c\u4f60\u6ca1\u6709\u5b66\u8fc7\uff0c\u53ef\u4ee5\u81ea\u5b66\u300aComputer Organization and Design: The Hardware Software Interface\u300b\u4e2d\u201c\u8ba1\u7b97\u673a\u7b97\u672f\u8fd0\u7b97\u201d\u4e00\u7ae0\u4e2d\u7684\u76f8\u5173\u5185\u5bb9\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u81ea\u5b66\u300a\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u57fa\u7840\u300b\uff08\u7b2c3\u7248\uff09\u7b2c8\u7ae0\u201c\u8fd0\u7b97\u5668\u8bbe\u8ba1\u201d\u4e2d\u7684\u76f8\u5173\u5185\u5bb9\u3002</p> <p><code>mulh.w</code>\u548c<code>mulh.wu</code>\u8fd9\u4e24\u4e2a\u6307\u4ee4\u7684\u76ee\u7684\u5bc4\u5b58\u5668\u4e2d\u5b58\u653e\u7684\u662f\u4e58\u79ef\u7684\u9ad8\u534a\u90e8\u5206\u7ed3\u679c\u3002\u4e0d\u8fc7\u6839\u636e\u672c\u624b\u518c\u4f5c\u8005\u76ee\u524d\u7684\u8ba4\u77e5\u6c34\u5e73\uff0c\u5728C\u8bed\u8a00\u4e2d\u6ca1\u6709\u80fd\u591f\u7f16\u8bd1\u51fa\u8fd9\u4e24\u6761\u6307\u4ee4\u7684\u8868\u8fbe\u5f62\u5f0f\u3002\u5982\u679c\u8bfb\u8005\u60a8\u77e5\u9053\uff0c\u671b\u4e0d\u541d\u8d50\u6559\u3002\u6240\u4ee5\u8fd9\u4e24\u6761\u6307\u4ee4\u5e94\u8be5\u4ec5\u5728\u6c47\u7f16\u7f16\u7a0b\u4e2d\u624d\u7528\u7684\u4e0a\u3002\u8b6c\u5982\uff0c\u5f53\u4f60\u60f3\u5224\u65ad\u4e58\u6cd5\u7684\u7ed3\u679c\u6709\u6ca1\u6709\u6ea2\u51fa32\u4f4d\u53ef\u8868\u8fbe\u8303\u56f4\uff0c\u6216\u8005\u4f60\u5f00\u53d1\u7684\u5e94\u7528\u5176\u6570\u636e\u7684\u6570\u503c\u5206\u5e03\u5bfc\u81f4\u4e58\u79ef\u5fc5\u987b\u8981\u4f7f\u7528\u9ad8\u534a\u90e8\u5206\u7ed3\u679c\uff0c\u7b49\u7b49\u3002</p>"},{"location":"instructions/compute_instrs/#_6","title":"\u9664\u6cd5\u64cd\u4f5c","text":"<p>\u672c\u8282\u5f00\u5934\u8868\u4e2d\u7b26\u53f7/s\u8868\u793a\u4e24\u4e2a\u6709\u7b26\u53f7\u6570\u76f8\u9664\u53d6\u5546\uff0c%s\u8868\u793a\u4e24\u4e2a\u6709\u7b26\u53f7\u6570\u76f8\u9664\u53d6\u4f59\u6570\uff1b/u\u8868\u793a\u4e24\u4e2a\u65e0\u7b26\u53f7\u6570\u76f8\u9664\u53d6\u5546\uff0c%u\u8868\u793a\u4e24\u4e2a\u65e0\u7b26\u53f7\u6570\u76f8\u9664\u53d6\u4f59\u6570\u3002\u5982\u679c\u89c9\u5f97\u4e0d\u597d\u7406\u89e3\uff0c\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u3002</p> <pre><code>int a, b, c, d;\nunsigned int e, f, g, h;\nc = a / b; //\u5bf9\u5e94 div.w\nd = a % b; //\u5bf9\u5e94 mod.w\ng = e / f; //\u5bf9\u5e94 div.wu\nh = e % f; //\u5bf9\u5e94 mod.wu\n</code></pre> <p>LA32R\u4e2d\u9664\u6cd5\u6307\u4ee4\u81ea\u8eab\u4e0d\u8fdb\u884c\u96640\u7684\u68c0\u67e5\uff0c\u8fd9\u4e2a\u5de5\u4f5c\u4ea4\u7ed9\u8f6f\u4ef6\u6765\u505a\u3002\u4ee5\u4e0a\u9762\u4f8b\u5b50\u4e2d<code>c = a / b</code>\u6765\u8bf4\uff0c\u7f16\u8bd1\u5668\u4f1a\u4ea7\u751f\u7c7b\u4f3c\u5982\u4e0b\u7684\u4ee3\u7801\u5e8f\u5217\uff1a</p> <pre><code>div.w   $r12,$r14,$r13\nbne     $r13,$r0,8\nbreak   0x7\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u5e8f\u5217\u4e2d\uff0c\u5f53\u9664\u6570\u4e3a0\u65f6\uff0cbne\u6307\u4ee4\u5c06\u4e0d\u8df3\u8f6c\uff0c\u5c06\u6267\u884c\u5176\u540e\u7684break\u6307\u4ee4\uff0c\u89e6\u53d1\u65ad\u70b9\u4f8b\u5916\u3002\u7279\u522b\u8981\u6307\u51fa\u7684\u662f\uff0c\u4e0a\u9762\u5e8f\u5217\u4e2d\u7684\u540e\u4e24\u6761\u6307\u4ee4\u662fC\u7f16\u8bd1\u5668\u63d2\u5165\u7684\uff0c\u4e0e\u6c47\u7f16\u5668\u65e0\u5173\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u4f60\u5728\u6c47\u7f16\u4ee3\u7801\u4e2d\u76f4\u63a5\u5199<code>div.w</code>\u8fd9\u6761\u6307\u4ee4\u65f6\uff0c\u751f\u6210\u7684\u4ee3\u7801\u4e5f\u53ea\u6709<code>div.w</code>\u8fd9\u6761\u6307\u4ee4\u3002\u5982\u679c\u4f60\u662f\u5c06MIPS\u7684\u6c47\u7f16\u4ee3\u7801\u5f80LA\u67b6\u6784\u4e0a\u79fb\u690d\uff0c\u8981\u6ce8\u610fMIPS\u6c47\u7f16\u4e2d<code>div d, s, t</code>(d\u4e0d\u662f0\u53f7\u5bc4\u5b58\u5668)\u5176\u5b9e\u662f\u4e00\u6761\u5b8f\u6307\u4ee4\uff0cMIPS\u6c47\u7f16\u5668\u4f1a\u63d2\u5165\u96640\u5224\u65ad\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u800c\u5728LA\u4e2d\u8fd9\u4e9b\u903b\u8f91\u5c31\u5fc5\u987b\u7531\u4f60\u624b\u52a8\u5199\u51fa\u6765\u3002</p>"},{"location":"instructions/compute_instrs/#_7","title":"\u79fb\u4f4d\u64cd\u4f5c","text":"<p>\u672c\u8282\u5f00\u5934\u8868\u4e2d\u7b26\u53f7&gt;&gt;u\u8868\u793a\u903b\u8f91\u53f3\u79fb\uff08\u9ad8\u4f4d\u88650\uff09\uff0c\u7b26\u53f7&gt;&gt;s\u8868\u793a\u7b97\u672f\u53f3\u79fb\uff08\u9ad8\u4f4d\u8865\u7b26\u53f7\u4f4d\uff09\u3002\u5982\u679c\u89c9\u5f97\u4e0d\u597d\u7406\u89e3\uff0c\u53ef\u4ee5\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u3002</p> <pre><code>int a, b; unsigned int c, d;\nunsigned char shamt;\nb = a &gt;&gt; (shamt &amp; 0x1f);  //\u8fd9\u91cc\u7684&gt;&gt;\u64cd\u4f5c\u5c06\u5bf9\u5e94 sra.w\nd = c &gt;&gt; (shamt &amp; 0x1f);  //\u8fd9\u91cc\u7684&gt;&gt;\u64cd\u4f5c\u5c06\u5bf9\u5e94 srl.w\n</code></pre>"},{"location":"instructions/compute_instrs/#_8","title":"\u6bd4\u7279\u63d0\u53d6\u64cd\u4f5c\u4ee5\u53ca\u5b57\u8282\u534a\u5b57\u6269\u5c55\u64cd\u4f5c","text":"<p>LA32R\u7684\u6307\u4ee4\u4e2d\u6ca1\u6709\u5355\u6761\u6307\u4ee4\u5c31\u80fd\u5b8c\u6210\u6bd4\u7279\u63d0\u53d6\u64cd\u4f5c\u7684\u3002\u5982\u679c\u9700\u8981\u4ece\u5bc4\u5b58\u5668\u7684\u6570\u636e\u4e2d\u63d0\u53d6\u4e00\u4e32\u8fde\u7eed\u7684\uff0c\u901a\u5e38\u7528<code>slli.w</code>\u548c<code>srli.w</code>\u6307\u4ee4\u914d\u5408\u5728\u4e00\u8d77\u5b8c\u6210\u3002\u5982\u679c\u662f\u82e5\u5e72\u4e0d\u8fde\u7eed\u7684\u6bd4\u7279\u4f4d\u63d0\u53d6\u5e76\u62fc\u51d1\u5728\u4e00\u671f\uff0c\u90a3\u5c31\u518d\u7528\u79fb\u4f4d\u6307\u4ee4\u548c<code>or</code>\u6307\u4ee4\u5c06\u4f7f\u7528\u79fb\u4f4d\u6307\u4ee4\u63d0\u53d6\u51fa\u7684\u5404\u4e2a\u8fde\u7eed\u7684\u77ed\u4e32\u62fc\u63a5\u8d77\u6765\u3002</p> <p>\u5c3d\u7ba1\u8bf4LA32R\u5df2\u7ecf\u63d0\u4f9b\u4e86\u5b57\u8282\u3001\u534a\u5b57\u7684\u88c5\u8f7d\uff08load\uff09\u6307\u4ee4\uff0c\u6c47\u7f16\u7f16\u7a0b\u65f6\u4ecd\u53ef\u80fd\u9700\u8981\u5bf9\u5df2\u7ecf\u5728GR\u4e2d\u7684\u6570\u636e\u8fdb\u884c\u5b57\u8282\u6216\u534a\u5b57\u6269\u5c55\u64cd\u4f5c\u3002\u7531\u4e8e\u6ca1\u6709LA64/LA32\u4e2d\u7684\u4f4d\u64cd\u4f5c\u6307\u4ee4\uff0cLA32R\u4e2d\u5b57\u8282\u548c\u534a\u5b57\u6269\u5c55\u64cd\u4f5c\u53ef\u4ee5\u7528\u4e0b\u8868\u4e2d\u7684\u6307\u4ee4\u5e8f\u5217\u5b9e\u73b0\u3002</p> \u64cd\u4f5c \u5bf9\u5e94\u6307\u4ee4\u5e8f\u5217 Byte Signed Extend <code>slli.w $r##, $r##, 24</code>; <code>srai.w $r##, $r##, 24</code> Byte Unsigned Extend <code>slli.w $r##, $r##, 24</code>; <code>srli.w $r##, $r##, 24</code> Halfword Signed Extend <code>slli.w $r##, $r##, 16</code>; <code>srai.w $r##, $r##, 16</code> Halfword Unsigned Extend <code>slli.w $r##, $r##, 16</code>; <code>srli.w $r##, $r##, 16</code>"},{"location":"instructions/compute_instrs/#_9","title":"\u6309\u4f4d\u53d6\u53cd\u64cd\u4f5c","text":"<p>LA32R\u6c47\u7f16\u5668\u4e2d\u6ca1\u6709<code>not</code>\uff08\u6309\u4f4d\u53d6\u53cd\uff09\u8fd9\u6761\u4f2a\u6307\u4ee4\uff0c\u5982\u679c\u6c47\u7f16\u7f16\u7a0b\u65f6\u9700\u8981\uff0c\u53ef\u4ee5\u7528<code>nor rd, $zero, rj</code>\u6765\u8fbe\u6210<code>not rd, rj</code>\u7684\u529f\u80fd\u3002\u7279\u522b\u63d0\u9192\u6ce8\u610f\u7684\u662f\uff0cLA32R\u4e0b\u4e0d\u80fd\u50cfRISC-V\u90a3\u6837\u7528<code>xori rd, rs, -1</code>\u6765\u5b9e\u73b0\u3002RISC-V\u4e2d\u6240\u6709\u7684\u7acb\u5373\u6570\u90fd\u662f\u6709\u7b26\u53f7\u6269\u5c55\uff0c\u6240\u4ee5<code>xori rd, rs, -1</code>\u4e2d\u7684<code>-1</code>\u6269\u5c55\u523032\u4f4d\u540e\u5c31\u662f<code>0xFFFFFFFF</code>\uff0c\u5176\u4e0e\u4efb\u610f32\u4f4d\u6570\u5f02\u6216\u5c31\u662f\u6309\u4f4d\u53d6\u53cd\u7684\u6548\u679c\u3002\u4f46\u662fLA32R\u4e2d<code>xori</code>\u4e2d\u7684\u7acb\u5373\u6570\u662f\u96f6\u6269\u5c55\u7684\uff0c\u65e0\u6cd5\u8fbe\u6210\u7b49\u4ef7\u7684\u6548\u679c\u3002</p>"},{"location":"instructions/instr_expression/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/instr_expression/#la32r_1","title":"LA32R\u7684\u673a\u5668\u8bed\u8a00\u4e0e\u6c47\u7f16\u8bed\u8a00\u8868\u8fbe","text":"<p>\u8fd9\u4e00\u8282\u6211\u4eec\u8ba8\u8bba\u51e0\u4e2a\u4e0e\u6307\u4ee4\u7684\u673a\u5668\u8bed\u8a00\u548c\u6c47\u7f16\u8bed\u8a00\u4e24\u79cd\u8868\u8fbe\u5f62\u5f0f\u76f8\u5173\u7684\u95ee\u9898\u3002</p> <p>\u6211\u4eec\u5e38\u89c1\u7684\u6307\u4ee4\u8868\u8fbe\u5f62\u5f0f\u6709\u4e24\u79cd\uff1a\u4e00\u79cd\u662f\u7ed9CPU\u786c\u4ef6\u201c\u770b\u201d\u7684\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3a\u673a\u5668\u8bed\u8a00\uff1b\u53e6\u4e00\u79cd\u662f\u7ed9\u7f16\u7a0b\u4eba\u5458\u770b\u7684\uff0c\u5373\u6240\u8c13\u6c47\u7f16\u8bed\u8a00\u3002\u4f8b\u5982\uff0cLA32R\u4e2d\u529f\u80fd\u884c\u4e3a\u662f\u201c1\u53f7\u5bc4\u5b58\u5668\u7684\u503c\u52a0\u4e0a2\u53f7\u5bc4\u5b58\u5668\u7684\u503c\u7ed3\u679c\u5199\u51653\u53f7\u5bc4\u5b58\u5668\u201d\u8fd9\u6837\u4e00\u6761\u6307\u4ee4\uff0c\u5176\u673a\u5668\u8bed\u8a00\u8868\u8fbe\u662f\u4e00\u4e2a32\u4f4d\u7684\u6bd4\u7279\u4e32<code>00000000000100000000100000100011</code>\uff0c\u5176\u53ef\u4ee5\u88ab\u6c47\u7f16\u5668\u76f4\u63a5\u8bc6\u522b\u7684\u6c47\u7f16\u8bed\u8a00\u8868\u8fbe\u662f<code>add.w $r3, $r1, $r2</code>\u6216\u8005<code>add.w $sp, $ra, $tp</code>\u3002\u4e24\u79cd\u6c47\u7f16\u8bed\u8a00\u8868\u8fbe\u7684\u5dee\u5f02\u4e3b\u8981\u4f53\u73b0\u5728\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\uff0c\u7b2c\u4e00\u79cd\u662f\u4ece\u6307\u4ee4\u96c6\u624b\u518c\u89c4\u8303\u76f4\u63a5\u5f97\u5230\u7684\u6700\u57fa\u7840\u8868\u8fbe\u5f62\u5f0f\uff0c\u7b2c\u4e8c\u79cd\u5219\u6d89\u53ca\u5230ABI\u4e2d\u5b9a\u4e49\u7684\u5bc4\u5b58\u5668\u89c4\u8303\u3002</p>"},{"location":"instructions/instr_expression/#la32r_2","title":"LA32R\u7684\u673a\u5668\u8bed\u8a00\u8868\u8fbe","text":"<p>\u673a\u5668\u8bed\u8a00\u4e2d\u7684\u6307\u4ee4\u76f4\u89c2\u4e0a\u5c31\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6bd4\u7279\u4e32\uff0c\u8fdb\u4e00\u6b65\u5bf9\u4e8eRISC\u6307\u4ee4\u96c6\u6765\u8bf4\uff0c\u6784\u6210\u6bcf\u4e2a\u6307\u4ee4\u7684\u7684\u6bd4\u7279\u4e32\u90fd\u662f\u56fa\u5b9a\u957f\u5ea6\u3002LA32R\u6307\u4ee4\u96c6\u91c7\u7528RISC\u8bbe\u8ba1\u7406\u5ff5\uff0c\u5176\u6307\u4ee4\u957f\u5ea6\u56fa\u5b9a\u4e3a32\u4f4d\u3002\u8fd932\u4f4d\u7684\u6bd4\u7279\u4e32\uff0c\u54ea\u4e9b\u7528\u6765\u5bf9\u5e94\u64cd\u4f5c\u7c7b\u578b\uff08\u5982\u52a0\u51cf\u8fd8\u662f\u79fb\u4f4d\uff09\uff0c\u54ea\u4e9b\u7528\u6765\u5bfb\u5740\u64cd\u4f5c\u5bf9\u8c61\uff08\u5982\u54ea\u4e2a\u5bc4\u5b58\u5668\u6216\u8005\u5185\u5b58\u4e2d\u7684\u54ea\u4e2a\u5730\u5740\uff09\uff0c\u9700\u8981\u6709\u4e2a\u89c4\u5219\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u901a\u5e38\u8bb2\u7684\u6307\u4ee4\u7f16\u7801\u683c\u5f0f\u3002LA32R\u6307\u4ee4\u624b\u518c\u7684\u88681-1\u7ed9\u51fa\u4e86\u8be5\u6307\u4ee4\u96c6\u7684\u5178\u578b\u7f16\u7801\u683c\u5f0f\u3002\u6b63\u5982\u624b\u518c\u4e2d\u63d0\u5230\u7684\uff0c\u8fd99\u79cd\u662f\u5178\u578b\u7f16\u7801\u683c\u5f0f\uff0c\u5e76\u4e0d\u662f\u5168\u90e8\u7f16\u7801\u683c\u5f0f\u3002\u540cMIPS\u548cRISC-V\u6307\u4ee4\u96c6\u7684\u7f16\u7801\u683c\u5f0f\u76f8\u6bd4\uff0cLA32R\u7684\u79cd\u7c7b\u8981\u66f4\u591a\uff0c\u683c\u5f0f\u4e0a\u597d\u50cf\u4e5f\u6709\u5dee\u5f02\uff0c\u5bf9\u5df2\u7ecf\u719f\u6089MIPS\u6216RISC-V\u6559\u5b66\u548c\u8bbe\u8ba1\u7684\u4eba\u6765\u8bf4\u53ef\u80fd\u6709\u4e9b\u4e0d\u4e60\u60ef\u3002\u9488\u5bf9\u8fd9\u65b9\u9762\u95ee\u9898\uff0c\u4e0b\u9762\u63d0\u4f9b\u4e00\u4e9b\u6211\u4eec\u7684\u89c2\u70b9\u4f9b\u53c2\u8003\u3002</p> <p>\u5728\u6559\u5b66\u65b9\u9762\uff0cLA32R\u5177\u6709\u5927\u591a\u6570RISC\u6307\u4ee4\u96c6\u6307\u4ee4\u7f16\u7801\u7684\u8bbe\u8ba1\u7279\u5f81\uff0c\u4f53\u73b0\u5728\u4e09\u4e2a\u65b9\u9762\uff1a\u4e00\u662f\u5b9a\u957f\u4ee5\u7b80\u5316\u53d6\u6307\u8bbf\u5b58\u884c\u4e3a\u548c\u8bd1\u7801\u7535\u8def\u5b9a\u4f4d\u6307\u4ee4\u8fb9\u754c\u7684\u903b\u8f91\u590d\u6742\u5ea6\uff0c\u4e8c\u662f\u64cd\u4f5c\u7801\u91c7\u7528\u5c42\u6b21\u5316\u53d8\u957f\u7f16\u7801\u4ee5\u9002\u5e94\u4e0d\u7528\u6570\u76ee\u64cd\u4f5c\u6570\u7684\u60c5\u51b5\uff0c\u4e09\u662f\u64cd\u4f5c\u6570\u4f4d\u7f6e\u56fa\u5b9a\u4ece\u800c\u4f7f\u5f97\u8bd1\u7801\u8fc7\u7a0b\u4e2d\u64cd\u4f5c\u7801\u89e3\u6790\u548c\u64cd\u4f5c\u6570\u63d0\u53d6\u53ef\u4ee5\u5e76\u884c\u5904\u7406\u3002\u8fd9\u4e09\u65b9\u9762\u7279\u5f81\uff0c\u5b9a\u957f\u548c\u64cd\u4f5c\u6570\u4f4d\u7f6e\u56fa\u5b9a\u662f\u6bd4\u8f83\u5bb9\u6613\u7406\u89e3\u7684\uff0c\u5c42\u6b21\u5316\u53d8\u957f\u7f16\u7801\u53ef\u80fd\u8fd8\u662f\u4f1a\u8ba9\u4eba\u56f0\u60d1\uff1aMIPS\u6216\u8005RISC-V\u7684\u6307\u4ee4\u7f16\u7801\u6709opcode\u3001func\u57df\uff0c\u8fd9\u662f\u5c42\u6b21\u5316\uff0c\u4f46\u6ca1\u770b\u51fa\u53d8\u957f\uff1bLA32R\u4e2d\u7684opcode\u662f\u6709\u597d\u51e0\u4e2a\u957f\u5ea6\uff08\u53d8\u957f\uff09\uff0c\u4f46\u6ca1\u770b\u51fa\u5c42\u6b21\u5316\u3002\u5176\u5b9e\uff0c\u4e00\u5957\u6307\u4ee4\u96c6\u4e2d\u6307\u4ee4\u64cd\u4f5c\u7801\u4e3b\u8981\u804c\u8d23\u5c31\u662f\u80fd\u591f\u552f\u4e00\u7684\u6807\u8bc6\u51fa\u8fd9\u6761\u6307\u4ee4\uff0c\u53c8\u7531\u4e8e\u64cd\u4f5c\u6570\u4fe1\u606f\u5360\u636e\u7684\u4f4d\u7f6e\u6709\u957f\u6709\u77ed\uff0c\u56e0\u6b64\u8981\u5728\u6307\u4ee4\u7801\u6574\u4f53\u957f\u5ea6\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\u5b9a\u4e49\u5c3d\u53ef\u80fd\u591a\u7684\u6307\u4ee4\uff0c\u64cd\u4f5c\u7801\u5f88\u81ea\u7136\u7684\u4f1a\u91c7\u7528\u524d\u7f00\u7f16\u7801\u65b9\u5f0f\u6765\u63d0\u5347\u5176\u7f16\u7801\u6548\u7387\u3002\u53c8\u56e0\u4e3a\u589e\u51cf\u4e00\u4e2a\u64cd\u4f5c\u6570\u4f1a\u4e00\u6b21\u6027\u589e\u51cf\u51e0\u4e2a\u6bd4\u7279\uff08\u5982\u4e00\u4e2a\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\u53605\u4e2a\u6bd4\u7279\uff09\uff0c\u6240\u4ee5\u91c7\u7528\u524d\u7f00\u7f16\u7801\u5f62\u5f0f\u7684\u64cd\u4f5c\u7801\u53c8\u5448\u73b0\u51fa\u4e00\u79cd\u5c42\u6b21\u5316\u7684\u5f62\u6001\u3002</p> <p>\u5728\u8bbe\u8ba1\u65b9\u9762\uff0c\u771f\u6b63\u4f1a\u5173\u6ce8\u6307\u4ee4\u7801\u7ec6\u8282\u7684\u65e0\u5916\u4e4eCPU\u7ed3\u6784\u8bbe\u8ba1\u4eba\u5458\u548c\u6c47\u7f16\u5668\u5f00\u53d1\u4eba\u5458\u3002\u5176\u4e2d\u6c47\u7f16\u5668\u4e2d\u8bc6\u522b\u3001\u751f\u6210\u6307\u4ee4\u7801\u7684\u5de5\u4f5c\u662f\u8f6f\u4ef6\u81ea\u52a8\u8fdb\u884c\u7684\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u8fd8\u662f\u673a\u5668\u5728\u770b\uff0c\u6240\u4ee5\u6309\u7167\u6c47\u7f16\u5668\u6307\u4ee4\u7f16\u7801\u6a21\u677f\u7684\u683c\u5f0f\uff0c\u5c06LA32R\u6307\u4ee4\u624b\u518c\u9644\u5f55B\u4e2d\u7684\u6307\u4ee4\u7801\u4fe1\u606f\u586b\u5165\u5373\u53ef\u3002\u53ef\u80fd\u4f1a\u56e0\u4e3a\u6307\u4ee4\u7f16\u7801\u683c\u5f0f\u611f\u5230\u56f0\u96be\u7684\u53ef\u80fd\u662f\u4e00\u4e9b\u76f4\u63a5\u7528Verilog\u7b49\u4f20\u7edfHDL\u8bed\u8a00\u5f00\u53d1CPU\u8bd1\u7801\u90e8\u4ef6\u8bbe\u8ba1\u7684\u8bfb\u8005\uff0c\u56e0\u4e3a\u539f\u5148MIPS\u6216RISC-V\u6307\u4ee4\u96c6\u5c06\u64cd\u4f5c\u7801\u4fe1\u606f\u5c42\u6b21\u5207\u5206\u5230opcode\u3001funct\u7b49\u57df\u4e2d\uff0c\u4f1a\u4f7f\u5f97\u8bbe\u8ba1\u8005\u5f88\u81ea\u7136\u5730\u5728\u5199\u8bd1\u7801\u903b\u8f91\u65f6\u6309\u7167\u8fd9\u79cd\u5c42\u6b21\u5316\u98ce\u683c\u6765\u8bd1\u7801\u3002\u90a3\u4e48LA23R\u8fd9\u79cd\u60c5\u51b5\u600e\u4e48\u529e\u5462\uff1f\u5176\u5b9e\uff0c\u8bbe\u8ba1\u8005\u8fd8\u662f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\u4e00\u4e2a\u5207\u5206\u7684\u5c42\u6b21\uff0c\u518d\u6309\u7167\u5c42\u6b21\u5316\u98ce\u683c\u6765\u8bd1\u7801\u3002\u8b6c\u5982chiplab\u9879\u76ee\u4e2d<code>IP/myCPU/</code>\u76ee\u5f55\u4e0b\u7684OpenLA500\u5904\u7406\u5668\u6838\u7684\u8bd1\u7801\u903b\u8f91\uff08<code>id_stage.v</code>\uff09\u5c31\u662f\u8fd9\u79cd\u98ce\u683c\u3002\u4e0d\u8fc7\uff0c\u5982\u679c\u5bf9\u4e8e\u751f\u6210\u7535\u8def\u8d28\u91cf\u4e0d\u662f\u8981\u6c42\u90a3\u4e48\u9ad8\u4e14\u5bf9\u4e8e\u73b0\u4ee3EDA\u7efc\u5408\u5de5\u5177\u63d0\u53d6\u516c\u5171\u5b50\u8868\u8fbe\u4f18\u5316\u6709\u5145\u5206\u7684\u4fe1\u5fc3\uff0c\u76f4\u63a5\u5199\u51fa\u5982\u4e0b\u98ce\u683c\u7684\u4ee3\u7801\u4e5f\u672a\u5c1d\u4e0d\u53ef\uff1a</p> <pre><code>assign inst_add_w = inst_code[31:15]==17'h20;\nassign inst_sub_w = inst_code[31:15]==17'h22;\n</code></pre> <p>\u6700\u540e\u518d\u63a2\u8ba8\u4e00\u4e2a\u9605\u8bfb\u4f7f\u7528\u4e60\u60ef\u7684\u95ee\u9898\uff0c\u5373\u6709\u4e9b\u4eba\u95eeLA32R\u7684\u7528\u6237\u624b\u518c\u4e2d\u4e3a\u4ec0\u4e48\u4e0d\u50cf\u5176\u5b83\u6307\u4ee4\u96c6\u624b\u518c\u4e00\u6837\uff0c\u5c06\u6bcf\u6761\u6307\u4ee4\u7684\u6307\u4ee4\u7801\u548c\u5b83\u7684\u529f\u80fd\u8868\u8ff0\u9010\u6761\u653e\u5728\u4e00\u8d77\u3002\u5bf9\u6b64\u6211\u4eec\u7684\u8003\u8651\u662f\uff0c\u6307\u4ee4\u7801\u4f5c\u4e3a\u4e3b\u8981\u7ed9\u673a\u5668\u770b\u7684\u6307\u4ee4\u8868\u8fbe\uff0c\u901a\u5e38\u8bbe\u8ba1\u5f00\u53d1\u4eba\u5458\u5e76\u4e0d\u9700\u8981\u67e5\u770b\u3002\u76ee\u524d\u6211\u4eec\u80fd\u60f3\u5230\u7684\u5178\u578b\u5e94\u7528\u573a\u666f\uff0c\u4e3b\u8981\u662f\u524d\u9762\u63d0\u5230\u7684CPU\u8bd1\u7801\u90e8\u4ef6\u5f00\u53d1\u548c\u6c47\u7f16\u5668\u5f00\u53d1\u5de5\u4f5c\uff0c\u6b64\u5916\u5c31\u662f\u4eba\u5de5\u7ffb\u8bd1\u6307\u4ee4\u7801\u6216\u8005\u4ece\u6307\u4ee4\u7801\u89e3\u6790\u6307\u4ee4\u529f\u80fd\u8fd9\u79cd\u6781\u7279\u6b8a\u7684\u573a\u666f\u3002\u4ee5\u6211\u4eec\u7684\u5b9e\u8df5\u7ecf\u9a8c\u6765\u770b\uff0c\u8fd9\u4e9b\u573a\u666f\u4e0b\u90fd\u662f\u6240\u6709\u6307\u4ee4\u7684\u7f16\u7801\u96c6\u4e2d\u5728\u4e00\u5904\u6bd4\u5206\u6563\u5728\u624b\u518c\u5404\u5904\u66f4\u5229\u4e8e\u4f7f\u7528\u3002</p>"},{"location":"instructions/instr_expression/#la32r_3","title":"LA32R\u7684\u6c47\u7f16\u8bed\u8a00\u8868\u8fbe","text":"<p>\u672c\u5c0f\u8282\u5e76\u4e0d\u5c55\u5f00\u4ecb\u7ecdLA32R\u6c47\u7f16\u8bed\u8a00\uff0c\u53ea\u662f\u8ba8\u8bba\u521d\u5b66\u8005\u5728\u8fdb\u884cLA32R\u6c47\u7f16\u5f00\u53d1\u65f6\u5bb9\u6613\u4ea7\u751f\u56f0\u60d1\u7684\u5bc4\u5b58\u5668\u8868\u8fbe\u95ee\u9898\u548c\u4f2a\u6307\u4ee4\u95ee\u9898\u3002</p>"},{"location":"instructions/instr_expression/#_1","title":"\u5bc4\u5b58\u5668\u53f7\u524d\u662f\u5426\u8981\u52a0<code>$</code>?","text":"<p>\u5047\u8bbe\u5f53\u524d\u8981\u8868\u8fbe\u4e00\u4e2a\u5c06\u7b2c12\u53f7\u548c\u7b2c13\u53f7\u901a\u7528\u5bc4\u5b58\u5668\u503c\u76f8\u52a0\u7ed3\u679c\u5199\u5165\u7b2c14\u53f7\u5bc4\u5b58\u5668\u7684\u64cd\u4f5c\uff0c\u5df2\u77e5\u8fd9\u9700\u8981\u4f7f\u7528<code>add.w</code>\u6307\u4ee4\uff0c\u56e0\u4e3a\u6307\u4ee4\u624b\u518c\u4e2d<code>add.w</code>\u5199\u7684\u6307\u4ee4\u683c\u5f0f\u662f<code>add.w rd, rj, rk</code>\uff0c\u6240\u4ee5\u76f4\u89c2\u4e0a\u6c47\u7f16\u4ee3\u7801\u5e94\u8be5\u5199\u6210<code>add.w r14, r12, r13</code>\uff0c\u4f46\u662f\u8fd9\u6837\u5199\u7684\u4ee3\u7801\u7f16\u8bd1\u662f\u4f1a\u62a5\u9519\u7684\u3002\u76ee\u524dLA\u7684\u5de5\u5177\u94fe\u89c4\u5b9a\u4e86\u6307\u4ee4\u4e2d\u901a\u7528\u5bc4\u5b58\u5668\u53f7\u7684<code>r</code>\u524d\u9762\u5fc5\u987b\u6dfb\u52a0<code>$</code>\u7b26\u53f7\uff0c\u5373\u672c\u4f8b\u4e2d\u7684\u6307\u4ee4\u5e94\u8be5\u5199\u6210<code>add.w $r14, $r12, $r13</code>\u3002\u7531\u4e8e\u6211\u4eec\u8fdb\u884c\u6c47\u7f16\u6216\u53cd\u6c47\u7f16\u90fd\u79bb\u4e0d\u5f00\u5de5\u5177\u94fe\uff0c\u6240\u4ee5\u6c47\u7f16\u5668\u5bf9\u5bc4\u5b58\u5668\u64cd\u4f5c\u6570\u4e66\u5199\u5f62\u5f0f\u7684\u8981\u6c42\u5c31\u6210\u4e86\u4e00\u79cd\u4e8b\u5b9e\u4e0a\u7684\u89c4\u8303\u3002\u7c7b\u4f3c\u7684\u60c5\u51b5\u5bf9\u4e8e\u6d6e\u70b9\u6307\u4ee4\u4e5f\u5b58\u5728\uff0c\u5373\u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1\u7684\u4ee3\u7801\u4e2d\u6d6e\u70b9\u5bc4\u5b58\u5668\u8981\u5199\u6210<code>$f##</code>\u800c\u4e0d\u662f<code>f##</code>\u3002</p>"},{"location":"instructions/instr_expression/#abi","title":"\u6839\u636eABI\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\u7684\u5bc4\u5b58\u5668\u522b\u540d\u524d\u662f\u5426\u8981\u52a0<code>$</code>?","text":"<p>LoongArch\u7684ABI\u4e2d\u5b9a\u4e49\u4e86\u5bc4\u5b58\u5668\u4f7f\u7528\u7ea6\u5b9a\uff0c\u76ee\u524d\u5927\u591a\u6570\u8bfb\u8005\u5bf9\u8fd9\u90e8\u5206\u5185\u5bb9\u7684\u4e86\u89e3\u662f\u6765\u81ea\u4e8e\u300a\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u57fa\u7840\uff08\u7b2c3\u7248\uff09\u300b\u4e2d\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u4e66\u4e2d4.1.1\u5c0f\u8282\u88684-1\u4e2d\u6307\u51fa\u4e0d\u7528\u4fdd\u5b58\u7684\u6682\u5b58\u5668\u662f<code>r12 ~ r20</code>\uff0c\u5b83\u4eec\u7684\u522b\u540d\u662f<code>t0 ~ t8</code>\u3002\u4e0d\u8fc7\uff0c\u4e00\u4e9b\u8bfb\u8005\u5b9e\u9645\u770b\u5230\u7684\u6c47\u7f16\u6e90\u7a0b\u5e8f\u4e2d\u5374\u65e2\u6709\u5199\u6210<code>t##</code>\u53c8\u6709\u5199\u6210<code>$t##</code>\uff0c\u7136\u540e\u81ea\u5df1\u5199\u7a0b\u5e8f\u7684\u65f6\u5019\uff0c\u5199\u6210<code>t##</code>\u6709\u65f6\u5019\u7f16\u8bd1\u4e0d\u62a5\u9519\u6709\u65f6\u5019\u53c8\u62a5\u9519\u3002\u90a3\u4e48\u5230\u5e95\u54ea\u79cd\u5199\u6cd5\u662f\u6b63\u786e\u7684\u5462\uff1f\u5176\u5b9eLoongArch\u5de5\u5177\u94fe\u539f\u751f\u652f\u6301\u7684\u53ea\u6709<code>$t##</code>\u8fd9\u79cd\u5199\u6cd5\u3002\u4e4b\u6240\u4ee5\u6709\u7684\u5730\u65b9\u80fd\u5199\u6210<code>t##</code>\u800c\u7f16\u8bd1\u901a\u8fc7\uff0c\u5b9e\u9645\u4e0a\u662f\u56e0\u4e3a\u8fd9\u4e9b\u4ee3\u7801\u4e2d\u91cd\u65b0\u5b9a\u4e49\u4e86\u4e00\u6279\u5f62\u5982<code>t##</code>\u7684\u5b8f\u3002\u4f8b\u5982\uff0cchiplab\u9879\u76ee\u4e2d<code>software/func/</code>\u76ee\u5f55\u4e0b\u7684\u6c47\u7f16\u6d4b\u8bd5\u4ee3\u7801\u5305\u542b\u4e86<code>regdef.h</code>\u8fd9\u4e2a\u5934\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u4e86\u5982\u4e0b\u7684\u5b8f\u5b9a\u4e49\uff1a</p> <pre><code>#define zero    $r0\n#define ra      $r1\n#define tp      $r2\n#define sp      $r3\n#define a0      $r4\n#define a1      $r5\n#define a2      $r6\n#define a3      $r7\n#define a4      $r8\n#define a5      $r9\n#define a6      $r10\n#define a7      $r11\n#define v0      $r10 \n#define v1      $r11 \n#define t0      $r12\n#define t1      $r13\n#define t2      $r14\n#define t3      $r15\n#define t4      $r16\n#define t5      $r17\n#define t6      $r18\n#define t7      $r19\n#define t8      $r20\n#define x       $r21\n#define fp      $r22\n#define s0      $r23\n#define s1      $r24\n#define s2      $r25\n#define s3      $r26\n#define s4      $r27\n#define s5      $r28\n#define s6      $r29\n#define s7      $r30\n#define s8      $r31\n</code></pre>"},{"location":"instructions/instr_expression/#_2","title":"\u6c47\u7f16\u7a0b\u5e8f\u4e2d\u51fa\u73b0\u7684\u6307\u4ee4\u5728\u6307\u4ee4\u624b\u518c\u4e2d\u67e5\u4e0d\u5230\u662f\u600e\u4e48\u56de\u4e8b\uff1f","text":"<p>\u521d\u5b66\u8005\u53ef\u80fd\u4f1a\u5728\u4e00\u4e9bLA32R\u7684\u6c47\u7f16\u7a0b\u5e8f\u4e2d\u770b\u5230\u8bf8\u5982<code>move</code>\u3001<code>li.w</code>\u3001<code>jr</code>\u3001<code>la</code>\u8fd9\u6837\u7684\u6307\u4ee4\uff0c\u4f46\u662f\u7ffb\u904d\u6307\u4ee4\u96c6\u624b\u518c\u5374\u770b\u4e0d\u5230\u8fd9\u4e9b\u6307\u4ee4\u7684\u5b9a\u4e49\u3002\u5176\u5b9e\u8fd9\u4e9b\u6307\u4ee4\u662fLA32R\u7684\u6c47\u7f16\u5668\u652f\u6301\u7684\u4f2a\u6307\u4ee4\u3002\u4e4b\u6240\u4ee5\u79f0\u5176\u201c\u4f2a\u201d\u662f\u56e0\u4e3a\u5b83\u4eec\u5e76\u4e0d\u201c\u771f\u201d\u7684\u9700\u8981\u5728CPU\u4e0a\u4e13\u95e8\u5b9e\u73b0\uff0c\u5b83\u4eec\u5176\u5b9e\u662f\u4e00\u4e9b\u56fa\u5b9a\u4e86\u67d0\u4e9b\u64cd\u4f5c\u6570\u8868\u8fbe\u5f62\u5f0f\u7684\u6307\u4ee4\uff08\u5e8f\u5217\uff09\u3002\u4f8b\u5982\uff0c\u4f2a\u6307\u4ee4<code>move $r1 $r2</code>\u5b9e\u9645\u4e0a\u4f1a\u88ab\u6c47\u7f16\u5668\u81ea\u52a8\u7ffb\u8bd1\u6210<code>or $r1, $r2, $r0</code>\uff0c\u4f2a\u6307\u4ee4<code>jr $ra</code>\u4f1a\u88ab\u6c47\u7f16\u5668\u81ea\u52a8\u7ffb\u8bd1\u6210<code>jirl $r0, $ra, 0</code>\u3002\u6c47\u7f16\u5668\u5b9a\u4e49\u4f2a\u6307\u4ee4\u662f\u4e3a\u4e86\u5728\u4e0d\u589e\u52a0\u786c\u4ef6\u5b9e\u73b0\u5f00\u9500\u7684\u60c5\u51b5\u4e0b\u4e30\u5bcc\u6c47\u7f16\u7f16\u7a0b\u53ef\u7528\u7684\u6307\u4ee4\uff0c\u63d0\u5347\u6c47\u7f16\u5f00\u53d1\u7684\u6548\u7387\u3002\u672c\u624b\u518c\u7b2c1\u90e8\u5206\u540e\u9762\u5c06\u4f1a\u7ed3\u5408\u5177\u4f53\u7684\u5e94\u7528\u573a\u666f\u9646\u7eed\u4ecb\u7ecdLA32R\u6c47\u7f16\u5f00\u53d1\u65f6\u5e38\u7528\u7684\u4f2a\u6307\u4ee4\uff0c\u540c\u65f6\u5728\u672c\u624b\u518c\u7b2c2\u90e8\u5206\u5c06\u5217\u51fa\u76ee\u524dLA32R\u6c47\u7f16\u5668\u652f\u6301\u7684\u6240\u6709\u4f2a\u6307\u4ee4\u4f9b\u5927\u5bb6\u67e5\u9605\u3002</p> <p>\u8fd9\u91cc\u518d\u548c\u719f\u6089MIPS\u6c47\u7f16\u7684\u8bfb\u8005\u63a2\u8ba8\u4e00\u4e0b\uff0c\u4e3a\u4ec0\u4e48\u6211\u4eec\u7528\u201c\u4f2a\u6307\u4ee4\u201d\u800c\u4e0d\u662fMIPS\u4f53\u7cfb\u4e0b\u7684\u201c\u5b8f\u6307\u4ee4\u201d\u6765\u79f0\u547c\u4e0a\u9762\u8fd9\u4e9b\u6307\u4ee4\u3002\u4e3b\u8981\u8fd8\u662fMIPS\u7684ABI\u4e2d\u9884\u7559\u4e86\u4e00\u4e2a\u901a\u7528\u5bc4\u5b58\u5668<code>at</code>\u4e13\u4f9b\u6c47\u7f16\u5668\u4f7f\u7528\uff0c\u6709\u4e86\u8fd9\u4e2a\u5bc4\u5b58\u5668\u5b58\u50a8\u4e34\u65f6\u4e2d\u95f4\u53d8\u91cf\uff0c\u6c47\u7f16\u5668\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u66f4\u590d\u6742\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u5176\u5bf9\u5e94\u7684\u5b8f\u6307\u4ee4\u786e\u5b9e\u529f\u80fd\u66f4\u4e30\u5bcc\uff0c\u4e5f\u914d\u5f97\u4e0a<code>macro</code>\u8fd9\u4e2a\u8bcd\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0cLA\u4e2d\u7684\u4f2a\u6307\u4ee4\u5c3d\u7ba1\u4e5f\u6709\u5bf9\u5e94\u4e24\u4e09\u6761\u771f\u5b9e\u6307\u4ee4\u5e8f\u5217\u7684\uff0c\u4f46\u5927\u591a\u6570\u53ea\u5bf9\u5e94\u4e00\u6761\uff0c\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u66f4\u50cf\u662f\u4e00\u4e2a\u201c\u522b\u540d\u201d\uff0c\u56e0\u6b64\u7528<code>pseudo</code>\u8fd9\u4e2a\u8bcd\u66f4\u5408\u9002\u4e00\u70b9\u3002</p>"},{"location":"instructions/ldst_instrs/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/ldst_instrs/#_1","title":"\u6570\u636e\u4f20\u8f93\u7c7b\u6307\u4ee4","text":"<p>\u524d\u4e00\u8282\u4e2d\u6211\u4eec\u4ecb\u7ecd\u4e86LA32R\u4e2d\u4e3b\u8981\u7684\u8fd0\u7b97\u7c7b\u6307\u4ee4\uff0c\u90a3\u4e48\u5982\u4f55\u4e3a\u8fd9\u4e9b\u8fd0\u7b97\u6307\u4ee4\u63d0\u4f9b\u64cd\u4f5c\u6570\u5462\uff0c\u8fd9\u5c31\u6d89\u53ca\u5230\u672c\u8282\u6240\u5173\u6ce8\u7684\u6570\u636e\u4f20\u8f93\u7c7b\u6307\u4ee4\u3002</p>"},{"location":"instructions/ldst_instrs/#_2","title":"\u5411\u5bc4\u5b58\u5668\u4e2d\u52a0\u8f7d\u7acb\u5373\u6570","text":"<p>\u9664\u4e86<code>addi.w</code>\u3001<code>andi</code>\u3001<code>ori</code>\u3001<code>xori</code>\u3001<code>slli.w</code>\u3001<code>srli.w</code>\u3001<code>srai.w</code>\u8fd9\u4e9b\u6307\u4ee4\u4e2d\u4ee5\u7acb\u5373\u6570\u5f62\u5f0f\u5b58\u5728\u7684\u64cd\u4f5c\u6570\u5916\uff0c\u6700\u76f4\u63a5\u7684\u63d0\u4f9b\u64cd\u4f5c\u6570\u7684\u65b9\u5f0f\u5c31\u662f\u5411\u5bc4\u5b58\u5668\u4e2d\u52a0\u8f7d\u4e00\u4e2a\u7acb\u5373\u6570\u3002\u4e3a\u4e86\u5b9e\u73b0\u9ad8\u6548\u7684\u7acb\u5373\u6570\u52a0\u8f7d\uff0c\u6307\u4ee4\u4e2d\u5b9a\u4e49\u4e86\u5982\u4e0b\u4e00\u6761\u771f\u5b9e\u6307\u4ee4\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca lu12i (load upper from bit12 immediate) lu12i $rx, si12 GR[x] = si20 &lt;&lt; 12 <p>\u4e0d\u8fc7\uff0c\u5982\u679c\u4f60\u4e0d\u662f\u5728\u8fdb\u884cCPU\u786c\u4ef6\u8bbe\u8ba1\uff0c\u90a3\u4e48\u5efa\u8bae\u4f60\u5c3d\u91cf\u8bb0\u4f4f\u5e76\u591a\u4f7f\u7528\u6c47\u7f16\u4f2a\u6307\u4ee4<code>li.w</code>\u3002</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca li.w (load immediate word) li.w $rx, imm32 GR[x] = imm32 <p>\u4f5c\u4e3a\u4e00\u6761\u4f2a\u6307\u4ee4\uff0c\u6c47\u7f16\u5668\u4f1a\u6839\u636eimmediate\u6570\u503c\u7684\u8303\u56f4\u81ea\u52a8\u751f\u6210\u4e00\u6761\u6307\u4ee4\u6216\u4e24\u6761\u6307\u4ee4\u7684\u5e8f\u5217\u3002\u6c47\u7f16\u5668\u5177\u4f53\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u611f\u5174\u8da3\u7684\u53ef\u4ee5\u81ea\u5df1\u5199\u4e2a\u6c47\u7f16\u7a0b\u5e8f\u7f16\u8bd1\u540e\u518d\u53cd\u6c47\u7f16\u770b\u4e00\u4e0b\u3002</p> <p><code>li.w</code>\u4f2a\u6307\u4ee4\u7684\u7acb\u5373\u6570immediate\u7684\u5408\u6cd5\u53d6\u503c\u8303\u56f4\u662f[-231, 232-1]\uff0c\u8fd9\u4e2a\u8303\u56f4\u91cc\u9762\u4e0a\u754c\u7684\u6307\u6570\u662f32\uff0c\u4e0d\u662f\u7b14\u8bef\u3002\u6c47\u7f16\u5668\u7684\u8fd9\u4e2a\u8bbe\u8ba1\u8003\u8651\u5230\u4e86\u5927\u5bb6\u7684\u65e5\u5e38\u4f7f\u7528\u4e60\u60ef\uff0c\u6bd5\u7adf\u5f53\u4f60\u60f3\u88c5\u8f7d\u4e00\u4e2a\u7b2c31\u4f4d\u7b49\u4e8e1\u7684\u4e8c\u8fdb\u5236\u6570\u65f6\uff08\u4f8b\u5982\u4e00\u4e2aIO\u8bbe\u5907\u5bc4\u5b58\u5668\u7684\u5199\u63a9\u7801\uff09\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5199\u8fd9\u4e2a\u7acb\u5373\u6570\u800c\u4e0d\u7528\u7b97\u51fa\u5b83\u7684\u8d1f\u6570\u3002\u8b6c\u5982\uff0c\u4f60\u53ef\u4ee5\u76f4\u63a5\u5199<code>li.w $t0, 0xfefca147</code>\uff0c\u800c\u4e0d\u7528\u5199\u6210<code>li.w $t0, -0x1035eb9</code>\u3002</p>"},{"location":"instructions/ldst_instrs/#_3","title":"\u5bc4\u5b58\u5668\u95f4\u7684\u4f20\u8f93\u6570\u636e","text":"<p>LA32R\u4e2d\u53ef\u4ee5\u7528\u4f2a\u6307\u4ee4<code>move</code>\u6765\u5b8c\u6210\u5bc4\u5b58\u5668\u95f4\u7684\u6570\u636e\u4f20\u8f93\u3002</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca move (move) move $rx, $ry GR[x] = GR[y]"},{"location":"instructions/ldst_instrs/#_4","title":"\u5728\u5bc4\u5b58\u5668\u548c\u5185\u5b58\u4e4b\u95f4\u4f20\u8f93\u6570\u636e","text":"<p>RISC\u578b\u6307\u4ee4\u96c6\u4ec5\u901a\u8fc7load/store\u6307\u4ee4\u5728\u5bc4\u5b58\u5668\u548c\u5185\u5b58\u4e4b\u95f4\u4f20\u8f93\u6570\u636e\u3002LA32R\u4e2d\u666e\u901a1\u7684load/store\u6307\u4ee4\u5982\u4e0b\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca ld.b (load byte signed) ld.b $rx, $ry, si12 GR[x] = sext32(MEM[GR[y] + sext32(si12)][7:0]) ld.bu (load byte unsigned) ld.bu $rx, $ry, si12 GR[x] = zext32(MEM[GR[y] + sext32(si12)][7:0]) ld.h (load halfword signed) ld.h $rx, $ry, si12 GR[x] = sext32(MEM[GR[y] + sext32(si12)][15:0]) ld.hu (load halfword unsigned) ld.hu $rx, $ry, si12 GR[x] = zext32(MEM[GR[y] + sext32(si12)][15:0]) ld.w (load word signed) ld.w $rx, $ry, si12 GR[x] = MEM[GR[y] + sext32(si12)][31:0] st.b (store byte) st.b $rx, $ry, si12 MEM[GR[y] + sext32(si12)][7:0] = GR[x][7:0] st.h (store halfword) st.h $rx, $ry, si12 MEM[GR[y] + sext32(si12)][15:0] = GR[x][15:0] st.w (store word) st.w $rx, $ry, si12 MEM[GR[y] + sext32(si12)][31:0] = GR[x]"},{"location":"instructions/ldst_instrs/#loadstore","title":"\u5b57\u8282\u548c\u534a\u5b57load/store\u6307\u4ee4","text":"<p>\u6307\u4ee4\u96c6\u4e2d\u5b9a\u4e49\u5b57\u8282\u548c\u534a\u5b57load/store\u6307\u4ee4\u7684\u76ee\u7684\u4e3b\u8981\u6709\u4e24\u4e2a\u3002\u7b2c\u4e00\u4e2a\u76ee\u7684\u662f\u4e3a\u4e86CPU\u8bbf\u95ee\u4e00\u4e9b\u53ea\u80fd\u63a5\u6536\u5b57\u8282\u6216\u534a\u5b57\u4f4d\u5bbd\u8bbf\u95ee\u7684\u8bbe\u5907\u3002\u50cfLA32R\u8fd9\u7c7bRISC\u6307\u4ee4\u57fa\u672c\u4e0a\u90fd\u91c7\u7528\u7684\u662fMemory Mapped I/O\u7684\u65b9\u5f0f\u6765\u8bbf\u95ee\u5916\u8bbe\u76842\uff0c\u5982\u679c\u4e0d\u901a\u8fc7load\u6307\u4ee4\u7684\u7c7b\u578b\u6765\u533a\u5206\u8bbf\u95ee\u4f4d\u5bbd\uff0c\u5c31\u65e0\u6cd5\u8bbf\u95ee\u53ea\u80fd\u63a5\u6536\u5b57\u8282\u6216\u534a\u5b57\u4f4d\u5bbd\u8bbf\u95ee\u7684\u8bbe\u5907\u3002\u7b2c\u4e8c\u4e2a\u76ee\u7684\u662f\u4e3a\u4e86\u52a0\u901f\u4ece\u5185\u5b58\u88c5\u8f7dchar\u578b\u3001short\u578b\u6570\u636e\uff0c\u5426\u5219\u5c31\u53ea\u80fd\u4ece\u5185\u5b58\u88c5\u8f7d\u4e00\u4e2a\u5b57\u5230\u5bc4\u5b58\u5668\uff0c\u7136\u540e\u518d\u5229\u7528\u79fb\u4f4d\u7b49\u64cd\u4f5c\u63d0\u53d6\u51fa\u6240\u9700\u7684\u6570\u636e\uff0c\u5373\u9700\u8981\u7528\u82b1\u8d39\u6570\u6761\u6307\u4ee4\u624d\u80fd\u5b8c\u6210\u5355\u6761\u5b57\u8282\u3001\u534a\u5b57load\u6307\u4ee4\u5c31\u53ef\u5b8c\u6210\u7684\u529f\u80fd\u3002</p> <p>\u5b57\u8282\u548c\u534a\u5b57\u7684load\u6307\u4ee4\u90fd\u6709singed\u548cunsigned\u4e24\u4e2a\uff0c\u662f\u4e3a\u4e86\u9002\u5e94char\u548cunsigned char\u3001short\u548cunsigned short\u4e0d\u540c\u6570\u636e\u7c7b\u578b\u7684\u8bbf\u95ee\u5bf9\u8c61\u3002\u6307\u4ee4\u96c6\u8fd9\u6837\u8bbe\u8ba1\u662f\u4ece\u6027\u80fd\u4f18\u5316\u7684\u76ee\u7684\u6765\u8003\u8651\u7684\u3002\u5426\u5219\uff0c\u53ea\u5b9a\u4e49\u6709\u7b26\u53f7\u6269\u5c55\u7684\u6216\u8005\u65e0\u7b26\u53f7\u6269\u5c55\u7684\u5b57\u8282\u3001\u534a\u5b57load\u6307\u4ee4\uff0c\u518d\u5bf9\u53d6\u56de\u5230\u5bc4\u5b58\u5668\u4e2d\u7684\u6570\u636e\u6309\u7167\u9700\u6c42\u7528\u6307\u4ee4\u5b8c\u6210\u76f8\u5e94\u7684\u7b26\u53f7\u6269\u5c55\uff0c\u6280\u672f\u4e0a\u4e5f\u662f\u53ef\u884c\u7684\uff0c\u53ea\u4e0d\u8fc7\u6709\u7684\u60c5\u51b5\u4f1a\u591a\u751f\u6210\u4e00\u4e9b\u7528\u4e8e\u7b26\u53f7\u6269\u5c55\u7684\u8fd0\u7b97\u7c7b\u6307\u4ee4\uff0c\u5f71\u54cd\u6027\u80fd\u7f62\u4e86\u3002</p> <p>TODO\uff1a\u5bf9\u4e8e\u63a5\u89e6\u786c\u4ef6\u6bd4\u8f83\u5c11\u7684\u8bfb\u8005\u6765\u8bf4\uff0cMemory Mapped I/O\u53ef\u80fd\u6709\u70b9\u96be\u4ee5\u7406\u89e3\uff0c\u4e0d\u8fc7\u6682\u65f6\u4e0d\u77e5\u9053\u63a8\u8350\u4ec0\u4e48\u53c2\u8003\u6750\u6599\u5408\u9002\u3002</p>"},{"location":"instructions/ldst_instrs/#loadstore_1","title":"\u6c47\u7f16\u7a0b\u5e8f\u4e2dload/store\u6307\u4ee4\u5730\u5740\u7684\u8ba1\u7b97","text":"<p>\u8fd9\u4e00\u5c0f\u8282\u6211\u4eec\u5e76\u4e0d\u662f\u8981\u590d\u4e60load/store\u6307\u4ee4\u91c7\u7528\u201c\u5bc4\u5b58\u5668\u57fa\u5740+\u7acb\u5373\u6570\u504f\u79fb\u201d\u5bfb\u5740\u65b9\u5f0f\u8fd9\u4e2a\u77e5\u8bc6\u70b9\u3002\u6211\u4eec\u4e3b\u8981\u662f\u60f3\u8ba8\u8bba\u6c47\u7f16\u7f16\u7a0b\u65f6load/store\u6307\u4ee4\u57fa\u5740\u5bc4\u5b58\u5668\u548c\u504f\u79fb\u91cf\u5404\u81ea\u5982\u4f55\u8ba1\u7b97\u3002</p> <p>\u6c47\u7f16\u4e2dload/store\u6307\u4ee4\u8bbf\u95ee\u7684\u5730\u5740\uff0c\u7edd\u5927\u591a\u6570\u53ef\u4ee5\u770b\u4f5c\u662fC\u8bed\u8a00\u4e2d\u53d8\u91cf\u7684\u5730\u5740\u3002\u6211\u4eec\u77e5\u9053C\u8bed\u8a00\u4e2d\u6709\u52a8\u6001\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf\u3002\u8fd9\u4e24\u7c7b\u53d8\u91cf\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u5904\u5728\u4e0d\u540c\u7684\u5185\u5b58\u533a\u57df\uff0c\u5176\u4e2d\u52a8\u6001\u53d8\u91cf\u5206\u914d\u5728\u6808\u548c\u5806\u4e0a\uff0c\u800c\u4f4d\u4e8eData\u6bb5\u548cBSS\u6bb5\u7684\u9759\u6001\u53d8\u91cf\u5219\u88ab\u7cfb\u7edf\u5206\u914d\u5728\u5176\u5b83\u5185\u5b58\u533a\u57df\u3002\u6211\u4eec\u63a5\u4e0b\u6765\u5c06\u6309\u7167\u52a8\u6001\u53d8\u91cf\u548c\u9759\u6001\u53d8\u91cf\u4e24\u79cd\u7c7b\u578b\u505a\u8fdb\u4e00\u6b65\u8ba8\u8bba\u3002\u5982\u679c\u60f3\u8fdb\u4e00\u6b65\u4e86\u89e3\u4e0d\u540c\u7c7b\u578b\u53d8\u91cf\u6240\u5728\u5185\u5b58\u533a\u57df\u5177\u4f53\u5982\u4f55\u5212\u5206\u548c\u7ba1\u7406\uff0c\u53ef\u4ee5\u9605\u8bfb\u672c\u624b\u518c\u7b2c2\u90e8\u5206\u5173\u4e8eLinux/LA32R\u7cfb\u7edf\u4e0b\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u5212\u5206\u7684\u4ecb\u7ecd\u5185\u5bb9\u3002</p>"},{"location":"instructions/ldst_instrs/#_5","title":"\u52a8\u6001\u53d8\u91cf\u7684\u5730\u5740\u7684\u8ba1\u7b97","text":"<p>\u5806\u4e0a\u6570\u636e\u7684\u5206\u914d\u548c\u91ca\u653e\uff0c\u5168\u90e8\u7531\u7a0b\u5e8f\u5458\u81ea\u884c\u5b8c\u6210\uff0c\u5373\u5806\u4e0a\u7684\u52a8\u6001\u53d8\u91cfload/store\u7684\u5730\u5740\u5b8c\u5168\u662f\u7531\u4f60\u81ea\u5df1\u6765\u5b9a\u7684\uff0c\u53ea\u8981\u4f60\u80fd\u786e\u4fdd\u5806\u4e0a\u6bcf\u4e2a\u53d8\u91cf\u6240\u7528\u7684\u5730\u5740\uff1a\uff081\uff09\u88c5\u8f7d\u540e\u4f4d\u4e8e\u5185\u5b58\u4e2d\u7ed9\u5806\u5206\u914d\u7684\u533a\u57df\uff0c\u5373\u4e0d\u4f1a\u4fb5\u5165\u5230\u6808\u7a7a\u95f4\u6216\u5176\u5b83\u4ee3\u7801\u3001\u6570\u636e\u7a7a\u95f4\uff1b\uff082\uff09\u4e0d\u4f1a\u548c\u5806\u4e0a\u5176\u5b83\u53d8\u91cf\u7684\u5730\u5740\u51b2\u7a81\u3002\u8fd9\u4e24\u70b9\u8981\u6c42\u5728Linux\u8fd9\u6837\u7684\u7cfb\u7edf\u4e0a\u968f\u7740\u4f60\u6240\u8c03\u8bd5\u7684\u5e94\u7528\u89c4\u6a21\u589e\u5927\u5c06\u53d8\u5f97\u5f88\u6709\u96be\u5ea6\uff0c\u6240\u4ee5\u9664\u975e\u662f\u4e00\u4e9b\u5d4c\u5165\u5f0f\u5e94\u7528\u573a\u666f\u4e0b\u7a0b\u5e8f\u76f4\u63a5\u8fd0\u884c\u5728\u88f8\u91d1\u5c5e\uff08baremetal\uff09\u6267\u884c\u73af\u5883\u4e2d\uff0c\u6211\u4eec\u4e0d\u5efa\u8bae\u5927\u5bb6\u5728\u6c47\u7f16\u4e0b\u64cd\u4f5c\u5806\u4e0a\u7684\u52a8\u6001\u53d8\u91cf\u3002</p> <p>\u5b58\u653e\u5728\u6808\u7a7a\u95f4\u4e0a\u7684\u52a8\u6001\u53d8\u91cf\uff0c\u5176load/store\u7684\u57fa\u5740\u5bc4\u5b58\u5668\u901a\u5e38\u5c31\u91c7\u7528\u6808\u6307\u9488\u5bc4\u5b58\u5668\uff08<code>$sp</code>\uff09\u6216\u5e27\u6307\u9488\u5bc4\u5b58\u5668\uff08<code>$fp</code>\uff09\uff0c\u5373\u4f7f\u4f60\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u800c\u53e6\u9009\u5176\u5b83\u5bc4\u5b58\u5668\u505a\u57fa\u5740\u5bc4\u5b58\u5668\uff0c\u6240\u7528\u7684\u57fa\u5740\u5bc4\u5b58\u5668\u7684\u503c\u4e5f\u662f\u9700\u8981\u4ece\u8fd9\u4e24\u4e2a\u5bc4\u5b58\u5668\uff08\u4e4b\u4e00\uff09\u4e2d\u63a8\u7b97\u51fa\u6765\u7684\u3002\u7f16\u7a0b\u4e2d\u9700\u8981\u91cd\u70b9\u6ce8\u610f\u7684\u5730\u65b9\u662f\uff0c\u56e0\u4e3a<code>$sp</code>\u548c<code>$fp</code>\u6307\u5411\u7684\u4f4d\u7f6e\u5728\u7a0b\u5e8f\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u53d8\u5316\uff0c\u6240\u4ee5\u7f16\u7a0b\u4eba\u5458\u5fc5\u987b\u6e05\u695a\u5f53\u8fd9\u6761load/store\u6307\u4ee4\u6267\u884c\u65f6\uff0c\u5176\u8bbf\u95ee\u53d8\u91cf\u7684\u5730\u5740\u4e0e\u6b64\u65f6<code>$sp</code>\u6216<code>$fp</code>\u7684\u5177\u4f53\u76f8\u5bf9\u4f4d\u7f6e\uff0c\u5bf9\u5e94\u5230\u6307\u4ee4\u4e2d\u5c31\u662f\u7acb\u5373\u6570\u504f\u79fb\u91cf\u7684\u503c\u3002</p>"},{"location":"instructions/ldst_instrs/#_6","title":"\u9759\u6001\u53d8\u91cf\u7684\u5730\u5740\u7684\u786e\u5b9a","text":"<p>\u9759\u6001\u53d8\u91cf\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u7684\u5730\u5740\uff0c\u4e0e\u94fe\u63a5\u548c\u88c5\u8f7d\u4e24\u4e2a\u73af\u8282\u6709\u5173\u3002\u4e3a\u4e86\u907f\u514d\u53d7\u5230\u88c5\u8f7d\u8fc7\u7a0b\u4e2d\u6570\u636e\u6bb5\u5177\u4f53\u88ab\u88c5\u8f7d\u5230\u4ec0\u4e48\u5730\u5740\u8fd9\u4e00\u8fd0\u884c\u65f6\u624d\u80fd\u786e\u5b9a\u7684\u56e0\u7d20\u7684\u5f71\u54cd\uff0c\u6211\u4eec\u5f3a\u70c8\u5efa\u8bae\u8bbf\u95ee\u9759\u6001\u53d8\u91cf\u7684\u5bfb\u5740\u91c7\u7528\u4f4d\u7f6e\u65e0\u5173\u4ee3\u7801\uff08Position Independent Code, \u7b80\u79f0PIC\uff09\u7684\u98ce\u683c\u3002\u5728LA32R\u6240\u7528\u7684ABI\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u901a\u8fc7\u76f8\u5bf9\u6307\u4ee4PC\u5bfb\u5740\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u4f4d\u7f6e\u65e0\u5173\u7684\u5bfb\u5740\u3002\u5bf9\u5e94\u5230\u6c47\u7f16\u5f00\u53d1\u4e2d\uff0c\u5219\u662f\u5229\u7528\u4f2a\u6307\u4ee4<code>la.local</code>\u6765\u83b7\u53d6\u5730\u5740\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u6240\u5217C\u4ee3\u7801\u548c\u6c47\u7f16\u4ee3\u7801\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u6765\u770b\u4e00\u4e0b<code>la.local</code>\u7684\u5177\u4f53\u4f7f\u7528\u65b9\u6cd5\u3002</p> <pre><code>int data_var_a = 1, data_var_b = 2;\nint bss_var_c;\nint foo() {\nbss_var_c = data_var_a + data_var_b;\nreturn 0;\n}\n</code></pre> <pre><code>    .data\ndata_var_a:     .word   1\ndata_var_b:     .word   2\n.bss\nbss_var_c:      .skip   4\n.text\n......\nla.local    $t0, data_var_a         #\u83b7\u53d6data_var_a\u7684\u5730\u5740\nld.w        $t1, $t0, 0             #\u53d6\u56dedata_var_a\u7684\u503c\nla.local    $t0, data_var_b         #\u83b7\u53d6data_var_b\u7684\u5730\u5740\nld.w        $t2, $t0, 0             #\u53d6\u56dedata_var_b\u7684\u503c\nadd.w       $t3, $t1, $t2           #data_var_a+data_var_b\nla.local    $t0, bss_var_c          #\u53d6\u56debss_var_c\u7684\u5730\u5740\nst.w        $t3, $t0, 0             #\u7ed3\u679c\u5199\u5165bss_var_c\u4e2d\n......\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d<code>la.local $t0, data_var_a</code>\u8fd9\u6761\u4f2a\u6307\u4ee4\u4f1a\u88ab\u6c47\u7f16\u5668\u7ffb\u8bd1\u6210\u5982\u4e0b\u7684\u4e24\u6761\u6307\u4ee4\uff1a</p> <pre><code>    pcaddu12i   $t0, pcrel(adr(data_var_a)+0x800)&lt;&lt;32&gt;&gt;44;\naddi.w      $t0, $t0, pcrel(adr(data_var_a)+4)-(pcrel(adr(data_var_a)+4+0x800)&gt;&gt;12&lt;&lt;12);\n</code></pre> <p>\u4e0a\u9762\u7684\u8868\u8fbe\u5f0f\u4e2d\uff0cadr(L)\u8868\u793a\u94fe\u63a5\u540e\u6807\u7b7eL\u7684\u5730\u5740\uff0cpcrel(A)\u8868\u793a\u5730\u5740A\u76f8\u5bf9\u4e8e\u8fd9\u6761\u6307\u4ee4PC\u7684\u504f\u79fb\u91cf\u3002<code>pcaddu12i</code>\u6307\u4ee4\u7684\u901f\u67e5\u5185\u5bb9\u5982\u4e0b\uff1a</p> \u6307\u4ee4 \u6c47\u7f16\u8868\u8fbe \u529f\u80fd\u7b80\u91ca pcaddu12i (pc add upper from bit12 immediate) pcaddu12i $rx, si20 GR[x] = PC + sext32(si20 &lt;&lt; 12) <p>\u53ef\u80fd\u6709\u7684\u8bfb\u8005\u5df2\u7ecf\u53d1\u73b0\u4e86\uff0c\u539f\u6709\u6c47\u7f16\u7a0b\u5e8f\u4e2d\u7684</p> <pre><code>    la.local    $t0, data_var_a         #\u83b7\u53d6data_var_a\u7684\u5730\u5740\nld.w        $t1, $t0, 0             #\u53d6\u56dedata_var_a\u7684\u503c\n</code></pre> <p>\u53ef\u4ee5\u76f4\u63a5\u7528\u5982\u4e0b\u4e24\u6761\u6307\u4ee4\u4ee3\u66ff\uff1a</p> <pre><code>    pcaddu12i   $t0, pcrel(adr(data_var_a)+0x800)&lt;&lt;32&gt;&gt;44;\nld.w        $t1, $t0, pcrel(adr(data_var_a)+4)-(pcrel(adr(data_var_a)+4+0x800)&gt;&gt;12&lt;&lt;12);\n</code></pre> <p>\u4e0d\u8fc7\uff0c\u7531\u4e8e\u76ee\u524dLA32R\u7684\u6c47\u7f16\u5668\u8fd8\u4e0d\u652f\u6301\u5f62\u5982<code>ld.w.local $t1, data_var_a</code>\u8fd9\u6837\u7684\u4f2a\u6307\u4ee4\uff0c\u6240\u4ee5\u8fd8\u65e0\u6cd5\u5728\u6c47\u7f16\u5f00\u53d1\u65f6\u83b7\u5f97\u4e0a\u8ff0\u7684\u9ad8\u6548\u4ee3\u7801\u3002</p> <p>\u65e2\u7136\u6709<code>la.local</code>\u8fd9\u6837\u7684\u4f2a\u6307\u4ee4\uff0c\u90a3\u4e48\u6709\u6ca1\u6709<code>la.global</code>\u8fd9\u6837\u7684\u4f2a\u6307\u4ee4\u5462\uff1f\u7b54\u6848\u662f\u6709\u7684\u3002\u4e0d\u8fc7\uff0cLA32R\u7684\u5de5\u5177\u94fe\u5bf9\u4e8e<code>la.global</code>\u4f2a\u6307\u4ee4\u5c55\u5f00\u7684\u4f4d\u7f6e\u65e0\u5173\u5bfb\u5740\u6307\u4ee4\u5e8f\u5217\u662f\u57fa\u4e8eGOT\u8868\u7684\u3002\u56e0\u4e3a\u8bbf\u95eeGOT\u8868\u9700\u8981\u4e00\u6761load\u6307\u4ee4\uff0c\u6240\u4ee5\u57fa\u4e8eGOT\u8868\u7684PIC\u5bfb\u5740\u7684\u6027\u80fd\u5f00\u9500\u901a\u5e38\u5927\u4e8e\u76f8\u5bf9\u6307\u4ee4PC\u5bfb\u5740\u65b9\u5f0f\u3002\u5728\u6ca1\u6709\u88c5\u8f7d\u5668\uff08Loader\uff09\u7684\u88f8\u91d1\u5c5e\u6267\u884c\u73af\u5883\u4e2d\u5f00\u53d1\u7a0b\u5e8f\uff0c\u5c31\u66f4\u8981\u614e\u91cd\u4f7f\u7528<code>la.global</code>\uff0c\u9664\u975e\u4f60\u80fd\u786e\u4fdd\u5728\u5176\u9700\u8981\u8bbf\u95ee\u7684GOT\u8868\u8868\u9879\u4f4d\u7f6e\u4e0a\u5df2\u5b58\u5165\u6b63\u786e\u7684\u6570\u503c\u3002<code>la.global</code>\u901a\u5e38\u7528\u6765\u52a0\u8f7d\u4f4d\u4e8e\u4e0d\u540c\u6c47\u7f16\u6587\u4ef6\u4e2d\u7684\u6807\u7b7e\u7684\u5730\u5740\u3002\u5982\u679c\u4e0d\u662f\u5341\u5206\u5fc5\u8981\uff0c\u5c3d\u91cf\u4e0d\u8981\u7528<code>la.global</code>\u3002</p> <p>\u719f\u6089MIPS\u6216RISC-V\u6c47\u7f16\u7f16\u7a0b\u7684\u8bfb\u8005\uff0c\u5e94\u8be5\u7ecf\u5e38\u7528<code>la</code>\u8fd9\u4e2a\u5b8f\u6307\u4ee4/\u4f2a\u6307\u4ee4\u3002\u8bf7\u4f60\u4eec\u5728LA32R\u4e0b\u5f00\u53d1\u6c47\u7f16\u65f6\u6ce8\u610f\u4e0d\u8981\u4e60\u60ef\u6027\u7684\u5199\u4e86<code>la</code>\u800c\u4e0d\u662f\u6211\u4eec\u63a8\u8350\u7684<code>la.local</code>\u3002\u56e0\u4e3aLA32R\u7684\u5de5\u5177\u94fe\u540c\u65f6\u4e5f\u652f\u6301<code>la</code>\u8fd9\u6761\u4f2a\u6307\u4ee4\uff08\u610f\u5473\u7f16\u8bd1\u8fc7\u7a0b\u4e0d\u4f1a\u6709\u62a5\u9519\u63d0\u9192\u4f60\u6ce8\u610f\uff09\uff0c\u4f46\u662f<code>la</code>\u662f\u4e0e<code>la.global</code>\u7b49\u4ef7\u7684\uff0c\u6240\u4ee5\u5f88\u53ef\u80fd\u4f1a\u82b1\u8d39\u4f60\u4e0d\u5c11\u65f6\u95f4\u53bbde\u51fa\u8fd9\u4e2abug\u3002</p> <ol> <li> <p>\u8fd9\u91cc\u8bf4\u666e\u901a\u662f\u4e3a\u4e86\u4e0e\u652f\u6301\u539f\u5b50\u8bbf\u5b58\u7684<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u533a\u522b\u5f00\u6765\u3002\u00a0\u21a9</p> </li> <li> <p>X86\u6307\u4ee4\u96c6\u6709\u4e13\u95e8\u7528\u4e8e\u8bbf\u95eeI/O\u7aef\u53e3\u7a7a\u95f4\u7684I/O\u6307\u4ee4\u3002\u4e0d\u8fc7\u8fd9\u5e76\u610f\u5473\u7740\u57fa\u4e8eX86\u67b6\u6784\u7684\u7cfb\u7edf\u4e2d\u4e0d\u53ef\u4ee5\u91c7\u7528Memory Mapped I/O\u65b9\u5f0f\u6765\u8fdb\u884cI/O\u8bbf\u95ee\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"instructions/llsc_instrs/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/llsc_instrs/#llsc","title":"\u7528<code>LL</code>/<code>SC</code>\u6307\u4ee4\u6784\u5efa\u57fa\u672c\u540c\u6b65\u539f\u8bed","text":"<p>\u73b0\u4ee3\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u53ef\u80fd\u540c\u65f6\u5b58\u5728\u591a\u4e2a\u8fdb\u7a0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u5185\u53c8\u53ef\u80fd\u5305\u542b\u591a\u4e2a\u540c\u65f6\u6267\u884c\u7684\u7ebf\u7a0b\u3002\u4e00\u4e2a\u7ebf\u7a0b\u6b63\u5728\u64cd\u4f5c\u7684\u6570\u636e\u5f88\u53ef\u80fd\u88ab\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee1\uff0c\u8fd9\u4e9b\u80fd\u53d1\u8d77\u5e76\u53d1\u8bbf\u95ee\u7684\u7ebf\u7a0b\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u79cd\u6765\u6e90\uff1a</p> <ol> <li>\u591a\u5904\u7406\u5668\u7cfb\u7edf\u4e2d\uff0c\u53e6\u4e00\u4e2a\u5904\u7406\u5668\u6838\u4e0a\u8fd0\u884c\u7684\u7ebf\u7a0b\uff1b</li> <li>\u540c\u4e00\u4e2a\u5904\u7406\u5668\u6838\u4e0a\uff0c\u5f53\u524d\u8fd0\u884c\u7684\u7ebf\u7a0b\u9047\u5230\u4e2d\u65ad\uff0c\u5728\u4e2d\u65ad\u5904\u7406\u4e0a\u4e0b\u6587\u4e2d\u7684\u7ebf\u7a0b\uff1b</li> <li>\u540c\u4e00\u4e2a\u5904\u7406\u5668\u6838\u4e0a\uff0c\u5728\u4e2d\u65ad\u5904\u7406\u540e\u56e0\u4e3a\u62a2\u5360\u8c03\u5ea6\u800c\u6267\u884c\u7684\u5176\u5b83\u7ebf\u7a0b\u3002</li> </ol> <p>\u5f53\u540c\u4e00\u4e2a\u6570\u636e\u88ab\u591a\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u8bbf\u95ee\u65f6\uff0c\u5c31\u53ef\u80fd\u51fa\u73b0\u6570\u636e\u7ade\u4e89\u5192\u9669\u3002\u4e3a\u4e86\u4fdd\u8bc1\u5e76\u53d1\u6570\u636e\u8bbf\u95ee\u7684\u6b63\u786e\u6027\uff0c\u9700\u8981\u5f15\u5165\u540c\u6b65\u548c\u901a\u4fe1\u673a\u5236\u3002\u901a\u5e38\u7528\u6237\u7a0b\u5e8f\u5f00\u53d1\u8005\u4f7f\u7528\u7cfb\u7edf\uff08\u8f6f\u4ef6\uff09\u63d0\u4f9b\u7684\u540c\u6b65\u539f\u8bed\u6765\u5b9e\u73b0\u540c\u6b65\u673a\u5236\u3002\u6211\u4eec\u8fd9\u91cc\u53ea\u8ba8\u8bba\u7ecf\u5178\u7684\u4e92\u65a5\u540c\u6b65\u673a\u5236\u3002\u8fd9\u79cd\u540c\u6b65\u673a\u5236\u6240\u7528\u5230\u7684\u540c\u6b65\u539f\u8bed\uff0c\u5176\u9ad8\u6548\u5b9e\u73b0\u7684\u5173\u952e\u662f\u5229\u7528\u5904\u7406\u5668\u786c\u4ef6\u63d0\u4f9b\u7684\u539f\u5b50\u8bbf\u5b58\u786c\u4ef6\u539f\u8bed\uff0c\u5373\u4ee5\u539f\u5b50\u65b9\u5f0f\u8bfb\u53d6\u5e76\u4fee\u6539\u5185\u5b58\u5355\u5143\u7684\u529f\u80fd\u3002LA32R\u4e2d\u662f\u91c7\u7528<code>ll.w</code>/<code>sc.w</code>\u6307\u4ee4\u5bf9\u6765\u652f\u6301\u5b9e\u73b0\u539f\u5b50\u8bbf\u5b58\u786c\u4ef6\u539f\u8bed\u3002\u4e0b\u9762\u6211\u4eec\u4ee5Linux\u4e2datomic_add_return()\u540c\u6b65\u539f\u8bed\u7684\u5b9e\u73b0\u6765\u589e\u52a0\u4e00\u4e9b\u76f4\u89c2\u7684\u8ba4\u8bc6\u3002</p> <pre><code>atomic_add_return:\nll.w    $t0, $a1, 0\nadd.w   $t1, $t0, $a0\nsc.w    $t1, $a1, 0\nbeq     $t1, $zero, atomic_add_return\nadd.w   $a0, $t0, $a0\njr      $ra\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u7684\u6838\u5fc3\u90e8\u5206\u662f\u524d4\u884c\u6784\u6210\u7684\u5faa\u73af\u4f53\u3002\u5176\u4e2d\u524d3\u6761\u6784\u6210\u4e00\u4e2aRead-Modify-Write(RMW)\u64cd\u4f5c\u5e8f\u5217\uff0c\u5b8c\u6210\u5411\u6307\u5b9a\u5185\u5b58\u4f4d\u7f6e\u52a0\u4e0a\u4e00\u4e2a\u503c\u7684\u529f\u80fd\u3002\u5728\u8fd9\u4e2a\u64cd\u4f5c\u5e8f\u5217\u4e2d\u4ece<code>ll.w</code>\u8bfb\u56de\u6570\u636e\u5230<code>sc.w</code>\u8bd5\u56fe\u4fee\u6539\u5185\u5b58\u671f\u95f4\uff0c\u5982\u679c\u6709\u5176\u5b83\u5904\u7406\u5668\u6838\u4e5f\u8bd5\u56fe\u4fee\u6539\u540c\u4e00\u5185\u5b58\u4f4d\u7f6e\uff0c\u6216\u8005\u5f53\u524d\u5904\u7406\u5668\u6838\u56e0\u4e2d\u65ad\u6216\u5176\u5b83\u539f\u56e0\u9677\u5165\u5f02\u5e38\u5904\u7406\u4e86\uff0c\u90a3\u4e48<code>sc.w</code>\u4e0d\u4f1a\u6267\u884c\u4fee\u6539\u5185\u5b58\u7684\u52a8\u4f5c\uff0c\u540c\u65f6\u5176\u5411<code>$t1</code>\u5199\u5165\u503c0\uff0c\u8868\u793a\u672a\u80fd\u6210\u529f\u5730\u5b8c\u6210\u539f\u5b50\u4fee\u6539\u3002\u90a3\u4e48<code>beq  $t1, $zero, atomic_add_return</code>\u6307\u4ee4\u5c31\u4f1a\u56de\u8df3\u81f3<code>atomic_add_return</code>\u6807\u53f7\u5904\u7ee7\u7eed\u6267\u884c\u8fd9\u4e2a\u5faa\u73af\uff0c\u76f4\u81f3\u5185\u5b58\u7684\u539f\u5b50\u4fee\u6539\u6210\u529f\u5b8c\u6210\u65b9\u624d\u9000\u51fa\u3002</p> <p>\u5982\u679c\u8bfb\u8005\u5bf9\u5176\u5b83\u540c\u6b65\u539f\u8bed\u7684\u5b9e\u73b0\u4e5f\u60f3\u4e86\u89e3\u4e00\u4e0b\uff0c\u53ef\u4ee5\u67e5\u770b\u5185\u6838\u6e90\u7801\u4e2d<code>arch/loongarch/include/asm/atomic.h</code>\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <p>\u901a\u5e38\u7684\u4f7f\u7528\u65b9\u5f0f\u662f\u7528\u4e00\u5bf9\u8bbf\u95ee\u540c\u4e00\u5730\u5740\u7684<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u6784\u6210\u5bf9\u4e8e\u8be5\u5730\u5740\u7684\u539f\u5b50\u8bbf\u5b58\u3002\u8fd9\u4e24\u6761\u6307\u4ee4\u4e4b\u95f4\u7684\u867d\u7136\u53ef\u4ee5\u63d2\u5165\u5176\u5b83\u6307\u4ee4\uff0c\u4f46\u662f\u8981\u63a7\u5236\u63d2\u5165\u6307\u4ee4\u7684\u6570\u76ee\uff0c\u4f7f\u5f97<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u5bf9\u6240\u5728\u7684\u5faa\u73af\u4f53\u7684\u53d6\u6307\u884c\u4e3a\u5c3d\u91cf\u7b80\u5355\u3002<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u5bf9\u4e4b\u95f4\u7684\u6307\u4ee4\u4e2d\u5c3d\u91cf\u4e0d\u8981\u51fa\u73b0\u8bbf\u5b58\u6307\u4ee4\uff0c\u9664\u975e\u7a0b\u5e8f\u8bbe\u8ba1\u4eba\u5458\u80fd\u5426\u786e\u4fdd\u6267\u884c\u8fc7\u7a0b\u4e2d\u4e0d\u4f1a\u56e0\u4e3aCache\u66ff\u6362\u3001\u9875\u8868\u7f3a\u5931\u7b49\u539f\u56e0\u5bfc\u81f4<code>sc.w</code>\u603b\u662f\uff08\u6216\u6781\u5927\u6982\u7387\uff09\u4e0d\u6210\u529f\uff0c\u9020\u6210\u51fa\u73b0\u6b7b\u9501\uff08\u6216\u6d3b\u9501\uff09\u3002<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u5bf9\u7684\u5d4c\u5957\u4f7f\u7528\u662f\u5f3a\u70c8\u7981\u6b62\u7684\uff0c\u56e0\u4e3a\u4e00\u4e2a\u5904\u7406\u5668\u6838\u4e0a\u53ea\u80fd\u5904\u7406\u4e00\u4e2a\u6d3b\u8dc3\u7684RMW\u64cd\u4f5c\u5e8f\u5217\uff0c\u6240\u4ee5\u4e25\u683c\u6765\u8bf4\u975e\u6700\u5185\u5c42\u7684<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u5bf9\u7684<code>sc.w</code>\u6307\u4ee4\u4e00\u5b9a\u6267\u884c\u5931\u8d25\uff0c\u8fd9\u79cd\u4ee3\u7801\u4e0d\u4ec5\u65e0\u610f\u4e49\u800c\u4e14\u6781\u6613\u6784\u6210\u6b7b\u9501\u3002\u81f3\u4e8e\u8bf4<code>ll.w</code>\u548c<code>sc.w</code>\u7684\u5d4c\u5957\u4e14\u4ea4\u7ec7\u4f7f\u7528\uff0c\u5373\u5f62\u5982<code>ll.w A - ll.w B - sc.w A - sc.w B</code>\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u6240\u6709\u7684<code>sc.w</code>\u6307\u4ee4\u90fd\u4e0d\u4f1a\u6210\u529f\uff0c\u662f\u66f4\u52a0\u65e0\u610f\u4e49\u7684\u4ee3\u7801\u3002</p> <p>\u4ece\u6307\u4ee4\u96c6\u89c4\u8303\u6765\u770b\uff0c<code>ll.w</code>\u6307\u4ee4\u53ef\u4ee5\u540e\u9762\u4e0d\u8ddf\u7740\u914d\u5bf9\u7684<code>sc.w</code>\u6307\u4ee4\u5355\u72ec\u4f7f\u7528\uff0c\u4f46\u662f\u4f5c\u8005\u81ea\u5df1\u5c1a\u672a\u770b\u5230\u8fd9\u6837\u4f7f\u7528\u7684\u573a\u666f\u3002<code>sc.w</code>\u6307\u4ee4\u8981\u60f3\u6709\u53ef\u80fd\u6210\u529f\u5b8c\u6210\uff0c\u5219\u4e00\u5b9a\u8981\u914d\u5408\u4e00\u4e2a\u8bbf\u95ee\u76f8\u540c\u5730\u5740\u7684<code>ll.w</code>\u6307\u4ee4\u3002</p> <p>\u6700\u540e\u518d\u6b21\u544a\u8beb\u521d\u5b66\u8005\uff0c\u5982\u679c\u5fc5\u987b\u7528<code>ll.w</code>\u548c<code>sc.w</code>\u6307\u4ee4\u76f4\u63a5\u5f00\u53d1\u6c47\u7f16\u4ee3\u7801\uff0c\u6700\u597d\u65b9\u5f0f\u5c31\u662f\u53c2\u8003\u5185\u6838\u6216C\u5e93\u4e2d\u5df2\u6709\u7684\u5404\u7c7b\u540c\u6b65\u539f\u8bed\u7684\u6210\u719f\u5b9e\u73b0\u201c\u4f9d\u6837\u753b\u846b\u82a6\u201d\uff0c\u80fd\u591f\u6700\u5927\u7a0b\u5ea6\u7684\u89c4\u907f\u9519\u8bef\u3002</p> <ol> <li> <p>\u7279\u522b\u662f\u6709\u4fee\u6539\u884c\u4e3a\u7684\u8bbf\u95ee\u3002\u00a0\u21a9</p> </li> </ol>"},{"location":"instructions/misc_instrs/","title":"LA32R\u4e2d\u7684\u7528\u6237\u6001\u6574\u578b\u6307\u4ee4","text":""},{"location":"instructions/misc_instrs/#_1","title":"\u5176\u5b83\u7528\u6237\u6001\u6307\u4ee4","text":""},{"location":"instructions/misc_instrs/#_2","title":"\u6570\u636e\u6805\u969c\u6307\u4ee4","text":"<p>\u9996\u5148\u8981\u8bf4\u660e\u4e00\u4e0b\uff0cLA32R\u4e2d\u7684\u6570\u636e\u6805\u969c\u6307\u4ee4\u867d\u7136\u6709\u201c\u6805\u969c\uff08barrier\uff09\u201d\u7684\u5b57\u773c\uff0c\u5e76\u4e0d\u610f\u5473\u7740\u5355\u72ec\u7528\u8fd9\u4e2a\u6307\u4ee4\u5c31\u80fd\u5b9e\u73b0\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u6216\u5404\u79cd\u652f\u6301\u591a\u7ebf\u7a0b\u6267\u884c\u7684\u5e93\u4e2d\u7684\u8bbf\u5b58\u6805\u969c\uff08memory barrier\uff09\u539f\u8bed\u3002\u8bbf\u5b58\u6805\u969c\u539f\u8bed\u901a\u5e38\u662f\u9488\u5bf9\u4e00\u4e2a\u591a\u5904\u7406\u5668\u7cfb\u7edf\u7684\u540c\u6b65\u95ee\u9898\u7684\uff0c\u800c\u6570\u636e\u6805\u969c\u6307\u4ee4<code>dbar</code>\u53ea\u662f\u7528\u6765\u5bf9\u5355\u4e2a\u5904\u7406\u5668\u6838\u4e0aload/store\u6307\u4ee4\u5f15\u53d1\u7684\u8bbf\u5b58\u64cd\u4f5c\u5b9a\u5e8f\u7684\u3002\u8fd9\u91cc\u5b9a\u7684\u201c\u5e8f\u201d\u672c\u8d28\u4e0a\u662f\u5185\u5b58\u5e8f\uff08Memory Order\uff09\uff0c\u53ea\u4e0d\u8fc7\u4e3a\u4e86\u65b9\u4fbf\u8bfb\u8005\u7406\u89e3\uff0c\u6307\u4ee4\u96c6\u624b\u518c\u91cc\u9762\u8fd8\u662f\u7528\u6267\u884c\u7684\u89d2\u5ea6\u6765\u63cf\u8ff0<code>dbar</code>\u6307\u4ee4\u7684\u884c\u4e3a\uff0c\u4f46\u662f\u624b\u518c\u4e2d\u201c\u5f7b\u5e95\u6267\u884c\u5b8c\u6bd5\u201d\u8fd8\u662f\u8981\u5728\u5185\u5b58\u4e00\u81f4\u6027\uff08Memory Consistency\uff09\u7684\u6982\u5ff5\u4f53\u7cfb\u4e0b\u53bb\u89e3\u8bfb\u3002\u5982\u679c\u8bfb\u8005\u60f3\u5f7b\u5e95\u641e\u6e05\u695a\u4e3a\u4ec0\u4e48\u6307\u4ee4\u96c6\u8981\u5b9a\u4e49<code>dbar</code>\u6307\u4ee4\uff0c\u6050\u6015\u8fd8\u662f\u5f97\u628a\u5185\u5b58\u4e00\u81f4\u6027\u57fa\u672c\u4e86\u89e3\u4e00\u4e0b\u3002\u56ff\u4e8e\u7bc7\u5e45\uff0c\u6211\u4eec\u8fd9\u91cc\u5c31\u5bf9\u8fd9\u65b9\u9762\u7684\u7406\u8bba\u4e0d\u5c55\u5f00\u8ba8\u8bba\u4e86\uff0c\u4ec5\u4ecb\u7ecd\u4e24\u4e2a\u6700\u5e38\u89c1\u7684\u4f1a\u7528\u5230<code>dbar</code>\u6307\u4ee4\u7684\u573a\u666f\u3002</p> <p>\u573a\u666f\u4e00\u3001\u7528\u6c47\u7f16\u8bed\u8a00\u76f4\u63a5\u5f00\u53d11\u7684\u9a71\u52a8\u6d89\u53ca\u8bbe\u5907DMA\u548c\u5904\u7406\u5668\u6838\u4e4b\u95f4\u7684\u6570\u636e\u4ea4\u4e92\u3002\u4ee5\u5904\u7406\u5668\u6838\u5199DMA\u8bfb\u4e3a\u4f8b\uff0c\u5f53\u5904\u7406\u5668\u6838\u5199\u5b8c\u6570\u636e\u5e76\u7528<code>cacop</code>\u6307\u4ee42\u5c06\u7f13\u5b58\u4e2d\u7684\u6570\u636e\u5199\u56de\u81f3\u5185\u5b58\uff0c\u7136\u540e\u518d\u901a\u8fc7\u975e\u7f13\u5b58\u8bbf\u95ee\u5c5e\u6027\u7684store\u6307\u4ee4\u5199\u8bbe\u5907\u4e2d\u7684\u63a7\u5236\u5bc4\u5b58\u5668\u6765\u901a\u77e5\u5176DMA\u5f00\u59cb\u4ece\u5185\u5b58\u4e2d\u8bfb\u6570\u636e\u3002\u8f6f\u4ef6\u5982\u4f55\u4fdd\u8bc1DMA\u5f00\u59cb\u8bfb\u5185\u5b58\u7684\u65f6\u5019\uff0c\u4e4b\u524d\u4ece\u7f13\u5b58\u4e2d\u5199\u56de\u5185\u5b58\u7684\u6570\u636e\u4e00\u5b9a\u90fd\u5df2\u7ecf\u5728\u5185\u5b58\u4e2d\uff1f\u5c31\u9700\u8981\u5728<code>cacop</code>\u6307\u4ee4\uff08\u5e8f\u5217\uff09\u6267\u884c\u5b8c\u4e4b\u540e\u52a0\u4e00\u4e2a<code>dbar 0</code>\u6307\u4ee4\uff0c\u518d\u6267\u884c\u975e\u7f13\u5b58\u8bbf\u95ee\u5c5e\u6027\u7684store\u6307\u4ee4\u3002\u6709\u7684\u8bfb\u8005\u53ef\u80fd\u4f1a\u60f3\u4e0d\u660e\u767d\uff0c\u4e3a\u4ec0\u4e48DMA\u5f00\u59cb\u8bfb\u5185\u5b58\u7684\u65f6\u5019\u8fd8\u6709\u53ef\u80fd\u8bfb\u4e0d\u5230\u7f13\u5b58\u4e2d\u5199\u56de\u5185\u5b58\u3002\u660e\u767d\u8fd9\u4e2a\u9053\u7406\u8981\u4ece\u786c\u4ef6\u89d2\u5ea6\u6765\u601d\u8003\u3002\u867d\u7136\u7f13\u5b58\u6570\u636e\u5199\u56de\u5185\u5b58\u7684\u201c\u5199\u201d\u64cd\u4f5c\u548c\u5199\u8bbe\u5907\u4e2d\u7684\u63a7\u5236\u5bc4\u5b58\u5668\u7684\u201c\u5199\u201d\u64cd\u4f5c\u5728\u5904\u7406\u5668\u6838\u63a5\u53e3\u4e0a\u662f\u4e00\u5148\u4e00\u540e\u53d1\u51fa\u53bb\u7684\uff0c\u4f46\u662f\u524d\u4e00\u4e2a\u5199\u64cd\u4f5c\u7684\u76ee\u7684\u5730\u662f\u5185\u5b58\uff0c\u540e\u4e00\u4e2a\u5199\u64cd\u4f5c\u7684\u76ee\u7684\u5730\u662f\u8bbe\u5907\u63a7\u5236\u5668\uff0c\u4ece\u5904\u7406\u5668\u6838\u5230\u8fd9\u4e24\u4e2a\u4e0d\u540c\u76ee\u7684\u5730\u7684\u5199\u64cd\u4f5c\u547d\u4ee4\u6240\u8d70\u7684\u8def\u5f84\u53ef\u80fd\u4e0d\u4e00\u6837\uff0c\u53c8\u7531\u4e8e\u4e24\u6761\u8def\u5f84\u8ddd\u79bb\u6709\u8fdc\u8fd1\u4ee5\u53ca\u8def\u4e0a\u62e5\u585e\u60c5\u51b5\u4e0d\u4e00\u6837\uff0c\u5c31\u53ef\u80fd\u5bfc\u81f4\u540e\u53d1\u51fa\u7684\u5199\u64cd\u4f5c\u6bd4\u5148\u53d1\u51fa\u7684\u5199\u64cd\u4f5c\u5148\u5230\u8fbe\u76ee\u7684\u5730\uff0c\u8fdb\u800c\u5c31\u6709\u53ef\u80fd\u4f7f\u5f97DMA\u4ece\u5185\u5b58\u8bfb\u56de\u65e7\u7684\u9519\u8bef\u7684\u6570\u636e\u3002</p> <p>\u573a\u666f\u4e8c\u3001\u7528\u6c47\u7f16\u8bed\u8a00\u76f4\u63a5\u5f00\u53d1\u7684\u7528\u6237\u7a0b\u5e8f\u4e2d\u9700\u8981\u4fdd\u8bc1\u6ca1\u6709\u5730\u5740\u76f8\u51733\u7684\u8bfb\u5199\u64cd\u4f5c\u4e4b\u95f4\u7684\u987a\u5e8f\u3002\u7531\u4e8e\u6709\u7684\u5904\u7406\u5668\u5185\u90e8\u662f\u5141\u8bb8\u8bbf\u5b58\u64cd\u4f5c\u4e71\u5e8f\u53d1\u5c04\u6267\u884c\u7684\uff0c\u56e0\u6b64\u4e3a\u4e86\u5f00\u53d1\u7684\u7a0b\u5e8f\u9002\u7528\u4e8e\u4e0d\u540c\u7684\u786c\u4ef6\u5e73\u53f0\uff0c\u7a0b\u5e8f\u5458\u53ef\u4ee5\u5728\u9700\u8981\u786e\u4fdd\u6267\u884c\u987a\u5e8f\u4e0e\u9884\u671f\u4e00\u81f4\u7684\u573a\u666f\u4e0b\u4f7f\u7528<code>dbar</code>\u6307\u4ee4\u6765\u907f\u514d\u4e71\u5e8f\u6267\u884c\u5e26\u6765\u7684\u4e0d\u786e\u5b9a\u6027\u3002\u6700\u5178\u578b\u7684\u60c5\u51b5\u662f\uff0c\u5728store\u6307\u4ee4\u548cload\u6307\u4ee4\u4e4b\u95f4\u52a0<code>dbar</code>\u4ee5\u907f\u514dload\u6307\u4ee4\u8d8a\u8fc7\u5b83\u524d\u9762\u7684store\u6307\u4ee4\u63d0\u524d\u6267\u884c\u3002</p>"},{"location":"instructions/misc_instrs/#_3","title":"\u8bbf\u5b58\u53d6\u6307\u6805\u969c\u6307\u4ee4","text":"<p>LA32R\u4e2d\u7684<code>ibar</code>\u6307\u4ee4\u4e5f\u662f\u4e3a\u4e86\u7ef4\u62a4\u8bbf\u5b58\u64cd\u4f5c\u7684\u5e8f\u800c\u5b9a\u4e49\u7684\u3002\u5b83\u4e3b\u8981\u89e3\u51b3\u540c\u4e00\u4e2a\u5904\u7406\u5668\u6838\u4e0a\uff0c\u524d\u9762\u7684store\u6307\u4ee4\u7684\u5185\u5b58\u5199\u64cd\u4f5c\u4e0e\u540e\u9762\u6307\u4ee4\u53d6\u6307\u52a8\u4f5c\u4ea7\u751f\u7684\u5185\u5b58\u8bfb\u64cd\u4f5c\u4e4b\u95f4\u7684\u987a\u5e8f\uff0c\u4e0d\u4f1a\u56e0\u4e3a\u5904\u7406\u5668\u6838\u5185\u90e8\u7684\u63a8\u6d4b\u6267\u884c\u4f7f\u5f97\u53d6\u6307\u7684\u5185\u5b58\u8bfb\u64cd\u4f5c\u5148\u4e8e\u7a0b\u5e8f\u987a\u5e8f\u5728\u524d\u7684store\u6307\u4ee4\u7684\u5185\u5b58\u5199\u64cd\u4f5c\u53d1\u751f\u3002\u6216\u8bb8\u8fd9\u6837\u7684\u63cf\u8ff0\u8fd8\u6709\u70b9\u62bd\u8c61\uff0c\u90a3\u4e48\u521d\u5b66\u8005\u53ea\u9700\u8bb0\u4f4f\u81ea\u4fee\u6539\u4ee3\u7801\u8fd9\u4e2a\u5e94\u7528\u573a\u666f\u5373\u53ef\u3002\u6240\u8c13\u81ea\u4fee\u6539\u4ee3\u7801\u573a\u666f\uff0c\u662f\u6307\u7a0b\u5e8f\u4e2d\u751f\u6210\u4e86\u4e00\u6bb5\u4ee3\u7801\u5199\u5165\u5185\u5b58\uff0c\u7136\u540e\u5728\u8df3\u8f6c\u5230\u8fd9\u6bb5\u4ee3\u7801\u7684\u5165\u53e3\u5904\u6267\u884c\u3002\u5207\u8bb0\uff0c\u5728\u8df3\u8f6c\u5230\u81ea\u4fee\u6539\u4ee3\u7801\u5165\u53e3\u7684\u8df3\u8f6c\u6307\u4ee4\u524d\u52a0\u4e00\u6761<code>ibar</code>\u6307\u4ee4\u3002</p>"},{"location":"instructions/misc_instrs/#_4","title":"\u9884\u53d6\u6307\u4ee4","text":"<p>\u9884\u53d6\u6307\u4ee4<code>preld</code>\u7528\u4e8e\u5c06\u6307\u5b9a\u5730\u5740\u5904\u7684\u6570\u636e\u53d6\u5165\u5230\u9ad8\u901f\u7f13\u5b58\u4e2d\u3002\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8981\u5355\u72ec\u5b9a\u4e49\u5b83\u5462\uff1f<code>preld addr_A</code>\u662f\u4e0d\u662f\u53ef\u4ee5\u7528<code>ld.w $zero, addr_A</code>\u6765\u4ee3\u66ff\u5462\uff1f\u8fd9\u4e2d\u95f4\u6700\u5173\u952e\u7684\u533a\u522b\u5728\u4e8e<code>preld</code>\u6307\u4ee4\u4e0d\u4f1a\u89e6\u53d1\u4efb\u4f55\u7531\u8bbf\u5b58\u5730\u5740\u5f15\u53d1\u7684\u4f8b\u5916\u3002\u8fd9\u4e2a\u7279\u6027\u5e26\u6765\u7684\u597d\u5904\u5728\u4e8e\uff0c\u5f53\u4f60\u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528<code>preld</code>\u6307\u4ee4\u65f6\uff0c\u65e0\u987b\u989d\u5916\u7684\u4ee3\u7801\u6765\u5224\u65ad\u8be5\u6307\u4ee4\u6240\u7528\u7684\u5730\u5740\u843d\u5728\u5408\u6cd5\u7684\u8303\u56f4\u5185\u3002\u5426\u5219\u7684\u8bdd\uff0c\u4f7f\u7528\u9884\u53d6\u6307\u4ee4\u5f15\u5165\u7684\u5f00\u9500\u5c31\u6709\u4e9b\u5927\u4e86\uff0c\u5bf9\u4e8e\u6027\u80fd\u6765\u8bf4\u53ef\u80fd\u662f\u5f97\u4e0d\u507f\u5931\u3002</p>"},{"location":"instructions/misc_instrs/#_5","title":"\u8ba1\u65f6\u5668\u8bfb\u53d6\u6307\u4ee4","text":"<p>LA32R\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a64\u6bd4\u7279\u7684Counter\uff0c\u53ef\u4ee5\u7528<code>rdcntvl.w</code>\u3001<code>rdcntvh.w</code>\u6307\u4ee4\u8bfb\u53d6\u5b83\u7684\u8ba1\u6570\u503c\u3002\u5b9a\u4e49\u8fd9\u4e2aCounter\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u7ed9\u7528\u6237\u7a0b\u5e8f\u63d0\u4f9b\u4e00\u4e2a\u4f4e\u8bbf\u95ee\u5f00\u9500\u7684\u9ad8\u7cbe\u5ea6\u65f6\u949f\u6e90\u300264\u6bd4\u7279\u7684\u4f4d\u5bbd\u4f7f\u5f97\u5b83\u51e0\u4e4e\u4e0d\u4f1a\u51fa\u73b0\u6ea2\u51fa\u7684\u60c5\u51b5\uff0c\u4f46\u572832\u4f4d\u67b6\u6784\u4e0b\u5c31\u4e0d\u5f97\u4e0d\u62c6\u5206\u4e3a\u4e24\u6761\u6307\u4ee4\u6765\u8bfb\u53d6\u3002\u8fd9\u65f6\u8f6f\u4ef6\u8981\u6ce8\u610f\u6267\u884c\u8fc7\u7a0b\u4e2d\u6070\u597d\u53d1\u751f\u4f4e32\u4f4d\u5411\u9ad832\u4f4d\u8fdb\u4f4d\u7684\u573a\u666f\uff0c\u8981\u8fdb\u884c\u7279\u6b8a\u5904\u7406\u3002\u4e25\u8c28\u7684\u4ee3\u7801\u53ef\u4ee5\u91c7\u7528\u5982\u4e0b\u7684\u98ce\u683c\uff1a</p> <pre><code>read_again:\nrdcntvh.w   $t1\nrdcntvl.w   $t0\nrdcntvh.w   $t2\nbne         $t1, $t2, read_again\n</code></pre> <p>LA32R\u4e2d\u8fd8\u5b9a\u4e49\u4e86<code>rdcntid</code>\u6307\u4ee4\u6765\u8bfb\u53d6\u6bcf\u4e2aCounter\u5bf9\u5e94\u7684\u5168\u5c40\u552f\u4e00ID\u53f7\u3002\u5728\u591a\u6838\u573a\u666f\u4e0b\uff0c\u7528\u6237\u6001\u7a0b\u5e8f\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6307\u4ee4\u6765\u9ad8\u6548\u7387\u5730\u5224\u65ad\u5f53\u524d\u6267\u884c\u6240\u5728\u7684\u5904\u7406\u5668\u6838\u662f\u5426\u53d1\u751f\u4e86\u53d8\u5316\u3002</p> <ol> <li> <p>\u5982\u679c\u662f\u5728\u4e00\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u5f00\u53d1\u9a71\u52a8\uff0c\u5e94\u5c3d\u91cf\u4f7f\u7528\u7cfb\u7edf\u4e2d\u63d0\u4f9b\u7684\u5df2\u7ecf\u5c01\u88c5\u597d\u7684\u540c\u6b65\u539f\u8bed\u3002\u00a0\u21a9</p> </li> <li> <p>LA32R\u4e2d\u8bbe\u5907DMA\u548c\u5904\u7406\u5668\u6838\u4e4b\u95f4\u7684\u7f13\u5b58\u4e00\u81f4\u6027\uff08Cache Coherency\uff09\u7531\u8f6f\u4ef6\u8d1f\u8d23\u3002\u8fd9\u70b9\u4e0eLA64\u5e76\u4e0d\u76f8\u540c\u3002\u00a0\u21a9</p> </li> <li> <p>\u5982\u679c\u6709\u5730\u5740\u76f8\u5173\u7684\u60c5\u51b5\uff0c\u5904\u7406\u5668\u786c\u4ef6\u5fc5\u987b\u4fdd\u8bc1\u5b83\u4eec\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u4e0d\u4f1a\u56e0\u4e3a\u6267\u884c\u987a\u5e8f\u7684\u4e0d\u540c\u800c\u53d1\u751f\u7ade\u4e89\u5192\u9669\uff08Hazard\uff09\u3002\u00a0\u21a9</p> </li> </ol>"}]}